(()=>{"use strict";class t{constructor(t="New layer",e=!1,i,s){this.name=t,this.locked=e,this.width=i,this.height=s,this.opacity=255,this.visible=!0,this.data=new ImageData(i,s)}}const e=new class{constructor(t="New palette"){this.name=t,this.colors=[[]]}addColor(t){this.colors.push(t)}removeColor(t){this.colors.splice(t,1)}setColor(t,e){this.colors[t]=e}getColor(t){return this.colors[t]}}("Default");e.colors=[[0,0,0,255],[252,252,252,255],[248,248,248,255],[188,188,188,255],[124,124,124,255],[164,228,252,255],[60,188,252,255],[0,120,248,255],[0,0,252,255],[184,184,248,255],[104,136,252,255],[0,88,248,255],[0,0,188,255],[216,184,248,255],[152,120,248,255],[104,68,252,255],[68,40,188,255],[248,184,248,255],[248,120,248,255],[216,0,204,255],[148,0,132,255],[248,164,192,255],[248,88,152,255],[228,0,88,255],[168,0,32,255],[240,208,176,255],[248,120,88,255],[248,56,0,255],[168,16,0,255],[252,224,168,255],[252,160,68,255],[228,92,16,255],[136,20,0,255],[248,216,120,255],[248,184,0,255],[172,124,0,255],[80,40,0,255],[216,248,120,255],[184,248,24,255],[0,184,0,255],[0,120,0,255],[184,248,184,255],[88,216,84,255],[0,168,0,255],[0,104,0,255],[184,248,216,255],[88,248,152,255],[0,168,68,255],[0,88,0,255],[0,252,252,255],[0,232,216,255],[0,136,136,255],[0,64,88,255],[248,216,248,255],[120,120,120,255]];class i{constructor(i,s){this.width=i,this.height=s,this.data=[],this.palette=e,this.data=[new t("Background",!0,i,s)]}}class s{constructor(t){this.app=t,this.items=[],this.cursor=this.items.length-1}add(t){this.items.push(t),this.cursor=this.items.length-1}clearFromCursor(){this.items.splice(this.cursor+1)}undo(){}redo(){}}class a{constructor(t){this.app=t,this.zoom=25,this.file=this.app.currentFile,this.grid=!0,this.gridSize=16,this._canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this.canvas.style.backgroundColor="white",this.canvas.width=this.app.files[this.app.fileIndex].width,this.canvas.height=this.app.files[this.app.fileIndex].height,this.canvas.style.backgroundImage="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><rect width='16' height='16' fill='none'/><rect x='0' y='0' width='8' height='8' fill='%23f0f0f0'/><rect x='8' y='8' width='8' height='8' fill='%23f0f0f0'/></svg>\")",this.canvas.style.backgroundSize="16px 16px",this.canvas.style.imageRendering="pixelated",this.setZoom(this.zoom),this.canvas.addEventListener("wheel",(t=>{t.preventDefault(),this.zoomChange(t.deltaY)})),document.body.querySelector("#main").append(this.canvas);const e=this.ctx.createImageData(this.file.width,this.file.height);this.canvas.addEventListener("click",(t=>{this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height));const i=this.canvas.getBoundingClientRect(),s=Math.floor((t.clientX-i.left)/this.zoom),a=4*(Math.floor((t.clientY-i.top)/this.zoom)*this.file.width+s);e.data[a]=this.app.primaryColor[0],e.data[a+1]=this.app.primaryColor[1],e.data[a+2]=this.app.primaryColor[2],e.data[a+3]=this.app.primaryColor[3],this.ctx.putImageData(e,0,0),this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height))})),this.canvas.addEventListener("mousemove",(t=>{if(1===t.buttons){this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height));const i=this.canvas.getBoundingClientRect(),s=Math.floor((t.clientX-i.left)/this.zoom),a=4*(Math.floor((t.clientY-i.top)/this.zoom)*this.file.width+s);e.data[a]=this.app.primaryColor[0],e.data[a+1]=this.app.primaryColor[1],e.data[a+2]=this.app.primaryColor[2],e.data[a+3]=this.app.primaryColor[3],this.ctx.putImageData(e,0,0),this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height))}}))}get canvas(){return this._canvas}get ctx(){return this._ctx}drawRect(t,e,i,s,a){this.ctx.fillStyle=a,this.ctx.fillRect(t,e,i,s)}fill(t,e,i,s){const a=this.file.data[this.app.layerIndex].data;if(t<0||t>=a.width||e<0||e>=a.height)return;const n=e*a.width+t;a.data[n]!==s&&a.data[n]===i&&(a.data[n]=s,this.fill(t+1,e,i,s),this.fill(t-1,e,i,s),this.fill(t,e+1,i,s),this.fill(t,e-1,i,s))}setZoom(t){this.zoom=t,this.canvas.style.width=this.file.width*this.zoom+"px",this.canvas.style.height=this.file.height*this.zoom+"px",this.update()}zoomChange(t=0){const e=Math.sign(t);this.zoom+=8*e,this.setZoom(this.zoom)}zoomIn(){console.log("zoom in"),this.zoom<128&&this.zoomChange(1)}zoomOut(){console.log("zoom out"),this.zoom>1&&this.zoomChange(-1)}zoomReset(){console.log("zoom reset"),this.setZoom(25)}update(){requestAnimationFrame(this.update.bind(this))}}class n{constructor(t,e,i="Dialog",s="",a=!1){this.name=t,this.container=e,this.title=i,this.content=s,this._template=`\n    <style>\n      .dialog {\n        background-color: var(--bg-color);\n        border-radius: 0.5rem;\n        border: 1px solid var(--mid-color);\n        color: var(--fg-color);\n        min-width: 320px;\n        width: 500px;\n      }\n    </style>\n\n    <div class="d-flex" id="DialogHeader${this.name}">\n      <div id="DialogTitle${this.name}">${this.title}</div>\n      <button class="btn btn--icon" id="BtnCloseDialog${this.name}">\n        X\n      </button>\n    </div>\n    <div class="DialogBody DialogBody${this.name}" id="DialogBody${this.name}">\n      ${this.content}\n    </div>\n  `,this.element=document.createElement("dialog"),this.element.className=`dialog Dialog${this.name}`,this.element.open=a,this.container.append(this.element),console.log(this.name),this.header=this.element.querySelector(`#DialogHeader${t}`),this.element.id=`Dialog${t}`,this.element.innerHTML=this._template,this.closeBtn=this.element.querySelector(`#BtnCloseDialog${t}`),this.closeBtn.addEventListener("click",(()=>{this.close()}))}drag(t){let e=0,i=0,s=0,a=0;s=t.clientX,a=t.clientY;const n=t=>{t.preventDefault(),e=s-t.clientX,i=a-t.clientY,s=t.clientX,a=t.clientY,this.element.style.top=this.element.offsetTop-i+"px",this.element.style.left=this.element.offsetLeft-e+"px"},o=()=>{document.removeEventListener("mouseup",o),document.removeEventListener("mousemove",n)};document.addEventListener("mouseup",o),document.addEventListener("mousemove",n)}move(t,e){this.element.style.left=`${t}px`,this.element.style.top=`${e}px`}toggle(){this.element.hasAttribute("open")?this.close():this.open()}open(){this.element.setAttribute("open","")}close(){this.element.removeAttribute("open"),window.localStorage.setItem("startup","false")}}class o{constructor(t,e){this.selector=t,this.app=e,this.commands={n:()=>{this.app.newFile()},nl:()=>{this.app.newLayer()},l:()=>{this.app.ui.layersDialog.toggle()},e:()=>{},w:(t,e)=>{this.app.saveFile(t,{scale:parseInt(e)})},h:()=>{this.app.ui.helpDialog.toggle(),this.app.ui.log("Help")},p:()=>{this.app.ui.paletteDialog.toggle(),this.app.ui.log("Open palette")},P:()=>{},log:t=>{this.app.ui.log(t)},hs:()=>{this.app.ui.startupDialog.toggle()}},this.element=document.querySelector(`#${t}`),this.element.addEventListener("keydown",(t=>{"Enter"===t.key&&(this.execute(this.element.value),this.close())}))}open(){this.element.classList.add("open"),this.element.focus(),this.element.value=":"}close(){this.element.classList.remove("open"),this.element.value=""}execute(t){t=t.slice(1);const[e,...i]=t.split(" ");console.log(e,i),e in this.commands?this.commands[e](...i):this.app.ui.log(`command not found: ${e}`)}}class l{constructor(t){this.title=t,this.id=Date.now().toString(),this.element=document.createElement("div"),this.tabTitle=document.createElement("span"),this.element.id=this.id,this.element.classList.add("tab"),this.closeBtn=document.createElement("button"),this.closeBtn.id=`#btnClose${this.id}`,this.closeBtn.textContent="X",this.tabTitle.textContent=t,this.element.append(this.tabTitle,this.closeBtn),document.querySelector("#tabs").appendChild(this.element),this.closeBtn.addEventListener("click",(()=>{this.close()}))}deactivateTab(){this.element.classList.remove("active")}activateTab(){this.element.classList.add("active")}rename(t){this.title=t,this.tabTitle.textContent=t}close(){this.element.removeAttribute("open")}}class h{constructor(t){this.app=t,this._container=document.querySelector("body"),this.startupDialog=new n("Startup",this._container,"miniwizard",'\n  <div>\n    <b\n      >2023 Â©\n      <a target="_blank" href="https://famiclone.dev">famiclone.dev</a></b\n    >\n    <hr />\n    <br />\n    <div>\n      <b>Esc</b> - Command mode, <b>:new</b> - New file, <b>:h</b> - Open\n      help\n    </div>\n  </div>\n'),this.helpDialog=new n("Help",this._container,"Help","\n  <div>\n    <ul>\n      <li><b>Escape</b> - Open console</li>\n      <li><b>Cmd+</b> - Zoom in</li>\n      <li><b>Cmd-</b> - Zoom out</li>\n      <li><b>Cmd0</b> - Zoom reset</li>\n      <li><b>:?</b> - Open help</li>\n      <li><b>:p</b> - Open palette</li>\n      <li><b>:l</b> - Layers</li>\n      <li><b>:nl</b> - New layer</li>\n      <li><b>:log message</b> - Log message</li>\n      \x3c!-- <li><b>:b / g / e</b> - Change tool (pencil/ bucket / eraser)</li> --\x3e\n    </ul>\n  </div>\n"),this.inputCommand=new o("InputCmd",this.app),this.zoomElement=document.querySelector("#zoom"),this.primaryColorElement=document.querySelector("#toolPrColor"),this.statusLine=document.querySelector("#statusLine"),this.layersDialog=new n("Layers",this._container,"Layers"),this.layersWrap=document.querySelector("#DialogBodyLayers"),this.paletteDialog=new n("Palette",this._container),this.paletteWrap=this.paletteDialog.element.querySelector("#DialogBodyPalette"),this.paletteTitle=this.paletteDialog.element.querySelector("#DialogTitlePalette"),this.tabs=document.querySelector("#tabs"),this.app=t,window.localStorage.getItem("startup")&&"true"!==window.localStorage.getItem("startup")||this.startupDialog.open(),this.tabs.append(new l("Untitled").element),this.update()}renderPalette(){this.paletteWrap.innerHTML="";const t=document.createElement("div");t.className="palette-wrap",this.paletteTitle.textContent=this.app.palette.name,this.app.palette.colors.forEach(((e,i)=>{const s=document.createElement("div");s.classList.add("color-swatch"),s.style.backgroundColor=`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`,t.append(s),s.addEventListener("click",(()=>{this.app.primaryColor=e,this.update()}))})),this.paletteWrap.append(t)}renderLayers(){this.layersWrap.innerHTML="",this.app.currentFile?.data.forEach(((t,e)=>{const i=document.createElement("div");i.classList.add("layer"),e===this.app.layerIndex&&i.classList.add("active"),i.textContent=t.name,i.addEventListener("click",(()=>{this.app.layerIndex=e,this.update()})),this.layersWrap.append(i)}))}log(t){this.to&&clearTimeout(this.to),this.statusLine.classList.add("open"),this.statusLine.textContent=t,this.to=setTimeout((()=>{this.statusLine.classList.remove("open"),this.statusLine.textContent=""}),2e3)}update(){this.renderPalette(),this.renderLayers(),this.zoomElement.textContent=100*this.app.zoom+"%",this.primaryColorElement.style.backgroundColor=`rgba(${this.app.primaryColor[0]}, ${this.app.primaryColor[1]}, ${this.app.primaryColor[2]}, ${this.app.primaryColor[3]})`}}const r=new class{constructor(){this.history=new s(this),this.zoom=25,this.tool="pencil",this.color=1,this.files=[],this.fileIndex=0,this.palette=e,this.primaryColor=this.palette.getColor(0),this.palettes=[this.palette],this.ui=new h(this),this.layerIndex=0,this.files.push(new i(16,16)),this.renderer=new a(this),this.setup()}get currentFile(){return this.files[this.fileIndex]}setup(){document.addEventListener("keydown",(t=>{if(t.metaKey&&"="===t.key)return t.preventDefault(),void this.renderer.zoomIn();if(t.metaKey&&"-"===t.key)return t.preventDefault(),void this.renderer.zoomOut();if(t.metaKey&&"0"===t.key)return t.preventDefault(),void this.renderer.zoomReset();if(t.metaKey&&"z"===t.key)return t.preventDefault(),void this.undo();switch(t.key){case"Space":this.ui.inputCommand.element.classList.contains("open")||(t.preventDefault(),this.renderer.canvas.style.cursor="grab",this.renderer.canvas.addEventListener("mousemove",(t=>{1===t.buttons&&(this.renderer.canvas.style.cursor="grabbing",this.renderer.canvas.style.left=`${t.movementX}px`,this.renderer.canvas.style.top=`${t.movementY}px`)})));break;case"?":t.preventDefault(),this.ui.helpDialog.toggle();break;case"Escape":t.preventDefault(),this.ui.inputCommand.element.classList.contains("open")?this.ui.inputCommand.close():this.ui.inputCommand.open()}})),document.addEventListener("keyup",(t=>{if(" "===t.key)t.preventDefault(),this.renderer.canvas.style.cursor="default"})),this.update()}update(){this.renderer.update(),this.ui.update()}newFile(){console.log("new")}newLayer(){const e=new t("Layer "+(this.currentFile.data.length+1),!1,this.currentFile.width,this.currentFile.height);this.currentFile.data.push(e),this.layerIndex=this.currentFile.data.length-1,this.update()}saveFile(t,e={scale:1}){if("png"===t){const i=this.renderer.canvas.toDataURL("image/png"),s=document.createElement("canvas"),a=s.getContext("2d"),n=new Image;return n.src=i,n.onload=()=>{s.width=n.width*e.scale,s.height=n.height*e.scale,a.drawImage(n,0,0,s.width,s.height);const t=document.createElement("a");t.href=s.toDataURL("image/png"),t.download="image.png",t.click()},void this.ui.log(`save file as ${t}`)}this.ui.log(`filetype ${t} is not supported`)}undo(){this.history.undo()}redo(){this.history.redo()}changeTool(t){this.tool=t}};window.app=r})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJtYXBwaW5ncyI6Im1CQUFlLE1BQU1BLEVBQ2pCQyxZQUFZQyxFQUFPLFlBQWFDLEdBQVMsRUFBT0MsRUFBT0MsR0FDbkRDLEtBQUtKLEtBQU9BLEVBQ1pJLEtBQUtILE9BQVNBLEVBQ2RHLEtBQUtGLE1BQVFBLEVBQ2JFLEtBQUtELE9BQVNBLEVBQ2RDLEtBQUtDLFFBQVUsSUFDZkQsS0FBS0UsU0FBVSxFQUNmRixLQUFLRyxLQUFPLElBQUlDLFVBQVVOLEVBQU9DLEVBQ3JDLEVDU0csTUFBTU0sRUFBaUIsSUFsQmYsTUFDWFYsWUFBWUMsRUFBTyxlQUNmSSxLQUFLSixLQUFPQSxFQUNaSSxLQUFLTSxPQUFTLENBQUMsR0FDbkIsQ0FDQUMsU0FBU0MsR0FDTFIsS0FBS00sT0FBT0csS0FBS0QsRUFDckIsQ0FDQUUsWUFBWUMsR0FDUlgsS0FBS00sT0FBT00sT0FBT0QsRUFBTyxFQUM5QixDQUNBRSxTQUFTRixFQUFPSCxHQUNaUixLQUFLTSxPQUFPSyxHQUFTSCxDQUN6QixDQUNBTSxTQUFTSCxHQUNMLE9BQU9YLEtBQUtNLE9BQU9LLEVBQ3ZCLEdBRXNDLFdBRTFDTixFQUFlQyxPQUFTLENBQ3BCLENBQUMsRUFBRyxFQUFHLEVBQUcsS0FDVixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxHQUFJLElBQUssSUFBSyxLQUNmLENBQUMsRUFBRyxJQUFLLElBQUssS0FDZCxDQUFDLEVBQUcsRUFBRyxJQUFLLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsRUFBRyxHQUFJLElBQUssS0FDYixDQUFDLEVBQUcsRUFBRyxJQUFLLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxHQUFJLElBQUssS0FDZixDQUFDLEdBQUksR0FBSSxJQUFLLEtBQ2QsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxFQUFHLElBQUssS0FDZCxDQUFDLElBQUssRUFBRyxJQUFLLEtBQ2QsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssR0FBSSxJQUFLLEtBQ2YsQ0FBQyxJQUFLLEVBQUcsR0FBSSxLQUNiLENBQUMsSUFBSyxFQUFHLEdBQUksS0FDYixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLEdBQUksS0FDZixDQUFDLElBQUssR0FBSSxFQUFHLEtBQ2IsQ0FBQyxJQUFLLEdBQUksRUFBRyxLQUNiLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssR0FBSSxLQUNmLENBQUMsSUFBSyxHQUFJLEdBQUksS0FDZCxDQUFDLElBQUssR0FBSSxFQUFHLEtBQ2IsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxFQUFHLEtBQ2QsQ0FBQyxJQUFLLElBQUssRUFBRyxLQUNkLENBQUMsR0FBSSxHQUFJLEVBQUcsS0FDWixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLEdBQUksS0FDZixDQUFDLEVBQUcsSUFBSyxFQUFHLEtBQ1osQ0FBQyxFQUFHLElBQUssRUFBRyxLQUNaLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxHQUFJLElBQUssR0FBSSxLQUNkLENBQUMsRUFBRyxJQUFLLEVBQUcsS0FDWixDQUFDLEVBQUcsSUFBSyxFQUFHLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLEdBQUksSUFBSyxJQUFLLEtBQ2YsQ0FBQyxFQUFHLElBQUssR0FBSSxLQUNiLENBQUMsRUFBRyxHQUFJLEVBQUcsS0FDWCxDQUFDLEVBQUcsSUFBSyxJQUFL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ckIsS0FBS3FGLFFBQ1QsQ0FDQXNELFNBQVNGLEVBQU00RCxFQUFVLENBQUUzRCxNQUFPLElBQzlCLEdBQWEsUUFBVEQsRUFBZ0IsQ0FDaEIsTUFBTTZELEVBQVV0TSxLQUFLK0wsU0FBUzFKLE9BQU9rSyxVQUFVLGFBQ3pDQyxFQUFJdEssU0FBU0MsY0FBYyxVQUMzQnFCLEVBQU1nSixFQUFFbEssV0FBVyxNQUNuQm1LLEVBQU0sSUFBSUMsTUFZaEIsT0FYQUQsRUFBSUUsSUFBTUwsRUFDVkcsRUFBSUcsT0FBUyxLQUNUSixFQUFFMU0sTUFBUTJNLEVBQUkzTSxNQUFRdU0sRUFBUTNELE1BQzlCOEQsRUFBRXpNLE9BQVMwTSxFQUFJMU0sT0FBU3NNLEVBQVEzRCxNQUNoQ2xGLEVBQUlxSixVQUFVSixFQUFLLEVBQUcsRUFBR0QsRUFBRTFNLE1BQU8wTSxFQUFFek0sUUFDcEMsTUFBTStNLEVBQUk1SyxTQUFTQyxjQUFjLEtBQ2pDMkssRUFBRUMsS0FBT1AsRUFBRUQsVUFBVSxhQUNyQk8sRUFBRUUsU0FBVyxZQUNiRixFQUFFRyxPQUFPLE9BRWJqTixLQUFLdUksR0FBRzVDLElBQUksZ0JBQWdCOEMsSUFFaEMsQ0FDQXpJLEtBQUt1SSxHQUFHNUMsSUFBSSxZQUFZOEMscUJBQzVCLENBQ0FoSCxPQUNJekIsS0FBSzBELFFBQVFqQyxNQUNqQixDQUNBQyxPQUNJMUIsS0FBSzBELFFBQVFoQyxNQUNqQixDQUNBd0wsV0FBV3JCLEdBQ1A3TCxLQUFLNkwsS0FBT0EsQ0FDaEIsR0RqSUpqRSxPQUFPMUcsSUFBTUEsQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RzYnAvLi9zcmMvbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9wYWxldHRlLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvZmlsZS50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL2hpc3RvcnkudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9yZW5kZXJlci50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL3VpL2RpYWxvZy50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL2lucHV0LWNvbW1hbmQudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy91aS50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvYXBwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIExheWVyIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lID0gXCJOZXcgbGF5ZXJcIiwgbG9ja2VkID0gZmFsc2UsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5sb2NrZWQgPSBsb2NrZWQ7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMub3BhY2l0eSA9IDI1NTtcbiAgICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5kYXRhID0gbmV3IEltYWdlRGF0YSh3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQYWxldHRlIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lID0gXCJOZXcgcGFsZXR0ZVwiKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuY29sb3JzID0gW1tdXTtcbiAgICB9XG4gICAgYWRkQ29sb3IoY29sb3IpIHtcbiAgICAgICAgdGhpcy5jb2xvcnMucHVzaChjb2xvcik7XG4gICAgfVxuICAgIHJlbW92ZUNvbG9yKGluZGV4KSB7XG4gICAgICAgIHRoaXMuY29sb3JzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICAgIHNldENvbG9yKGluZGV4LCBjb2xvcikge1xuICAgICAgICB0aGlzLmNvbG9yc1tpbmRleF0gPSBjb2xvcjtcbiAgICB9XG4gICAgZ2V0Q29sb3IoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sb3JzW2luZGV4XTtcbiAgICB9XG59XG5leHBvcnQgY29uc3QgZGVmYXVsdFBhbGV0dGUgPSBuZXcgUGFsZXR0ZShcIkRlZmF1bHRcIik7XG4vLyBORVMgcGFsZXR0ZVxuZGVmYXVsdFBhbGV0dGUuY29sb3JzID0gW1xuICAgIFswLCAwLCAwLCAyNTVdLFxuICAgIFsyNTIsIDI1MiwgMjUyLCAyNTVdLFxuICAgIFsyNDgsIDI0OCwgMjQ4LCAyNTVdLFxuICAgIFsxODgsIDE4OCwgMTg4LCAyNTVdLFxuICAgIFsxMjQsIDEyNCwgMTI0LCAyNTVdLFxuICAgIFsxNjQsIDIyOCwgMjUyLCAyNTVdLFxuICAgIFs2MCwgMTg4LCAyNTIsIDI1NV0sXG4gICAgWzAsIDEyMCwgMjQ4LCAyNTVdLFxuICAgIFswLCAwLCAyNTIsIDI1NV0sXG4gICAgWzE4NCwgMTg0LCAyNDgsIDI1NV0sXG4gICAgWzEwNCwgMTM2LCAyNTIsIDI1NV0sXG4gICAgWzAsIDg4LCAyNDgsIDI1NV0sXG4gICAgWzAsIDAsIDE4OCwgMjU1XSxcbiAgICBbMjE2LCAxODQsIDI0OCwgMjU1XSxcbiAgICBbMTUyLCAxMjAsIDI0OCwgMjU1XSxcbiAgICBbMTA0LCA2OCwgMjUyLCAyNTVdLFxuICAgIFs2OCwgNDAsIDE4OCwgMjU1XSxcbiAgICBbMjQ4LCAxODQsIDI0OCwgMjU1XSxcbiAgICBbMjQ4LCAxMjAsIDI0OCwgMjU1XSxcbiAgICBbMjE2LCAwLCAyMDQsIDI1NV0sXG4gICAgWzE0OCwgMCwgMTMyLCAyNTVdLFxuICAgIFsyNDgsIDE2NCwgMTkyLCAyNTVdLFxuICAgIFsyNDgsIDg4LCAxNTIsIDI1NV0sXG4gICAgWzIyOCwgMCwgODgsIDI1NV0sXG4gICAgWzE2OCwgMCwgMzIsIDI1NV0sXG4gICAgWzI0MCwgMjA4LCAxNzYsIDI1NV0sXG4gICAgWzI0OCwgMTIwLCA4OCwgMjU1XSxcbiAgICBbMjQ4LCA1NiwgMCwgMjU1XSxcbiAgICBbMTY4LCAxNiwgMCwgMjU1XSxcbiAgICBbMjUyLCAyMjQsIDE2OCwgMjU1XSxcbiAgICBbMjUyLCAxNjAsIDY4LCAyNTVdLFxuICAgIFsyMjgsIDkyLCAxNiwgMjU1XSxcbiAgICBbMTM2LCAyMCwgMCwgMjU1XSxcbiAgICBbMjQ4LCAyMTYsIDEyMCwgMjU1XSxcbiAgICBbMjQ4LCAxODQsIDAsIDI1NV0sXG4gICAgWzE3MiwgMTI0LCAwLCAyNTVdLFxuICAgIFs4MCwgNDAsIDAsIDI1NV0sXG4gICAgWzIxNiwgMjQ4LCAxMjAsIDI1NV0sXG4gICAgWzE4NCwgMjQ4LCAyNCwgMjU1XSxcbiAgICBbMCwgMTg0LCAwLCAyNTVdLFxuICAgIFswLCAxMjAsIDAsIDI1NV0sXG4gICAgWzE4NCwgMjQ4LCAxODQsIDI1NV0sXG4gICAgWzg4LCAyMTYsIDg0LCAyNTVdLFxuICAgIFswLCAxNjgsIDAsIDI1NV0sXG4gICAgWzAsIDEwNCwgMCwgMjU1XSxcbiAgICBbMTg0LCAyNDgsIDIxNiwgMjU1XSxcbiAgICBbODgsIDI0OCwgMTUyLCAyNTVdLFxuICAgIFswLCAxNjgsIDY4LCAyNTVdLFxuICAgIFswLCA4OCwgMCwgMjU1XSxcbiAgICBbMCwgMjUyLCAyNTIsIDI1NV0sXG4gICAgWzAsIDIzMiwgMjE2LCAyNTVdLFxuICAgIFswLCAxMzYsIDEzNiwgMjU1XSxcbiAgICBbMCwgNjQsIDg4LCAyNTVdLFxuICAgIFsyNDgsIDIxNiwgMjQ4LCAyNTVdLFxuICAgIFsxMjAsIDEyMCwgMTIwLCAyNTVdLFxuXTtcbiIsImltcG9ydCBMYXllciBmcm9tIFwiLi9sYXllclwiO1xuaW1wb3J0IHsgZGVmYXVsdFBhbGV0dGUgfSBmcm9tIFwiLi9wYWxldHRlXCI7XG5leHBvcnQgY2xhc3MgV2l6RmlsZSB7XG4gICAgY29uc3RydWN0b3Iod2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB0aGlzLmRhdGEgPSBbXTtcbiAgICAgICAgdGhpcy5wYWxldHRlID0gZGVmYXVsdFBhbGV0dGU7XG4gICAgICAgIHRoaXMuZGF0YSA9IFtuZXcgTGF5ZXIoXCJCYWNrZ3JvdW5kXCIsIHRydWUsIHdpZHRoLCBoZWlnaHQpXTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBIaXN0b3J5IHtcbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuaXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy5jdXJzb3IgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7XG4gICAgfVxuICAgIGFkZChpdGVtKSB7XG4gICAgICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgdGhpcy5jdXJzb3IgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7XG4gICAgfVxuICAgIGNsZWFyRnJvbUN1cnNvcigpIHtcbiAgICAgICAgdGhpcy5pdGVtcy5zcGxpY2UodGhpcy5jdXJzb3IgKyAxKTtcbiAgICB9XG4gICAgdW5kbygpIHtcbiAgICAgICAgLy8gIGlmICh0aGlzLmN1cnNvciA+IDApIHtcbiAgICAgICAgLy8gICAgdGhpcy5jdXJzb3ItLTtcbiAgICAgICAgLy8gICAgdGhpcy5hcHAuZmlsZXNbdGhpcy5hcHAuZmlsZUluZGV4XS5kYXRhLnB1dEltYWdlRGF0YSh0aGlzLml0ZW1zW3RoaXMuY3Vyc29yXSwgMCwgMCk7XG4gICAgICAgIC8vICB9XG4gICAgfVxuICAgIHJlZG8oKSB7XG4gICAgICAgIC8vICBpZiAodGhpcy5jdXJzb3IgPCB0aGlzLml0ZW1zLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgLy8gICAgdGhpcy5jdXJzb3IrKztcbiAgICAgICAgLy8gICAgdGhpcy5hcHAuY3R4LnB1dEltYWdlRGF0YSh0aGlzLml0ZW1zW3RoaXMuY3Vyc29yXSwgMCwgMCk7XG4gICAgICAgIC8vICB9XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVuZGVyZXIge1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy56b29tID0gMjU7XG4gICAgICAgIHRoaXMuZmlsZSA9IHRoaXMuYXBwLmN1cnJlbnRGaWxlO1xuICAgICAgICB0aGlzLmdyaWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmdyaWRTaXplID0gMTY7XG4gICAgICAgIHRoaXMuX2NhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4gICAgICAgIHRoaXMuX2N0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuYXBwLmZpbGVzW3RoaXMuYXBwLmZpbGVJbmRleF0ud2lkdGg7XG4gICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuYXBwLmZpbGVzW3RoaXMuYXBwLmZpbGVJbmRleF0uaGVpZ2h0O1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO3V0ZjgsPHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxNicgaGVpZ2h0PScxNicgdmlld0JveD0nMCAwIDE2IDE2Jz48cmVjdCB3aWR0aD0nMTYnIGhlaWdodD0nMTYnIGZpbGw9J25vbmUnLz48cmVjdCB4PScwJyB5PScwJyB3aWR0aD0nOCcgaGVpZ2h0PSc4JyBmaWxsPSclMjNmMGYwZjAnLz48cmVjdCB4PSc4JyB5PSc4JyB3aWR0aD0nOCcgaGVpZ2h0PSc4JyBmaWxsPSclMjNmMGYwZjAnLz48L3N2Zz5cIilgO1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9IFwiMTZweCAxNnB4XCI7XG4gICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmltYWdlUmVuZGVyaW5nID0gXCJwaXhlbGF0ZWRcIjtcbiAgICAgICAgdGhpcy5zZXRab29tKHRoaXMuem9vbSk7XG4gICAgICAgIC8vIGFiaWxpdHkgdG8gem9vbSBpbiBhbmQgb3V0IHdpdGggbW91c2Ugd2hlZWxcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnpvb21DaGFuZ2UoZS5kZWx0YVkpO1xuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKFwiI21haW5cIikuYXBwZW5kKHRoaXMuY2FudmFzKTtcbiAgICAgICAgY29uc3QgaW1hZ2VEYXRhID0gdGhpcy5jdHguY3JlYXRlSW1hZ2VEYXRhKHRoaXMuZmlsZS53aWR0aCwgdGhpcy5maWxlLmhlaWdodCk7XG4gICAgICAgIC8vIGFiaWxpdHkgdG8gZHJhdyBwaXhlbCB3aXRoIG1vdXNlIGNsaWNrXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hcHAuaGlzdG9yeS5hZGQodGhpcy5jdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMuZmlsZS53aWR0aCwgdGhpcy5maWxlLmhlaWdodCkpO1xuICAgICAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgY29uc3QgeCA9IE1hdGguZmxvb3IoKGUuY2xpZW50WCAtIHJlY3QubGVmdCkgLyB0aGlzLnpvb20pO1xuICAgICAgICAgICAgY29uc3QgeSA9IE1hdGguZmxvb3IoKGUuY2xpZW50WSAtIHJlY3QudG9wKSAvIHRoaXMuem9vbSk7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9ICh5ICogdGhpcy5maWxlLndpZHRoICsgeCkgKiA0O1xuICAgICAgICAgICAgLy90aGlzLmZpbGVzW3RoaXMuZmlsZUluZGV4XS5kYXRhW3RoaXMubGF5ZXJJbmRleF0uZGF0YVt5XVt4XSA9IHRoaXMuY29sb3I7XG4gICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleF0gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMF07XG4gICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDFdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzFdO1xuICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAyXSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclsyXTtcbiAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgM10gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbM107XG4gICAgICAgICAgICB0aGlzLmN0eC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcbiAgICAgICAgICAgIHRoaXMuYXBwLmhpc3RvcnkuYWRkKHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmZpbGUud2lkdGgsIHRoaXMuZmlsZS5oZWlnaHQpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGFiaWxpdHkgdG8gZHJhdyBwaXhlbCB3aXRoIG1vdXNlIG1vdmVcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUuYnV0dG9ucyA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLmhpc3RvcnkuYWRkKHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmZpbGUud2lkdGgsIHRoaXMuZmlsZS5oZWlnaHQpKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgeCA9IE1hdGguZmxvb3IoKGUuY2xpZW50WCAtIHJlY3QubGVmdCkgLyB0aGlzLnpvb20pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBNYXRoLmZsb29yKChlLmNsaWVudFkgLSByZWN0LnRvcCkgLyB0aGlzLnpvb20pO1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gKHkgKiB0aGlzLmZpbGUud2lkdGggKyB4KSAqIDQ7XG4gICAgICAgICAgICAgICAgLy90aGlzLmZpbGVzW3RoaXMuZmlsZUluZGV4XS5kYXRhW3RoaXMubGF5ZXJJbmRleF0uZGF0YVt5XVt4XSA9XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5jb2xvcjtcbiAgICAgICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleF0gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMF07XG4gICAgICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAxXSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclsxXTtcbiAgICAgICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDJdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzJdO1xuICAgICAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgM10gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbM107XG4gICAgICAgICAgICAgICAgdGhpcy5jdHgucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuaGlzdG9yeS5hZGQodGhpcy5jdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMuZmlsZS53aWR0aCwgdGhpcy5maWxlLmhlaWdodCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IGNhbnZhcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbnZhcztcbiAgICB9XG4gICAgZ2V0IGN0eCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N0eDtcbiAgICB9XG4gICAgZHJhd1JlY3QoeCwgeSwgdywgaCwgY29sb3IpIHtcbiAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gY29sb3I7XG4gICAgICAgIHRoaXMuY3R4LmZpbGxSZWN0KHgsIHksIHcsIGgpO1xuICAgIH1cbiAgICBmaWxsKHN0YXJ0WCwgc3RhcnRZLCB0YXJnZXRDb2xvciwgcmVwbGFjZUNvbG9yKSB7XG4gICAgICAgIGNvbnN0IG1hdHJpeCA9IHRoaXMuZmlsZS5kYXRhW3RoaXMuYXBwLmxheWVySW5kZXhdLmRhdGE7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBzdGFydCBjb29yZGluYXRlcyBhcmUgb3V0IG9mIGJvdW5kc1xuICAgICAgICBpZiAoc3RhcnRYIDwgMCB8fFxuICAgICAgICAgICAgc3RhcnRYID49IG1hdHJpeC53aWR0aCB8fFxuICAgICAgICAgICAgc3RhcnRZIDwgMCB8fFxuICAgICAgICAgICAgc3RhcnRZID49IG1hdHJpeC5oZWlnaHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbmRleCA9IHN0YXJ0WSAqIG1hdHJpeC53aWR0aCArIHN0YXJ0WDtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHRhcmdldCB2YWx1ZSBtYXRjaGVzIHRoZSByZXBsYWNlbWVudCB2YWx1ZVxuICAgICAgICBpZiAobWF0cml4LmRhdGFbaW5kZXhdID09PSByZXBsYWNlQ29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCB2YWx1ZSBtYXRjaGVzIHRoZSB0YXJnZXQgdmFsdWVcbiAgICAgICAgaWYgKG1hdHJpeC5kYXRhW2luZGV4XSAhPT0gdGFyZ2V0Q29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBSZXBsYWNlIHRoZSBjdXJyZW50IHZhbHVlIHdpdGggdGhlIHJlcGxhY2VtZW50IHZhbHVlXG4gICAgICAgIG1hdHJpeC5kYXRhW2luZGV4XSA9IHJlcGxhY2VDb2xvcjtcbiAgICAgICAgLy8gUmVjdXJzaXZlbHkgZmlsbCBhZGphY2VudCBjZWxsc1xuICAgICAgICB0aGlzLmZpbGwoc3RhcnRYICsgMSwgc3RhcnRZLCB0YXJnZXRDb2xvciwgcmVwbGFjZUNvbG9yKTsgLy8gUmlnaHRcbiAgICAgICAgdGhpcy5maWxsKHN0YXJ0WCAtIDEsIHN0YXJ0WSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcik7IC8vIExlZnRcbiAgICAgICAgdGhpcy5maWxsKHN0YXJ0WCwgc3RhcnRZICsgMSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcik7IC8vIERvd25cbiAgICAgICAgdGhpcy5maWxsKHN0YXJ0WCwgc3RhcnRZIC0gMSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcik7IC8vIFVwXG4gICAgfVxuICAgIHNldFpvb20oem9vbSkge1xuICAgICAgICB0aGlzLnpvb20gPSB6b29tO1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS53aWR0aCA9IGAke3RoaXMuZmlsZS53aWR0aCAqIHRoaXMuem9vbX1weGA7XG4gICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuZmlsZS5oZWlnaHQgKiB0aGlzLnpvb219cHhgO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH1cbiAgICB6b29tQ2hhbmdlKGR0ID0gMCkge1xuICAgICAgICBjb25zdCBkZWx0YSA9IE1hdGguc2lnbihkdCk7XG4gICAgICAgIHRoaXMuem9vbSArPSBkZWx0YSAqIDg7XG4gICAgICAgIHRoaXMuc2V0Wm9vbSh0aGlzLnpvb20pO1xuICAgIH1cbiAgICB6b29tSW4oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiem9vbSBpblwiKTtcbiAgICAgICAgaWYgKHRoaXMuem9vbSA8IDEyOCkge1xuICAgICAgICAgICAgdGhpcy56b29tQ2hhbmdlKDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHpvb21PdXQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiem9vbSBvdXRcIik7XG4gICAgICAgIGlmICh0aGlzLnpvb20gPiAxKSB7XG4gICAgICAgICAgICB0aGlzLnpvb21DaGFuZ2UoLTEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHpvb21SZXNldCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ6b29tIHJlc2V0XCIpO1xuICAgICAgICB0aGlzLnNldFpvb20oMjUpO1xuICAgIH1cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBEaWFsb2dFbGVtZW50IHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lLCBjb250YWluZXIsIHRpdGxlID0gXCJEaWFsb2dcIiwgY29udGVudCA9IFwiXCIsIG9wZW4gPSBmYWxzZSkge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLmNvbnRlbnQgPSBjb250ZW50O1xuICAgICAgICB0aGlzLl90ZW1wbGF0ZSA9IGBcbiAgICA8c3R5bGU+XG4gICAgICAuZGlhbG9nIHtcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmctY29sb3IpO1xuICAgICAgICBib3JkZXItcmFkaXVzOiAwLjVyZW07XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLW1pZC1jb2xvcik7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1mZy1jb2xvcik7XG4gICAgICAgIG1pbi13aWR0aDogMzIwcHg7XG4gICAgICAgIHdpZHRoOiA1MDBweDtcbiAgICAgIH1cbiAgICA8L3N0eWxlPlxuXG4gICAgPGRpdiBjbGFzcz1cImQtZmxleFwiIGlkPVwiRGlhbG9nSGVhZGVyJHt0aGlzLm5hbWV9XCI+XG4gICAgICA8ZGl2IGlkPVwiRGlhbG9nVGl0bGUke3RoaXMubmFtZX1cIj4ke3RoaXMudGl0bGV9PC9kaXY+XG4gICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi0taWNvblwiIGlkPVwiQnRuQ2xvc2VEaWFsb2cke3RoaXMubmFtZX1cIj5cbiAgICAgICAgWFxuICAgICAgPC9idXR0b24+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cIkRpYWxvZ0JvZHkgRGlhbG9nQm9keSR7dGhpcy5uYW1lfVwiIGlkPVwiRGlhbG9nQm9keSR7dGhpcy5uYW1lfVwiPlxuICAgICAgJHt0aGlzLmNvbnRlbnR9XG4gICAgPC9kaXY+XG4gIGA7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaWFsb2dcIik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc05hbWUgPSBgZGlhbG9nIERpYWxvZyR7dGhpcy5uYW1lfWA7XG4gICAgICAgIHRoaXMuZWxlbWVudC5vcGVuID0gb3BlbjtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMubmFtZSk7XG4gICAgICAgIHRoaXMuaGVhZGVyID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCNEaWFsb2dIZWFkZXIke25hbWV9YCk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IGBEaWFsb2cke25hbWV9YDtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IHRoaXMuX3RlbXBsYXRlO1xuICAgICAgICB0aGlzLmNsb3NlQnRuID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCNCdG5DbG9zZURpYWxvZyR7bmFtZX1gKTtcbiAgICAgICAgdGhpcy5jbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZHJhZyhlKSB7XG4gICAgICAgIGxldCBwb3MxID0gMCwgcG9zMiA9IDAsIHBvczMgPSAwLCBwb3M0ID0gMDtcbiAgICAgICAgcG9zMyA9IGUuY2xpZW50WDtcbiAgICAgICAgcG9zNCA9IGUuY2xpZW50WTtcbiAgICAgICAgY29uc3QgZWxlbWVudERyYWcgPSAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgcG9zMSA9IHBvczMgLSBlLmNsaWVudFg7XG4gICAgICAgICAgICBwb3MyID0gcG9zNCAtIGUuY2xpZW50WTtcbiAgICAgICAgICAgIHBvczMgPSBlLmNsaWVudFg7XG4gICAgICAgICAgICBwb3M0ID0gZS5jbGllbnRZO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IHRoaXMuZWxlbWVudC5vZmZzZXRUb3AgLSBwb3MyICsgXCJweFwiO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSB0aGlzLmVsZW1lbnQub2Zmc2V0TGVmdCAtIHBvczEgKyBcInB4XCI7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGNsb3NlRHJhZ0VsZW1lbnQgPSAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBjbG9zZURyYWdFbGVtZW50KTtcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZWxlbWVudERyYWcpO1xuICAgICAgICB9O1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBjbG9zZURyYWdFbGVtZW50KTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBlbGVtZW50RHJhZyk7XG4gICAgfVxuICAgIG1vdmUoeCwgeSkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9IGAke3h9cHhgO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gYCR7eX1weGA7XG4gICAgfVxuICAgIHRvZ2dsZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJvcGVuXCIpKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwib3BlblwiLCBcIlwiKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJvcGVuXCIpO1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzdGFydHVwXCIsIFwiZmFsc2VcIik7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5wdXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgYXBwKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuY29tbWFuZHMgPSB7XG4gICAgICAgICAgICBuOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAubmV3RmlsZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG5sOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAubmV3TGF5ZXIoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkubGF5ZXJzRGlhbG9nLnRvZ2dsZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGU6ICgpID0+IHsgfSxcbiAgICAgICAgICAgIHc6ICh0eXBlLCBzY2FsZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNhdmVGaWxlKHR5cGUsIHsgc2NhbGU6IHBhcnNlSW50KHNjYWxlKSB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkuaGVscERpYWxvZy50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC51aS5sb2coXCJIZWxwXCIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHA6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC51aS5wYWxldHRlRGlhbG9nLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnVpLmxvZyhcIk9wZW4gcGFsZXR0ZVwiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBQOiAoKSA9PiB7IH0sXG4gICAgICAgICAgICBsb2c6IChtc2cpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC51aS5sb2cobXNnKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoczogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnVpLnN0YXJ0dXBEaWFsb2cudG9nZ2xlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtzZWxlY3Rvcn1gKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZSh0aGlzLmVsZW1lbnQudmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9wZW4oKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IFwiOlwiO1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICAgIH1cbiAgICBleGVjdXRlKGNtZCkge1xuICAgICAgICBjbWQgPSBjbWQuc2xpY2UoMSk7XG4gICAgICAgIGNvbnN0IFtjb21tYW5kLCAuLi5hcmdzXSA9IGNtZC5zcGxpdChcIiBcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKGNvbW1hbmQsIGFyZ3MpO1xuICAgICAgICBpZiAoY29tbWFuZCBpbiB0aGlzLmNvbW1hbmRzKSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRzW2NvbW1hbmRdKC4uLmFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hcHAudWkubG9nKGBjb21tYW5kIG5vdCBmb3VuZDogJHtjb21tYW5kfWApO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IERpYWxvZ0VsZW1lbnQgZnJvbSBcIi4vdWkvZGlhbG9nXCI7XG5pbXBvcnQgSW5wdXRDb21tYW5kIGZyb20gXCIuL2lucHV0LWNvbW1hbmRcIjtcbmNvbnN0IHN0YXJ0dXBDb250ZW50ID0gYFxuICA8ZGl2PlxuICAgIDxiXG4gICAgICA+MjAyMyDCqVxuICAgICAgPGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj1cImh0dHBzOi8vZmFtaWNsb25lLmRldlwiPmZhbWljbG9uZS5kZXY8L2E+PC9iXG4gICAgPlxuICAgIDxociAvPlxuICAgIDxiciAvPlxuICAgIDxkaXY+XG4gICAgICA8Yj5Fc2M8L2I+IC0gQ29tbWFuZCBtb2RlLCA8Yj46bmV3PC9iPiAtIE5ldyBmaWxlLCA8Yj46aDwvYj4gLSBPcGVuXG4gICAgICBoZWxwXG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuYDtcbmNvbnN0IGhlbHBDb250ZW50ID0gYFxuICA8ZGl2PlxuICAgIDx1bD5cbiAgICAgIDxsaT48Yj5Fc2NhcGU8L2I+IC0gT3BlbiBjb25zb2xlPC9saT5cbiAgICAgIDxsaT48Yj5DbWQrPC9iPiAtIFpvb20gaW48L2xpPlxuICAgICAgPGxpPjxiPkNtZC08L2I+IC0gWm9vbSBvdXQ8L2xpPlxuICAgICAgPGxpPjxiPkNtZDA8L2I+IC0gWm9vbSByZXNldDwvbGk+XG4gICAgICA8bGk+PGI+Oj88L2I+IC0gT3BlbiBoZWxwPC9saT5cbiAgICAgIDxsaT48Yj46cDwvYj4gLSBPcGVuIHBhbGV0dGU8L2xpPlxuICAgICAgPGxpPjxiPjpsPC9iPiAtIExheWVyczwvbGk+XG4gICAgICA8bGk+PGI+Om5sPC9iPiAtIE5ldyBsYXllcjwvbGk+XG4gICAgICA8bGk+PGI+OmxvZyBtZXNzYWdlPC9iPiAtIExvZyBtZXNzYWdlPC9saT5cbiAgICAgIDwhLS0gPGxpPjxiPjpiIC8gZyAvIGU8L2I+IC0gQ2hhbmdlIHRvb2wgKHBlbmNpbC8gYnVja2V0IC8gZXJhc2VyKTwvbGk+IC0tPlxuICAgIDwvdWw+XG4gIDwvZGl2PlxuYDtcbmNsYXNzIFRhYiB7XG4gICAgY29uc3RydWN0b3IodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLmlkID0gRGF0ZS5ub3coKS50b1N0cmluZygpO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLnRhYlRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IHRoaXMuaWQ7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFiXCIpO1xuICAgICAgICB0aGlzLmNsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgdGhpcy5jbG9zZUJ0bi5pZCA9IGAjYnRuQ2xvc2Uke3RoaXMuaWR9YDtcbiAgICAgICAgdGhpcy5jbG9zZUJ0bi50ZXh0Q29udGVudCA9IFwiWFwiO1xuICAgICAgICB0aGlzLnRhYlRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmQodGhpcy50YWJUaXRsZSwgdGhpcy5jbG9zZUJ0bik7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGFic1wiKS5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICB0aGlzLmNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZWFjdGl2YXRlVGFiKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICB9XG4gICAgYWN0aXZhdGVUYWIoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgIH1cbiAgICByZW5hbWUodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLnRhYlRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwib3BlblwiKTtcbiAgICB9XG59XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVSSB7XG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKTtcbiAgICAgICAgdGhpcy5zdGFydHVwRGlhbG9nID0gbmV3IERpYWxvZ0VsZW1lbnQoXCJTdGFydHVwXCIsIHRoaXMuX2NvbnRhaW5lciwgXCJtaW5pd2l6YXJkXCIsIHN0YXJ0dXBDb250ZW50KTtcbiAgICAgICAgdGhpcy5oZWxwRGlhbG9nID0gbmV3IERpYWxvZ0VsZW1lbnQoXCJIZWxwXCIsIHRoaXMuX2NvbnRhaW5lciwgXCJIZWxwXCIsIGhlbHBDb250ZW50KTtcbiAgICAgICAgdGhpcy5pbnB1dENvbW1hbmQgPSBuZXcgSW5wdXRDb21tYW5kKFwiSW5wdXRDbWRcIiwgdGhpcy5hcHApO1xuICAgICAgICB0aGlzLnpvb21FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN6b29tXCIpO1xuICAgICAgICB0aGlzLnByaW1hcnlDb2xvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Rvb2xQckNvbG9yXCIpO1xuICAgICAgICB0aGlzLnN0YXR1c0xpbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3N0YXR1c0xpbmVcIik7XG4gICAgICAgIHRoaXMubGF5ZXJzRGlhbG9nID0gbmV3IERpYWxvZ0VsZW1lbnQoXCJMYXllcnNcIiwgdGhpcy5fY29udGFpbmVyLCBcIkxheWVyc1wiKTtcbiAgICAgICAgdGhpcy5sYXllcnNXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNEaWFsb2dCb2R5TGF5ZXJzXCIpO1xuICAgICAgICB0aGlzLnBhbGV0dGVEaWFsb2cgPSBuZXcgRGlhbG9nRWxlbWVudChcIlBhbGV0dGVcIiwgdGhpcy5fY29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5wYWxldHRlV3JhcCA9IHRoaXMucGFsZXR0ZURpYWxvZy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjRGlhbG9nQm9keVBhbGV0dGVcIik7XG4gICAgICAgIHRoaXMucGFsZXR0ZVRpdGxlID0gdGhpcy5wYWxldHRlRGlhbG9nLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNEaWFsb2dUaXRsZVBhbGV0dGVcIik7XG4gICAgICAgIHRoaXMudGFicyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGFic1wiKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIGlmICghd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwic3RhcnR1cFwiKSB8fFxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwic3RhcnR1cFwiKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnR1cERpYWxvZy5vcGVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50YWJzLmFwcGVuZChuZXcgVGFiKFwiVW50aXRsZWRcIikuZWxlbWVudCk7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuICAgIHJlbmRlclBhbGV0dGUoKSB7XG4gICAgICAgIHRoaXMucGFsZXR0ZVdyYXAuaW5uZXJIVE1MID0gXCJcIjtcbiAgICAgICAgY29uc3Qgd3JhcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHdyYXAuY2xhc3NOYW1lID0gXCJwYWxldHRlLXdyYXBcIjtcbiAgICAgICAgdGhpcy5wYWxldHRlVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLmFwcC5wYWxldHRlLm5hbWU7XG4gICAgICAgIHRoaXMuYXBwLnBhbGV0dGUuY29sb3JzLmZvckVhY2goKGNvbG9yLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImNvbG9yLXN3YXRjaFwiKTtcbiAgICAgICAgICAgIGVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2JhKCR7Y29sb3JbMF19LCAke2NvbG9yWzFdfSwgJHtjb2xvclsyXX0sICR7Y29sb3JbM119KWA7XG4gICAgICAgICAgICB3cmFwLmFwcGVuZChlbCk7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnByaW1hcnlDb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucGFsZXR0ZVdyYXAuYXBwZW5kKHdyYXApO1xuICAgIH1cbiAgICByZW5kZXJMYXllcnMoKSB7XG4gICAgICAgIHRoaXMubGF5ZXJzV3JhcC5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICB0aGlzLmFwcC5jdXJyZW50RmlsZT8uZGF0YS5mb3JFYWNoKChsYXllciwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJsYXllclwiKTtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5hcHAubGF5ZXJJbmRleCkge1xuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbC50ZXh0Q29udGVudCA9IGxheWVyLm5hbWU7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLmxheWVySW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmxheWVyc1dyYXAuYXBwZW5kKGVsKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxvZyhtc2cpIHtcbiAgICAgICAgdGhpcy50byAmJiBjbGVhclRpbWVvdXQodGhpcy50byk7XG4gICAgICAgIHRoaXMuc3RhdHVzTGluZS5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5zdGF0dXNMaW5lLnRleHRDb250ZW50ID0gbXNnO1xuICAgICAgICB0aGlzLnRvID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0xpbmUuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0xpbmUudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICB9LCAyMDAwKTtcbiAgICB9XG4gICAgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLnJlbmRlclBhbGV0dGUoKTtcbiAgICAgICAgdGhpcy5yZW5kZXJMYXllcnMoKTtcbiAgICAgICAgdGhpcy56b29tRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RoaXMuYXBwLnpvb20gKiAxMDB9JWA7XG4gICAgICAgIHRoaXMucHJpbWFyeUNvbG9yRWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBgcmdiYSgke3RoaXMuYXBwLnByaW1hcnlDb2xvclswXX0sICR7dGhpcy5hcHAucHJpbWFyeUNvbG9yWzFdfSwgJHt0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMl19LCAke3RoaXMuYXBwLnByaW1hcnlDb2xvclszXX0pYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgQXBwIGZyb20gXCIuL2FwcFwiO1xuY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuLy9AdHMtaWdub3JlXG53aW5kb3cuYXBwID0gYXBwO1xuIiwiaW1wb3J0IHsgV2l6RmlsZSB9IGZyb20gXCIuL2ZpbGVcIjtcbmltcG9ydCBIaXN0b3J5IGZyb20gXCIuL2hpc3RvcnlcIjtcbmltcG9ydCBMYXllciBmcm9tIFwiLi9sYXllclwiO1xuaW1wb3J0IHsgZGVmYXVsdFBhbGV0dGUgfSBmcm9tIFwiLi9wYWxldHRlXCI7XG5pbXBvcnQgUmVuZGVyZXIgZnJvbSBcIi4vcmVuZGVyZXJcIjtcbmltcG9ydCBVSSBmcm9tIFwiLi91aVwiO1xuY29uc3QgREVGQVVMVF9XSURUSCA9IDE2O1xuY29uc3QgREVGQVVMVF9IRUlHSFQgPSAxNjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuaGlzdG9yeSA9IG5ldyBIaXN0b3J5KHRoaXMpO1xuICAgICAgICB0aGlzLnpvb20gPSAyNTtcbiAgICAgICAgdGhpcy50b29sID0gXCJwZW5jaWxcIjtcbiAgICAgICAgdGhpcy5jb2xvciA9IDE7XG4gICAgICAgIHRoaXMuZmlsZXMgPSBbXTtcbiAgICAgICAgdGhpcy5maWxlSW5kZXggPSAwO1xuICAgICAgICB0aGlzLnBhbGV0dGUgPSBkZWZhdWx0UGFsZXR0ZTtcbiAgICAgICAgdGhpcy5wcmltYXJ5Q29sb3IgPSB0aGlzLnBhbGV0dGUuZ2V0Q29sb3IoMCk7XG4gICAgICAgIHRoaXMucGFsZXR0ZXMgPSBbdGhpcy5wYWxldHRlXTtcbiAgICAgICAgdGhpcy51aSA9IG5ldyBVSSh0aGlzKTtcbiAgICAgICAgdGhpcy5sYXllckluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5maWxlcy5wdXNoKG5ldyBXaXpGaWxlKERFRkFVTFRfV0lEVEgsIERFRkFVTFRfSEVJR0hUKSk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIodGhpcyk7XG4gICAgICAgIHRoaXMuc2V0dXAoKTtcbiAgICB9XG4gICAgZ2V0IGN1cnJlbnRGaWxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maWxlc1t0aGlzLmZpbGVJbmRleF07XG4gICAgfVxuICAgIHNldHVwKCkge1xuICAgICAgICAvLyBhYmlsaXR5IHRvIHVuZG8gY2hhbmdlcyB3aXRoIGNtZCArIHpcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLm1ldGFLZXkgJiYgZS5rZXkgPT09IFwiPVwiKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuem9vbUluKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUubWV0YUtleSAmJiBlLmtleSA9PT0gXCItXCIpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci56b29tT3V0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUubWV0YUtleSAmJiBlLmtleSA9PT0gXCIwXCIpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci56b29tUmVzZXQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5tZXRhS2V5ICYmIGUua2V5ID09PSBcInpcIikge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVuZG8oKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaG9sZCBzcGFjZSBhbmQgbW92ZSBtb3VzZSwgbW92ZSBjYW52YXNcbiAgICAgICAgICAgICAgICBjYXNlIFwiU3BhY2VcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnVpLmlucHV0Q29tbWFuZC5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcIm9wZW5cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2FudmFzLnN0eWxlLmN1cnNvciA9IFwiZ3JhYlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmJ1dHRvbnMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jYW52YXMuc3R5bGUuY3Vyc29yID0gXCJncmFiYmluZ1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNhbnZhcy5zdHlsZS5sZWZ0ID0gYCR7ZS5tb3ZlbWVudFh9cHhgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNhbnZhcy5zdHlsZS50b3AgPSBgJHtlLm1vdmVtZW50WX1weGA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIj9cIjpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVpLmhlbHBEaWFsb2cudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJFc2NhcGVcIjpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51aS5pbnB1dENvbW1hbmQuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJvcGVuXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVpLmlucHV0Q29tbWFuZC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51aS5pbnB1dENvbW1hbmQub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiIFwiOlxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2FudmFzLnN0eWxlLmN1cnNvciA9IFwiZGVmYXVsdFwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci51cGRhdGUoKTtcbiAgICAgICAgdGhpcy51aS51cGRhdGUoKTtcbiAgICB9XG4gICAgbmV3RmlsZSgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJuZXdcIik7XG4gICAgfVxuICAgIG5ld0xheWVyKCkge1xuICAgICAgICBjb25zdCBsYXllciA9IG5ldyBMYXllcihcIkxheWVyIFwiICsgKHRoaXMuY3VycmVudEZpbGUuZGF0YS5sZW5ndGggKyAxKSwgZmFsc2UsIHRoaXMuY3VycmVudEZpbGUud2lkdGgsIHRoaXMuY3VycmVudEZpbGUuaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZS5kYXRhLnB1c2gobGF5ZXIpO1xuICAgICAgICB0aGlzLmxheWVySW5kZXggPSB0aGlzLmN1cnJlbnRGaWxlLmRhdGEubGVuZ3RoIC0gMTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9XG4gICAgc2F2ZUZpbGUodHlwZSwgb3B0aW9ucyA9IHsgc2NhbGU6IDEgfSkge1xuICAgICAgICBpZiAodHlwZSA9PT0gXCJwbmdcIikge1xuICAgICAgICAgICAgY29uc3QgZGF0YVVybCA9IHRoaXMucmVuZGVyZXIuY2FudmFzLnRvRGF0YVVSTChcImltYWdlL3BuZ1wiKTtcbiAgICAgICAgICAgIGNvbnN0IGMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgICAgICAgICAgY29uc3QgY3R4ID0gYy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICAgICAgICBjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIGltZy5zcmMgPSBkYXRhVXJsO1xuICAgICAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjLndpZHRoID0gaW1nLndpZHRoICogb3B0aW9ucy5zY2FsZTtcbiAgICAgICAgICAgICAgICBjLmhlaWdodCA9IGltZy5oZWlnaHQgKiBvcHRpb25zLnNjYWxlO1xuICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwLCBjLndpZHRoLCBjLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICAgICAgICAgICAgICAgIGEuaHJlZiA9IGMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpO1xuICAgICAgICAgICAgICAgIGEuZG93bmxvYWQgPSBcImltYWdlLnBuZ1wiO1xuICAgICAgICAgICAgICAgIGEuY2xpY2soKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnVpLmxvZyhgc2F2ZSBmaWxlIGFzICR7dHlwZX1gKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVpLmxvZyhgZmlsZXR5cGUgJHt0eXBlfSBpcyBub3Qgc3VwcG9ydGVkYCk7XG4gICAgfVxuICAgIHVuZG8oKSB7XG4gICAgICAgIHRoaXMuaGlzdG9yeS51bmRvKCk7XG4gICAgfVxuICAgIHJlZG8oKSB7XG4gICAgICAgIHRoaXMuaGlzdG9yeS5yZWRvKCk7XG4gICAgfVxuICAgIGNoYW5nZVRvb2wodG9vbCkge1xuICAgICAgICB0aGlzLnRvb2wgPSB0b29sO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJMYXllciIsImNvbnN0cnVjdG9yIiwibmFtZSIsImxvY2tlZCIsIndpZHRoIiwiaGVpZ2h0IiwidGhpcyIsIm9wYWNpdHkiLCJ2aXNpYmxlIiwiZGF0YSIsIkltYWdlRGF0YSIsImRlZmF1bHRQYWxldHRlIiwiY29sb3JzIiwiYWRkQ29sb3IiLCJjb2xvciIsInB1c2giLCJyZW1vdmVDb2xvciIsImluZGV4Iiwic3BsaWNlIiwic2V0Q29sb3IiLCJnZXRDb2xvciIsIldpekZpbGUiLCJwYWxldHRlIiwiSGlzdG9yeSIsImFwcCIsIml0ZW1zIiwiY3Vyc29yIiwibGVuZ3RoIiwiYWRkIiwiaXRlbSIsImNsZWFyRnJvbUN1cnNvciIsInVuZG8iLCJyZWRvIiwiUmVuZGVyZXIiLCJ6b29tIiwiZmlsZSIsImN1cnJlbnRGaWxlIiwiZ3JpZCIsImdyaWRTaXplIiwiX2NhbnZhcyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIl9jdHgiLCJjYW52YXMiLCJnZXRDb250ZXh0Iiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJmaWxlcyIsImZpbGVJbmRleCIsImJhY2tncm91bmRJbWFnZSIsImJhY2tncm91bmRTaXplIiwiaW1hZ2VSZW5kZXJpbmciLCJzZXRab29tIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInpvb21DaGFuZ2UiLCJkZWx0YVkiLCJib2R5IiwicXVlcnlTZWxlY3RvciIsImFwcGVuZCIsImltYWdlRGF0YSIsImN0eCIsImNyZWF0ZUltYWdlRGF0YSIsImhpc3RvcnkiLCJnZXRJbWFnZURhdGEiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsIk1hdGgiLCJmbG9vciIsImNsaWVudFgiLCJsZWZ0IiwiY2xpZW50WSIsInRvcCIsInByaW1hcnlDb2xvciIsInB1dEltYWdlRGF0YSIsImJ1dHRvbnMiLCJkcmF3UmVjdCIsInkiLCJ3IiwiaCIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwiZmlsbCIsInN0YXJ0WCIsInN0YXJ0WSIsInRhcmdldENvbG9yIiwicmVwbGFjZUNvbG9yIiwibWF0cml4IiwibGF5ZXJJbmRleCIsInVwZGF0ZSIsImR0IiwiZGVsdGEiLCJzaWduIiwiem9vbUluIiwiY29uc29sZSIsImxvZyIsInpvb21PdXQiLCJ6b29tUmVzZXQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJiaW5kIiwiRGlhbG9nRWxlbWVudCIsImNvbnRhaW5lciIsInRpdGxlIiwiY29udGVudCIsIm9wZW4iLCJfdGVtcGxhdGUiLCJlbGVtZW50IiwiY2xhc3NOYW1lIiwiaGVhZGVyIiwiaWQiLCJpbm5lckhUTUwiLCJjbG9zZUJ0biIsImNsb3NlIiwiZHJhZyIsInBvczEiLCJwb3MyIiwicG9zMyIsInBvczQiLCJlbGVtZW50RHJhZyIsIm9mZnNldFRvcCIsIm9mZnNldExlZnQiLCJjbG9zZURyYWdFbGVtZW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm1vdmUiLCJ0b2dnbGUiLCJoYXNBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSW5wdXRDb21tYW5kIiwic2VsZWN0b3IiLCJjb21tYW5kcyIsIm4iLCJuZXdGaWxlIiwibmwiLCJuZXdMYXllciIsImwiLCJ1aSIsImxheWVyc0RpYWxvZyIsInR5cGUiLCJzY2FsZSIsInNhdmVGaWxlIiwicGFyc2VJbnQiLCJoZWxwRGlhbG9nIiwicCIsInBhbGV0dGVEaWFsb2ciLCJQIiwibXNnIiwiaHMiLCJzdGFydHVwRGlhbG9nIiwia2V5IiwiZXhlY3V0ZSIsInZhbHVlIiwiY2xhc3NMaXN0IiwiZm9jdXMiLCJyZW1vdmUiLCJjbWQiLCJzbGljZSIsImNvbW1hbmQiLCJhcmdzIiwic3BsaXQiLCJUYWIiLCJEYXRlIiwibm93IiwidG9TdHJpbmciLCJ0YWJUaXRsZSIsInRleHRDb250ZW50IiwiYXBwZW5kQ2hpbGQiLCJkZWFjdGl2YXRlVGFiIiwiYWN0aXZhdGVUYWIiLCJyZW5hbWUiLCJVSSIsIl9jb250YWluZXIiLCJpbnB1dENvbW1hbmQiLCJ6b29tRWxlbWVudCIsInByaW1hcnlDb2xvckVsZW1lbnQiLCJzdGF0dXNMaW5lIiwibGF5ZXJzV3JhcCIsInBhbGV0dGVXcmFwIiwicGFsZXR0ZVRpdGxlIiwidGFicyIsImdldEl0ZW0iLCJyZW5kZXJQYWxldHRlIiwid3JhcCIsImZvckVhY2giLCJlbCIsInJlbmRlckxheWVycyIsImxheWVyIiwidG8iLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwidG9vbCIsInBhbGV0dGVzIiwicmVuZGVyZXIiLCJzZXR1cCIsIm1ldGFLZXkiLCJjb250YWlucyIsIm1vdmVtZW50WCIsIm1vdmVtZW50WSIsIm9wdGlvbnMiLCJkYXRhVXJsIiwidG9EYXRhVVJMIiwiYyIsImltZyIsIkltYWdlIiwic3JjIiwib25sb2FkIiwiZHJhd0ltYWdlIiwiYSIsImhyZWYiLCJkb3dubG9hZCIsImNsaWNrIiwiY2hhbmdlVG9vbCJdLCJzb3VyY2VSb290IjoiIn0=