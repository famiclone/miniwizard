(()=>{"use strict";class t{constructor(t="New layer",e=!1,s,i){this.name=t,this.locked=e,this.width=s,this.height=i,this.opacity=255,this.visible=!0,this.data=new ImageData(s,i)}}const e=new class{constructor(t="New palette"){this.name=t,this.colors=[[]]}addColor(t){this.colors.push(t)}removeColor(t){this.colors.splice(t,1)}setColor(t,e){this.colors[t]=e}getColor(t){return this.colors[t]}}("Default");e.colors=[[0,0,0,255],[252,252,252,255],[248,248,248,255],[188,188,188,255],[124,124,124,255],[164,228,252,255],[60,188,252,255],[0,120,248,255],[0,0,252,255],[184,184,248,255],[104,136,252,255],[0,88,248,255],[0,0,188,255],[216,184,248,255],[152,120,248,255],[104,68,252,255],[68,40,188,255],[248,184,248,255],[248,120,248,255],[216,0,204,255],[148,0,132,255],[248,164,192,255],[248,88,152,255],[228,0,88,255],[168,0,32,255],[240,208,176,255],[248,120,88,255],[248,56,0,255],[168,16,0,255],[252,224,168,255],[252,160,68,255],[228,92,16,255],[136,20,0,255],[248,216,120,255],[248,184,0,255],[172,124,0,255],[80,40,0,255],[216,248,120,255],[184,248,24,255],[0,184,0,255],[0,120,0,255],[184,248,184,255],[88,216,84,255],[0,168,0,255],[0,104,0,255],[184,248,216,255],[88,248,152,255],[0,168,68,255],[0,88,0,255],[0,252,252,255],[0,232,216,255],[0,136,136,255],[0,64,88,255],[248,216,248,255],[120,120,120,255]];class s{constructor(s,i){this.width=s,this.height=i,this.data=[],this.palette=e,this.data=[new t("Background",!0,s,i)]}}class i{constructor(t){this.app=t,this.items=[],this.cursor=this.items.length-1}add(t){this.items.push(t),this.cursor=this.items.length-1}clearFromCursor(){this.items.splice(this.cursor+1)}undo(){}redo(){}}class a{constructor(t){this.app=t,this.zoom=25,this.file=this.app.files[this.app.fileIndex],this.grid=!0,this.gridSize=16,this._canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this.canvas.style.backgroundColor="white",this.canvas.width=this.app.files[this.app.fileIndex].width,this.canvas.height=this.app.files[this.app.fileIndex].height,this.canvas.style.imageRendering="pixelated",this.setZoom(this.zoom),this.canvas.addEventListener("wheel",(t=>{t.preventDefault(),this.zoomChange(t.deltaY)})),document.body.querySelector("#main").append(this.canvas);const s=this.ctx.createImageData(this.file.width,this.file.height),i=this.app.files[this.app.fileIndex];for(let t=0;t>i.data.length;t++)for(let a=0;a<i.data[t].data.width;a++)for(let o=0;o<i.data[t].data.height;o++){const t=e.getColor(0),i=4*(16*a+o);s.data[i]=t[0],s.data[i+1]=t[1],s.data[i+2]=t[2],s.data[i+3]=t[3]}this.ctx.putImageData(s,0,0),this.canvas.addEventListener("click",(t=>{this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height));const e=this.canvas.getBoundingClientRect(),i=Math.floor((t.clientX-e.left)/this.zoom),a=4*(Math.floor((t.clientY-e.top)/this.zoom)*this.file.width+i);s.data[a]=this.app.primaryColor[0],s.data[a+1]=this.app.primaryColor[1],s.data[a+2]=this.app.primaryColor[2],s.data[a+3]=this.app.primaryColor[3],this.ctx.putImageData(s,0,0),this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height))})),this.canvas.addEventListener("mousemove",(t=>{if(1===t.buttons){this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height));const e=this.canvas.getBoundingClientRect(),i=Math.floor((t.clientX-e.left)/this.zoom),a=4*(Math.floor((t.clientY-e.top)/this.zoom)*this.file.width+i);s.data[a]=this.app.primaryColor[0],s.data[a+1]=this.app.primaryColor[1],s.data[a+2]=this.app.primaryColor[2],s.data[a+3]=this.app.primaryColor[3],this.ctx.putImageData(s,0,0),this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height))}}))}get canvas(){return this._canvas}get ctx(){return this._ctx}drawRect(t,e,s,i,a){this.ctx.fillStyle=a,this.ctx.fillRect(t,e,s,i)}setZoom(t){this.zoom=t,this.canvas.style.width=this.file.width*this.zoom+"px",this.canvas.style.height=this.file.height*this.zoom+"px",this.update()}zoomChange(t=0){const e=Math.sign(t);this.zoom+=8*e,this.setZoom(this.zoom)}zoomIn(){console.log("zoom in"),this.zoom<128&&this.zoomChange(1)}zoomOut(){console.log("zoom out"),this.zoom>1&&this.zoomChange(-1)}zoomReset(){console.log("zoom reset"),this.setZoom(25)}update(){requestAnimationFrame(this.update.bind(this))}}class o{constructor(t){this.selector=t,this.element=document.querySelector(`#${t}`),this.closeBtn=this.element.querySelector(`#btnClose${t}`),this.closeBtn.addEventListener("click",(()=>{this.close()}))}toggle(){this.element.hasAttribute("open")?this.close():this.open()}open(){this.element.setAttribute("open","")}close(){this.element.removeAttribute("open"),window.localStorage.setItem("startup","false")}}class h{constructor(t,e){this.selector=t,this.app=e,this.commands={n:()=>{this.app.newFile()},e:()=>{},w:t=>{this.app.saveFile(t)},h:()=>{this.app.ui.helpDialog.toggle(),this.app.ui.log("Help")},p:()=>{this.app.ui.paletteDialog.toggle(),this.app.ui.log("Open palette")},P:()=>{},log:t=>{this.app.ui.log(t)}},this.element=document.querySelector(`#${t}`),this.element.addEventListener("keydown",(t=>{"Enter"===t.key&&(this.execute(this.element.value),this.close())}))}open(){this.element.classList.add("open"),this.element.focus(),this.element.value=":"}close(){this.element.classList.remove("open"),this.element.value=""}execute(t){t=t.slice(1);const[e,...s]=t.split(" ");console.log(e,s),e in this.commands?this.commands[e](...s):this.app.ui.log(`command not found: ${e}`)}}class l{constructor(t){this.title=t,this.id=Date.now().toString(),this.element=document.createElement("div"),this.tabTitle=document.createElement("span"),this.element.id=this.id,this.element.classList.add("tab"),this.closeBtn=document.createElement("button"),this.closeBtn.id=`#btnClose${this.id}`,this.closeBtn.textContent="X",this.tabTitle.textContent=t,this.element.append(this.tabTitle,this.closeBtn),document.querySelector("#tabs").appendChild(this.element),this.closeBtn.addEventListener("click",(()=>{this.close()}))}deactivateTab(){this.element.classList.remove("active")}activateTab(){this.element.classList.add("active")}rename(t){this.title=t,this.tabTitle.textContent=t}close(){this.element.removeAttribute("open")}}class n{constructor(t){this.app=t,this.startupDialog=new o("DialogStartup"),this.helpDialog=new o("DialogHelp"),this.inputCommand=new h("InputCmd",this.app),this.zoomElement=document.querySelector("#zoom"),this.primaryColorElement=document.querySelector("#toolPrColor"),this.statusLine=document.querySelector("#statusLine"),this.paletteDialog=new o("DialogPalette"),this.paletteWrap=document.querySelector("#paletteWrap"),this.paletteTitle=document.querySelector("#paletteTitle"),this.tabs=document.querySelector("#tabs"),this.app=t,window.localStorage.getItem("startup")&&"true"!==window.localStorage.getItem("startup")||this.startupDialog.open(),this.tabs.append(new l("Untitled").element),this.update()}renderPalette(){this.paletteWrap.innerHTML="",this.paletteTitle.textContent=this.app.palette.name,this.app.palette.colors.forEach(((t,e)=>{const s=document.createElement("div");s.classList.add("color-swatch"),s.style.backgroundColor=`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`,this.paletteWrap.append(s),s.addEventListener("click",(()=>{this.app.primaryColor=t,this.update()}))}))}log(t){this.to&&clearTimeout(this.to),this.statusLine.classList.add("open"),this.statusLine.textContent=t,this.to=setTimeout((()=>{this.statusLine.classList.remove("open"),this.statusLine.textContent=""}),2e3)}update(){this.renderPalette(),this.zoomElement.textContent=100*this.app.zoom+"%",this.primaryColorElement.style.backgroundColor=`rgba(${this.app.primaryColor[0]}, ${this.app.primaryColor[1]}, ${this.app.primaryColor[2]}, ${this.app.primaryColor[3]})`}}const r=new class{constructor(){this.history=new i(this),this.zoom=25,this.tool="pencil",this.color=1,this.files=[],this.fileIndex=0,this.palette=e,this.primaryColor=this.palette.getColor(0),this.palettes=[this.palette],this.ui=new n(this),this.layerIndex=0,this.files.push(new s(16,16)),this.renderer=new a(this),this.setup()}setup(){document.addEventListener("keydown",(t=>{if(t.metaKey&&"="===t.key)return t.preventDefault(),void this.renderer.zoomIn();if(t.metaKey&&"-"===t.key)return t.preventDefault(),void this.renderer.zoomOut();if(t.metaKey&&"0"===t.key)return t.preventDefault(),void this.renderer.zoomReset();if(t.metaKey&&"z"===t.key)return t.preventDefault(),void this.undo();switch(t.key){case"Space":this.ui.inputCommand.element.classList.contains("open")||(t.preventDefault(),this.renderer.canvas.style.cursor="grab",this.renderer.canvas.addEventListener("mousemove",(t=>{1===t.buttons&&(this.renderer.canvas.style.cursor="grabbing",this.renderer.canvas.style.left=`${t.movementX}px`,this.renderer.canvas.style.top=`${t.movementY}px`)})));break;case"?":t.preventDefault(),this.ui.helpDialog.toggle();break;case"Escape":t.preventDefault(),this.ui.inputCommand.element.classList.contains("open")?this.ui.inputCommand.close():this.ui.inputCommand.open()}})),document.addEventListener("keyup",(t=>{if(" "===t.key)t.preventDefault(),this.renderer.canvas.style.cursor="default"})),this.update()}update(){this.renderer.update(),this.ui.update()}fill(t,e,s,i){const a=this.files[this.fileIndex].data[this.layerIndex].data;if(t<0||t>=a.width||e<0||e>=a.height)return;const o=e*a.width+t;a.data[o]!==i&&a.data[o]===s&&(a.data[o]=i,this.fill(t+1,e,s,i),this.fill(t-1,e,s,i),this.fill(t,e+1,s,i),this.fill(t,e-1,s,i))}newFile(){console.log("new")}saveFile(t){console.log("save file as "+t)}undo(){this.history.undo()}redo(){this.history.redo()}changeTool(t){this.tool=t}};window.app=r})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJtYXBwaW5ncyI6Im1CQUFlLE1BQU1BLEVBQ2pCQyxZQUFZQyxFQUFPLFlBQWFDLEdBQVMsRUFBT0MsRUFBT0MsR0FDbkRDLEtBQUtKLEtBQU9BLEVBQ1pJLEtBQUtILE9BQVNBLEVBQ2RHLEtBQUtGLE1BQVFBLEVBQ2JFLEtBQUtELE9BQVNBLEVBQ2RDLEtBQUtDLFFBQVUsSUFDZkQsS0FBS0UsU0FBVSxFQUNmRixLQUFLRyxLQUFPLElBQUlDLFVBQVVOLEVBQU9DLEVBQ3JDLEVDU0csTUFBTU0sRUFBaUIsSUFsQmYsTUFDWFYsWUFBWUMsRUFBTyxlQUNmSSxLQUFLSixLQUFPQSxFQUNaSSxLQUFLTSxPQUFTLENBQUMsR0FDbkIsQ0FDQUMsU0FBU0MsR0FDTFIsS0FBS00sT0FBT0csS0FBS0QsRUFDckIsQ0FDQUUsWUFBWUMsR0FDUlgsS0FBS00sT0FBT00sT0FBT0QsRUFBTyxFQUM5QixDQUNBRSxTQUFTRixFQUFPSCxHQUNaUixLQUFLTSxPQUFPSyxHQUFTSCxDQUN6QixDQUNBTSxTQUFTSCxHQUNMLE9BQU9YLEtBQUtNLE9BQU9LLEVBQ3ZCLEdBRXNDLFdBRTFDTixFQUFlQyxPQUFTLENBQ3BCLENBQUMsRUFBRyxFQUFHLEVBQUcsS0FDVixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxHQUFJLElBQUssSUFBSyxLQUNmLENBQUMsRUFBRyxJQUFLLElBQUssS0FDZCxDQUFDLEVBQUcsRUFBRyxJQUFLLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsRUFBRyxHQUFJLElBQUssS0FDYixDQUFDLEVBQUcsRUFBRyxJQUFLLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxHQUFJLElBQUssS0FDZixDQUFDLEdBQUksR0FBSSxJQUFLLEtBQ2QsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxFQUFHLElBQUssS0FDZCxDQUFDLElBQUssRUFBRyxJQUFLLEtBQ2QsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssR0FBSSxJQUFLLEtBQ2YsQ0FBQyxJQUFLLEVBQUcsR0FBSSxLQUNiLENBQUMsSUFBSyxFQUFHLEdBQUksS0FDYixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLEdBQUksS0FDZixDQUFDLElBQUssR0FBSSxFQUFHLEtBQ2IsQ0FBQyxJQUFLLEdBQUksRUFBRyxLQUNiLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssR0FBSSxLQUNmLENBQUMsSUFBSyxHQUFJLEdBQUksS0FDZCxDQUFDLElBQUssR0FBSSxFQUFHLEtBQ2IsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxFQUFHLEtBQ2QsQ0FBQyxJQUFLLElBQUssRUFBRyxLQUNkLENBQUMsR0FBSSxHQUFJLEVBQUcsS0FDWixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLEdBQUksS0FDZixDQUFDLEVBQUcsSUFBSyxFQUFHLEtBQ1osQ0FBQyxFQUFHLElBQUssRUFBRyxLQUNaLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxHQUFJLElBQUssR0FBSSxLQUNkLENBQUMsRUFBRyxJQUFLLEVBQUcsS0FDWixDQUFDLEVBQUcsSUFBSyxFQUFHLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLEdBQUksSUFBSyxJQUFLLEtBQ2YsQ0FBQyxFQUFHLElBQUssR0FBSSxLQUNiLENBQUMsRUFBRyxHQUFJLEVBQUcsS0FDWCxDQUFDLEVBQUcsSUFBSyxJQUFLLEtBQ2QsQ0FBQyxFQUFHLElBQUssSUFBSyxLQUNkLENBQUMsRUFBRyxJQUFLLElBQUssS0FDZCxDQUFDLEVBQUcsR0FBSSxHQUFJLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLE1DekViLE1BQU1TLEVBQ1RwQixZQUFZRyxFQUFPQyxHQUNmQyxLQUFLRixNQUFRQSxFQUNiRSxLQUFLRCxPQUFTQSxFQUNkQyxLQUFLRyxLQUFPLEdBQ1pILEtBQUtnQixRQUFVWCxFQUNmTCxLQUFLRyxLQUFPLENBQUMsSUFBSVQsRUFBTSxjQUFjLEVBQU1JLEVBQU9DLEdBQ3RELEVDVFcsTUFBTWtCLEVBQ2pCdEIsWUFBWXVCLEdBQ1JsQixLQUFLa0IsSUFBTUEsRUFDWGxCLEtBQUttQixNQUFRLEdBQ2JuQixLQUFLb0IsT0FBU3BCLEtBQUttQixNQUFNRSxPQUFTLENBQ3RDLENBQ0FDLElBQUlDLEdBQ0F2QixLQUFLbUIsTUFBTVYsS0FBS2MsR0FDaEJ2QixLQUFLb0IsT0FBU3BCLEtBQUttQixNQUFNRSxPQUFTLENBQ3RDLENBQ0FHLGtCQUNJeEIsS0FBS21CLE1BQU1QLE9BQU9aLEtBQUtvQixPQUFTLEVBQ3BDLENBQ0FLLE9BS0EsQ0FDQUMsT0FLQSxFQ3ZCVyxNQUFNQyxFQUNqQmhDLFlBQVl1QixHQUNSbEIsS0FBS2tCLElBQU1BLEVBQ1hsQixLQUFLNEIsS0FBTyxHQUNaNUIsS0FBSzZCLEtBQU83QixLQUFLa0IsSUFBSVksTUFBTTlCLEtBQUtrQixJQUFJYSxXQUNwQy9CLEtBQUtnQyxNQUFPLEVBQ1poQyxLQUFLaUMsU0FBVyxHQUNoQmpDLEtBQUtrQyxRQUFVQyxTQUFTQyxjQUFjLFVBQ3RDcEMsS0FBS3FDLEtBQU9yQyxLQUFLc0MsT0FBT0MsV0FBVyxNQUNuQ3ZDLEtBQUtzQyxPQUFPRSxNQUFNQyxnQkFBa0IsUUFDcEN6QyxLQUFLc0MsT0FBT3hDLE1BQVFFLEtBQUtrQixJQUFJWSxNQUFNOUIsS0FBS2tCLElBQUlhLFdBQVdqQyxNQUN2REUsS0FBS3NDLE9BQU92QyxPQUFTQyxLQUFLa0IsSUFBSVksTUFBTTlCLEtBQUtrQixJQUFJYSxXQUFXaEMsT0FDeERDLEtBQUtzQyxPQUFPRSxNQUFNRSxlQUFpQixZQUNuQzFDLEtBQUsyQyxRQUFRM0MsS0FBSzRCLE1BRWxCNUIsS0FBS3NDLE9BQU9NLGlCQUFpQixTQUFVQyxJQUNuQ0EsRUFBRUMsaUJBQ0Y5QyxLQUFLK0MsV0FBV0YsRUFBRUcsT0FBTyxJQUU3QmIsU0FBU2MsS0FBS0MsY0FBYyxTQUFTQyxPQUFPbkQsS0FBS3NDLFFBQ2pELE1BQU1jLEVBQVlwRCxLQUFLcUQsSUFBSUMsZ0JBQWdCdEQsS0FBSzZCLEtBQUsvQixNQUFPRSxLQUFLNkIsS0FBSzlCLFFBQ2hFOEIsRUFBTzdCLEtBQUtrQixJQUFJWSxNQUFNOUIsS0FBS2tCLElBQUlhLFdBQ3JDLElBQUssSUFBSXdCLEVBQUksRUFBR0EsRUFBSTFCLEVBQUsxQixLQUFLa0IsT0FBUWtDLElBQ2xDLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJM0IsRUFBSzFCLEtBQUtvRCxHQUFHcEQsS0FBS0wsTUFBTzBELElBQ3pDLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJNUIsRUFBSzFCLEtBQUtvRCxHQUFHcEQsS0FBS0osT0FBUTBELElBQUssQ0FJL0MsTUFBTWpELEVBQVFILEVBQWVTLFNBQVMsR0FDaENILEVBQXVCLEdBQVYsR0FBSjZDLEVBQVNDLEdBQ3hCTCxFQUFVakQsS0FBS1EsR0FBU0gsRUFBTSxHQUM5QjRDLEVBQVVqRCxLQUFLUSxFQUFRLEdBQUtILEVBQU0sR0FDbEM0QyxFQUFVakQsS0FBS1EsRUFBUSxHQUFLSCxFQUFNLEdBQ2xDNEMsRUFBVWpELEtBQUtRLEVBQVEsR0FBS0gsRUFBTSxFQUN0QyxDQUdSUixLQUFLcUQsSUFBSUssYUFBYU4sRUFBVyxFQUFHLEdBRXBDcEQsS0FBS3NDLE9BQU9NLGlCQUFpQixTQUFVQyxJQUNuQzdDLEtBQUtrQixJQUFJeUMsUUFBUXJDLElBQUl0QixLQUFLcUQsSUFBSU8sYUFBYSxFQUFHLEVBQUc1RCxLQUFLNkIsS0FBSy9CLE1BQU9FLEtBQUs2QixLQUFLOUIsU0FDNUUsTUFBTThELEVBQU83RCxLQUFLc0MsT0FBT3dCLHdCQUNuQkwsRUFBSU0sS0FBS0MsT0FBT25CLEVBQUVvQixRQUFVSixFQUFLSyxNQUFRbEUsS0FBSzRCLE1BRTlDakIsRUFBb0MsR0FEaENvRCxLQUFLQyxPQUFPbkIsRUFBRXNCLFFBQVVOLEVBQUtPLEtBQU9wRSxLQUFLNEIsTUFDaEM1QixLQUFLNkIsS0FBSy9CLE1BQVEyRCxHQUVyQ0wsRUFBVWpELEtBQUtRLEdBQVNYLEtBQUtrQixJQUFJbUQsYUFBYSxHQUM5Q2pCLEVBQVVqRCxLQUFLUSxFQUFRLEdBQUtYLEtBQUtrQixJQUFJbUQsYUFBYSxHQUNsRGpCLEVBQVVqRCxLQUFLUSxFQUFRLEdBQUtYLEtBQUtrQixJQUFJbUQsYUFBYSxHQUNsRGpCLEVBQVVqRCxLQUFLUSxFQUFRLEdBQUtYLEtBQUtrQixJQUFJbUQsYUFBYSxHQUNsRHJFLEtBQUtxRCxJQUFJSyxhQUFhTixFQUFXLEVBQUcsR0FDcENwRCxLQUFLa0IsSUFBSXlDLFFBQVFyQyxJQUFJdEIsS0FBS3FELElBQUlPLGFBQWEsRUFBRyxFQUFHNUQsS0FBSzZCLEtBQUsvQixNQUFPRSxLQUFLNkIsS0FBSzlCLFFBQVEsSUFHeEZDLEtBQUtzQyxPQUFPTSxpQkFBaUIsYUFBY0MsSUFDdkMsR0FBa0IsSUFBZEEsRUFBRXlCLFFBQWUsQ0FDakJ0RSxLQUFLa0IsSUFBSXlDLFFBQVFyQyxJQUFJdEIsS0FBS3FELElBQUlPLGFBQWEsRUFBRyxFQUFHNUQsS0FBSzZCLEtBQUsvQixNQUFPRSxLQUFLNkIsS0FBSzlCLFNBQzVFLE1BQU04RCxFQUFPN0QsS0FBS3NDLE9BQU93Qix3QkFDbkJMLEVBQUlNLEtBQUtDLE9BQU9uQixFQUFFb0IsUUFBVUosRUFBS0ssTUFBUWxFLEtBQUs0QixNQUU5Q2pCLEVBQW9DLEdBRGhDb0QsS0FBS0MsT0FBT25CLEVBQUVzQixRQUFVTixFQUFLTyxLQUFPcEUsS0FBSzRCLE1BQ2hDNUIsS0FBSzZCLEtBQUsvQixNQUFRMkQsR0FHckNMLEVBQVVqRCxLQUFLUSxHQUFTWCxLQUFLa0IsSUFBSW1ELGFBQWEsR0FDOUNqQixFQUFVakQsS0FBS1EsRUFBUSxHQUFLWCxLQUFLa0IsSUFBSW1ELGFBQWEsR0FDbERqQixFQUFVakQsS0FBS1EsRUFBUSxHQUFLWCxLQUFLa0IsSUFBSW1ELGFBQWEsR0FDbERqQixFQUFVakQsS0FBS1EsRUFBUSxHQUFLWCxLQUFLa0IsSUFBSW1ELGFBQWEsR0FDbERyRSxLQUFLcUQsSUFBSUssYUFBYU4sRUFBVyxFQUFHLEdBQ3BDcEQsS0FBS2tCLElBQUl5QyxRQUFRckMsSUFBSXRCLEtBQUtxRCxJQUFJTyxhQUFhLEVBQUcsRUFBRzVELEtBQUs2QixLQUFLL0IsTUFBT0UsS0FBSzZCLEtBQUs5QixRQUNoRixJQUVSLENBQ0l1QyxhQUNBLE9BQU90QyxLQUFLa0MsT0FDaEIsQ0FDSW1CLFVBQ0EsT0FBT3JELEtBQUtxQyxJQUNoQixDQUNBa0MsU0FBU2QsRUFBR0QsRUFBR2dCLEVBQUdDLEVBQUdqRSxHQUNqQlIsS0FBS3FELElBQUlxQixVQUFZbEUsRUFDckJSLEtBQUtxRCxJQUFJc0IsU0FBU2xCLEVBQUdELEVBQUdnQixFQUFHQyxFQUMvQixDQUNBOUIsUUFBUWYsR0FDSjVCLEtBQUs0QixLQUFPQSxFQUNaNUIsS0FBS3NDLE9BQU9FLE1BQU0xQyxNQUFXRSxLQUFLNkIsS0FBSy9CLE1BQVFFLEtBQUs0QixLQUExQixLQUMxQjVCLEtBQUtzQyxPQUFPRSxNQUFNekMsT0FBWUMsS0FBSzZCLEtBQUs5QixPQUFTQyxLQUFLNEIsS0FBM0IsS0FDM0I1QixLQUFLNEUsUUFDVCxDQUNBN0IsV0FBVzhCLEVBQUssR0FDWixNQUFNQyxFQUFRZixLQUFLZ0IsS0FBS0YsR0FDeEI3RSxLQUFLNEIsTUFBZ0IsRUFBUmtELEVBQ2I5RSxLQUFLMkMsUUFBUTNDLEtBQUs0QixLQUN0QixDQUNBb0QsU0FDSUMsUUFBUUMsSUFBSSxXQUNSbEYsS0FBSzRCLEtBQU8sS0FDWjVCLEtBQUsrQyxXQUFXLEVBRXhCLENBQ0FvQyxVQUNJRixRQUFRQyxJQUFJLFlBQ1JsRixLQUFLNEIsS0FBTyxHQUNaNUIsS0FBSytDLFlBQVksRUFFekIsQ0FDQXFDLFlBQ0lILFFBQVFDLElBQUksY0FDWmxGLEtBQUsyQyxRQUFRLEdBQ2pCLENBQ0FpQyxTQUNJUyxzQkFBc0JyRixLQUFLNEUsT0FBT1UsS0FBS3RGLE1BQzNDLEVDaEhXLE1BQU11RixFQUNqQjVGLFlBQVk2RixHQUNSeEYsS0FBS3dGLFNBQVdBLEVBQ2hCeEYsS0FBS3lGLFFBQVV0RCxTQUFTZSxjQUFjLElBQUlzQyxLQUMxQ3hGLEtBQUswRixTQUFXMUYsS0FBS3lGLFFBQVF2QyxjQUFjLFlBQVlzQyxLQUN2RHhGLEtBQUswRixTQUFTOUMsaUJBQWlCLFNBQVMsS0FDcEM1QyxLQUFLMkYsT0FBTyxHQUVwQixDQUNBQyxTQUNRNUYsS0FBS3lGLFFBQVFJLGFBQWEsUUFDMUI3RixLQUFLMkYsUUFHTDNGLEtBQUs4RixNQUViLENBQ0FBLE9BQ0k5RixLQUFLeUYsUUFBUU0sYUFBYSxPQUFRLEdBQ3RDLENBQ0FKLFFBQ0kzRixLQUFLeUYsUUFBUU8sZ0JBQWdCLFFBQzdCQyxPQUFPQyxhQUFhQyxRQUFRLFVBQVcsUUFDM0MsRUN2QlcsTUFBTUMsRUFDakJ6RyxZQUFZNkYsRUFBVXRFLEdBQ2xCbEIsS0FBS3dGLFNBQVdBLEVBQ2hCeEYsS0FBS2tCLElBQU1BLEVBQ1hsQixLQUFLcUcsU0FBVyxDQUNaQyxFQUFHLEtBQ0N0RyxLQUFLa0IsSUFBSXFGLFNBQVMsRUFFdEIxRCxFQUFHLE9BQ0gyQixFQUFJZ0MsSUFDQXhHLEtBQUtrQixJQUFJdUYsU0FBU0QsRUFBSyxFQUUzQi9CLEVBQUcsS0FDQ3pFLEtBQUtrQixJQUFJd0YsR0FBR0MsV0FBV2YsU0FDdkI1RixLQUFLa0IsSUFBSXdGLEdBQUd4QixJQUFJLE9BQU8sRUFFM0IwQixFQUFHLEtBQ0M1RyxLQUFLa0IsSUFBSXdGLEdBQUdHLGNBQWNqQixTQUMxQjVGLEtBQUtrQixJQUFJd0YsR0FBR3hCLElBQUksZUFBZSxFQUVuQzRCLEVBQUcsT0FDSDVCLElBQU02QixJQUNGL0csS0FBS2tCLElBQUl3RixHQUFHeEIsSUFBSTZCLEVBQUksR0FHNUIvRyxLQUFLeUYsUUFBVXRELFNBQVNlLGNBQWMsSUFBSXNDLEtBQzFDeEYsS0FBS3lGLFFBQVE3QyxpQkFBaUIsV0FBWUMsSUFDeEIsVUFBVkEsRUFBRW1FLE1BQ0ZoSCxLQUFLaUgsUUFBUWpILEtBQUt5RixRQUFReUIsT0FDMUJsSCxLQUFLMkYsUUFDVCxHQUVSLENBQ0FHLE9BQ0k5RixLQUFLeUYsUUFBUTBCLFVBQVU3RixJQUFJLFFBQzNCdEIsS0FBS3lGLFFBQVEyQixRQUNicEgsS0FBS3lGLFFBQVF5QixNQUFRLEdBQ3pCLENBQ0F2QixRQUNJM0YsS0FBS3lGLFFBQVEwQixVQUFVRSxPQUFPLFFBQzlCckgsS0FBS3lGLFFBQVF5QixNQUFRLEVBQ3pCLENBQ0FELFFBQVFLLEdBQ0pBLEVBQU1BLEVBQUlDLE1BQU0sR0FDaEIsTUFBT0MsS0FBWUMsR0FBUUgsRUFBSUksTUFBTSxLQUNyQ3pDLFFBQVFDLElBQUlzQyxFQUFTQyxHQUNqQkQsS0FBV3hILEtBQUtxRyxTQUNoQnJHLEtBQUtxRyxTQUFTbUIsTUFBWUMsR0FHMUJ6SCxLQUFLa0IsSUFBSXdGLEdBQUd4QixJQUFJLHNCQUFzQnNDLElBRTlDLEVDbERKLE1BQU1HLEVBQ0ZoSSxZQUFZaUksR0FDUjVILEtBQUs0SCxNQUFRQSxFQUNiNUgsS0FBSzZILEdBQUtDLEtBQUtDLE1BQU1DLFdBQ3JCaEksS0FBS3lGLFFBQVV0RCxTQUFTQyxjQUFjLE9BQ3RDcEMsS0FBS2lJLFNBQVc5RixTQUFTQyxjQUFjLFFBQ3ZDcEMsS0FBS3lGLFFBQVFvQyxHQUFLN0gsS0FBSzZILEdBQ3ZCN0gsS0FBS3lGLFFBQVEwQixVQUFVN0YsSUFBSSxPQUMzQnRCLEtBQUswRixTQUFXdkQsU0FBU0MsY0FBYyxVQUN2Q3BDLEtBQUswRixTQUFTbUMsR0FBSyxZQUFZN0gsS0FBSzZILEtBQ3BDN0gsS0FBSzBGLFNBQVN3QyxZQUFjLElBQzVCbEksS0FBS2lJLFNBQVNDLFlBQWNOLEVBQzVCNUgsS0FBS3lGLFFBQVF0QyxPQUFPbkQsS0FBS2lJLFNBQVVqSSxLQUFLMEYsVUFDeEN2RCxTQUFTZSxjQUFjLFNBQVNpRixZQUFZbkksS0FBS3lGLFNBQ2pEekYsS0FBSzBGLFNBQVM5QyxpQkFBaUIsU0FBUyxLQUNwQzVDLEtBQUsyRixPQUFPLEdBRXBCLENBQ0F5QyxnQkFDSXBJLEtBQUt5RixRQUFRMEIsVUFBVUUsT0FBTyxTQUNsQyxDQUNBZ0IsY0FDSXJJLEtBQUt5RixRQUFRMEIsVUFBVTdGLElBQUksU0FDL0IsQ0FDQWdILE9BQU9WLEdBQ0g1SCxLQUFLNEgsTUFBUUEsRUFDYjVILEtBQUtpSSxTQUFTQyxZQUFjTixDQUNoQyxDQUNBakMsUUFDSTNGLEtBQUt5RixRQUFRTyxnQkFBZ0IsT0FDakMsRUFFVyxNQUFNdUMsRUFDakI1SSxZQUFZdUIsR0FDUmxCLEtBQUtrQixJQUFNQSxFQUNYbEIsS0FBS3dJLGNBQWdCLElBQUlqRCxFQUFjLGlCQUN2Q3ZGLEtBQUsyRyxXQUFhLElBQUlwQixFQUFjLGNBQ3BDdkYsS0FBS3lJLGFBQWUsSUFBSXJDLEVBQWEsV0FBWXBHLEtBQUtrQixLQUN0RGxCLEtBQUswSSxZQUFjdkcsU0FBU2UsY0FBYyxTQUMxQ2xELEtBQUsySSxvQkFBc0J4RyxTQUFTZSxjQUFjLGdCQUNsRGxELEtBQUs0SSxXQUFhekcsU0FBU2UsY0FBYyxlQUN6Q2xELEtBQUs2RyxjQUFnQixJQUFJdEIsRUFBYyxpQkFDdkN2RixLQUFLNkksWUFBYzFHLFNBQVNlLGNBQWMsZ0JBQzFDbEQsS0FBSzhJLGFBQWUzRyxTQUFTZSxjQUFjLGlCQUMzQ2xELEtBQUsrSSxLQUFPNUcsU0FBU2UsY0FBYyxTQUNuQ2xELEtBQUtrQixJQUFNQSxFQUNOK0UsT0FBT0MsYUFBYThDLFFBQVEsWUFDYyxTQUEzQy9DLE9BQU9DLGFBQWE4QyxRQUFRLFlBQzVCaEosS0FBS3dJLGNBQWMxQyxPQUV2QjlGLEtBQUsrSSxLQUFLNUYsT0FBTyxJQUFJd0UsRUFBSSxZQUFZbEMsU0FDckN6RixLQUFLNEUsUUFDVCxDQUNBcUUsZ0JBQ0lqSixLQUFLNkksWUFBWUssVUFBWSxHQUM3QmxKLEtBQUs4SSxhQUFhWixZQUFjbEksS0FBS2tCLElBQUlGLFFBQVFwQixLQUNqREksS0FBS2tCLElBQUlGLFFBQVFWLE9BQU82SSxTQUFRLENBQUMzSSxFQUFPRyxLQUNwQyxNQUFNeUksRUFBS2pILFNBQVNDLGNBQWMsT0FDbENnSCxFQUFHakMsVUFBVTdGLElBQUksZ0JBQ2pCOEgsRUFBRzVHLE1BQU1DLGdCQUFrQixRQUFRakMsRUFBTSxPQUFPQSxFQUFNLE9BQU9BLEVBQU0sT0FBT0EsRUFBTSxNQUNoRlIsS0FBSzZJLFlBQVkxRixPQUFPaUcsR0FDeEJBLEVBQUd4RyxpQkFBaUIsU0FBUyxLQUN6QjVDLEtBQUtrQixJQUFJbUQsYUFBZTdELEVBQ3hCUixLQUFLNEUsUUFBUSxHQUNmLEdBRVYsQ0FDQU0sSUFBSTZCLEdBQ0EvRyxLQUFLcUosSUFBTUMsYUFBYXRKLEtBQUtxSixJQUM3QnJKLEtBQUs0SSxXQUFXekIsVUFBVTdGLElBQUksUUFDOUJ0QixLQUFLNEksV0FBV1YsWUFBY25CLEVBQzlCL0csS0FBS3FKLEdBQUtFLFlBQVcsS0FDakJ2SixLQUFLNEksV0FBV3pCLFVBQVVFLE9BQU8sUUFDakNySCxLQUFLNEksV0FBV1YsWUFBYyxFQUFFLEdBQ2pDLElBQ1AsQ0FDQXRELFNBQ0k1RSxLQUFLaUosZ0JBQ0xqSixLQUFLMEksWUFBWVIsWUFBaUMsSUFBaEJsSSxLQUFLa0IsSUFBSVUsS0FBWixJQUMvQjVCLEtBQUsySSxvQkFBb0JuRyxNQUFNQyxnQkFBa0IsUUFBUXpDLEtBQUtrQixJQUFJbUQsYUFBYSxPQUFPckUsS0FBS2tCLElBQUltRCxhQUFhLE9BQU9yRSxLQUFLa0IsSUFBSW1ELGFBQWEsT0FBT3JFLEtBQUtrQixJQUFJbUQsYUFBYSxLQUMxSyxFQ2pGSixNQUFNbkQsRUFBTSxJQ01HLE1BQ1h2QixjQUNJSyxLQUFLMkQsUUFBVSxJQUFJMUMsRUFBUWpCLE1BQzNCQSxLQUFLNEIsS0FBTyxHQUNaNUIsS0FBS3dKLEtBQU8sU0FDWnhKLEtBQUtRLE1BQVEsRUFDYlIsS0FBSzhCLE1BQVEsR0FDYjlCLEtBQUsrQixVQUFZLEVBQ2pCL0IsS0FBS2dCLFFBQVVYLEVBQ2ZMLEtBQUtxRSxhQUFlckUsS0FBS2dCLFFBQVFGLFNBQVMsR0FDMUNkLEtBQUt5SixTQUFXLENBQUN6SixLQUFLZ0IsU0FDdEJoQixLQUFLMEcsR0FBSyxJQUFJNkIsRUFBR3ZJLE1BQ2pCQSxLQUFLMEosV0FBYSxFQUNsQjFKLEtBQUs4QixNQUFNckIsS0FBSyxJQUFJTSxFQWZOLEdBQ0MsS0FlZmYsS0FBSzJKLFNBQVcsSUFBSWhJLEVBQVMzQixNQUM3QkEsS0FBSzRKLE9BQ1QsQ0FDQUEsUUFFSXpILFNBQVNTLGlCQUFpQixXQUFZQyxJQUNsQyxHQUFJQSxFQUFFZ0gsU0FBcUIsTUFBVmhILEVBQUVtRSxJQUdmLE9BRkFuRSxFQUFFQyxzQkFDRjlDLEtBQUsySixTQUFTM0UsU0FHbEIsR0FBSW5DLEVBQUVnSCxTQUFxQixNQUFWaEgsRUFBRW1FLElBR2YsT0FGQW5FLEVBQUVDLHNCQUNGOUMsS0FBSzJKLFNBQVN4RSxVQUdsQixHQUFJdEMsRUFBRWdILFNBQXFCLE1BQVZoSCxFQUFFbUUsSUFHZixPQUZBbkUsRUFBRUMsc0JBQ0Y5QyxLQUFLMkosU0FBU3ZFLFlBR2xCLEdBQUl2QyxFQUFFZ0gsU0FBcUIsTUFBVmhILEVBQUVtRSxJQUdmLE9BRkFuRSxFQUFFQyxzQkFDRjlDLEtBQUt5QixPQUdULE9BQVFvQixFQUFFbUUsS0FFTixJQUFLLFFBQ0loSCxLQUFLMEcsR0FBRytCLGFBQWFoRCxRQUFRMEIsVUFBVTJDLFNBQVMsVUFDakRqSCxFQUFFQyxpQkFDRjlDLEtBQUsySixTQUFTckgsT0FBT0UsTUFBTXBCLE9BQVMsT0FDcENwQixLQUFLMkosU0FBU3JILE9BQU9NLGlCQUFpQixhQUFjQyxJQUM5QixJQUFkQSxFQUFFeUIsVUFDRnRFLEtBQUsySixTQUFTckgsT0FBT0UsTUFBTXBCLE9BQVMsV0FDcENwQixLQUFLMkosU0FBU3JILE9BQU9FLE1BQU0wQixLQUFPLEdBQUdyQixFQUFFa0gsY0FDdkMvSixLQUFLMkosU0FBU3JILE9BQU9FLE1BQU00QixJQUFNLEdBQUd2QixFQUFFbUgsY0FDMUMsS0FHUixNQUNKLElBQUssSUFDRG5ILEVBQUVDLGlCQUNGOUMsS0FBSzBHLEdBQUdDLFdBQVdmLFNBQ25CLE1BQ0osSUFBSyxTQUNEL0MsRUFBRUMsaUJBQ0U5QyxLQUFLMEcsR0FBRytCLGFBQWFoRCxRQUFRMEIsVUFBVTJDLFNBQVMsUUFDaEQ5SixLQUFLMEcsR0FBRytCLGFBQWE5QyxRQUdyQjNGLEtBQUswRyxHQUFHK0IsYUFBYTNDLE9BRWpDLElBRUozRCxTQUFTUyxpQkFBaUIsU0FBVUMsSUFDaEMsR0FDUyxNQUREQSxFQUFFbUUsSUFFRm5FLEVBQUVDLGlCQUNGOUMsS0FBSzJKLFNBQVNySCxPQUFPRSxNQUFNcEIsT0FBUyxTQUU1QyxJQUVKcEIsS0FBSzRFLFFBQ1QsQ0FDQUEsU0FDSTVFLEtBQUsySixTQUFTL0UsU0FDZDVFLEtBQUswRyxHQUFHOUIsUUFDWixDQUNBcUYsS0FBS0MsRUFBUUMsRUFBUUMsRUFBYUMsR0FDOUIsTUFBTUMsRUFBU3RLLEtBQUs4QixNQUFNOUIsS0FBSytCLFdBQVc1QixLQUFLSCxLQUFLMEosWUFBWXZKLEtBRWhFLEdBQUkrSixFQUFTLEdBQ1RBLEdBQVVJLEVBQU94SyxPQUNqQnFLLEVBQVMsR0FDVEEsR0FBVUcsRUFBT3ZLLE9BQ2pCLE9BRUosTUFBTVksRUFBUXdKLEVBQVNHLEVBQU94SyxNQUFRb0ssRUFFbENJLEVBQU9uSyxLQUFLUSxLQUFXMEosR0FJdkJDLEVBQU9uSyxLQUFLUSxLQUFXeUosSUFJM0JFLEVBQU9uSyxLQUFLUSxHQUFTMEosRUFFckJySyxLQUFLaUssS0FBS0MsRUFBUyxFQUFHQyxFQUFRQyxFQUFhQyxHQUMzQ3JLLEtBQUtpSyxLQUFLQyxFQUFTLEVBQUdDLEVBQVFDLEVBQWFDLEdBQzNDckssS0FBS2lLLEtBQUtDLEVBQVFDLEVBQVMsRUFBR0MsRUFBYUMsR0FDM0NySyxLQUFLaUssS0FBS0MsRUFBUUMsRUFBUyxFQUFHQyxFQUFhQyxHQUMvQyxDQUNBOUQsVUFDSXRCLFFBQVFDLElBQUksTUFDaEIsQ0FDQXVCLFNBQVNELEdBQ0x2QixRQUFRQyxJQUFJLGdCQUFrQnNCLEVBQ2xDLENBQ0EvRSxPQUNJekIsS0FBSzJELFFBQVFsQyxNQUNqQixDQUNBQyxPQUNJMUIsS0FBSzJELFFBQVFqQyxNQUNqQixDQUNBNkksV0FBV2YsR0FDUHhKLEtBQUt3SixLQUFPQSxDQUNoQixHRC9ISnZELE9BQU8vRSxJQUFNQSxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9sYXllci50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL3BhbGV0dGUudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9maWxlLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvaGlzdG9yeS50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL3JlbmRlcmVyLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvZGlhbG9nLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvaW5wdXQtY29tbWFuZC50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL3VpLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGF5ZXIge1xuICAgIGNvbnN0cnVjdG9yKG5hbWUgPSBcIk5ldyBsYXllclwiLCBsb2NrZWQgPSBmYWxzZSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmxvY2tlZCA9IGxvY2tlZDtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgdGhpcy5vcGFjaXR5ID0gMjU1O1xuICAgICAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xuICAgICAgICB0aGlzLmRhdGEgPSBuZXcgSW1hZ2VEYXRhKHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhbGV0dGUge1xuICAgIGNvbnN0cnVjdG9yKG5hbWUgPSBcIk5ldyBwYWxldHRlXCIpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5jb2xvcnMgPSBbW11dO1xuICAgIH1cbiAgICBhZGRDb2xvcihjb2xvcikge1xuICAgICAgICB0aGlzLmNvbG9ycy5wdXNoKGNvbG9yKTtcbiAgICB9XG4gICAgcmVtb3ZlQ29sb3IoaW5kZXgpIHtcbiAgICAgICAgdGhpcy5jb2xvcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gICAgc2V0Q29sb3IoaW5kZXgsIGNvbG9yKSB7XG4gICAgICAgIHRoaXMuY29sb3JzW2luZGV4XSA9IGNvbG9yO1xuICAgIH1cbiAgICBnZXRDb2xvcihpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xvcnNbaW5kZXhdO1xuICAgIH1cbn1cbmV4cG9ydCBjb25zdCBkZWZhdWx0UGFsZXR0ZSA9IG5ldyBQYWxldHRlKFwiRGVmYXVsdFwiKTtcbi8vIE5FUyBwYWxldHRlXG5kZWZhdWx0UGFsZXR0ZS5jb2xvcnMgPSBbXG4gICAgWzAsIDAsIDAsIDI1NV0sXG4gICAgWzI1MiwgMjUyLCAyNTIsIDI1NV0sXG4gICAgWzI0OCwgMjQ4LCAyNDgsIDI1NV0sXG4gICAgWzE4OCwgMTg4LCAxODgsIDI1NV0sXG4gICAgWzEyNCwgMTI0LCAxMjQsIDI1NV0sXG4gICAgWzE2NCwgMjI4LCAyNTIsIDI1NV0sXG4gICAgWzYwLCAxODgsIDI1MiwgMjU1XSxcbiAgICBbMCwgMTIwLCAyNDgsIDI1NV0sXG4gICAgWzAsIDAsIDI1MiwgMjU1XSxcbiAgICBbMTg0LCAxODQsIDI0OCwgMjU1XSxcbiAgICBbMTA0LCAxMzYsIDI1MiwgMjU1XSxcbiAgICBbMCwgODgsIDI0OCwgMjU1XSxcbiAgICBbMCwgMCwgMTg4LCAyNTVdLFxuICAgIFsyMTYsIDE4NCwgMjQ4LCAyNTVdLFxuICAgIFsxNTIsIDEyMCwgMjQ4LCAyNTVdLFxuICAgIFsxMDQsIDY4LCAyNTIsIDI1NV0sXG4gICAgWzY4LCA0MCwgMTg4LCAyNTVdLFxuICAgIFsyNDgsIDE4NCwgMjQ4LCAyNTVdLFxuICAgIFsyNDgsIDEyMCwgMjQ4LCAyNTVdLFxuICAgIFsyMTYsIDAsIDIwNCwgMjU1XSxcbiAgICBbMTQ4LCAwLCAxMzIsIDI1NV0sXG4gICAgWzI0OCwgMTY0LCAxOTIsIDI1NV0sXG4gICAgWzI0OCwgODgsIDE1MiwgMjU1XSxcbiAgICBbMjI4LCAwLCA4OCwgMjU1XSxcbiAgICBbMTY4LCAwLCAzMiwgMjU1XSxcbiAgICBbMjQwLCAyMDgsIDE3NiwgMjU1XSxcbiAgICBbMjQ4LCAxMjAsIDg4LCAyNTVdLFxuICAgIFsyNDgsIDU2LCAwLCAyNTVdLFxuICAgIFsxNjgsIDE2LCAwLCAyNTVdLFxuICAgIFsyNTIsIDIyNCwgMTY4LCAyNTVdLFxuICAgIFsyNTIsIDE2MCwgNjgsIDI1NV0sXG4gICAgWzIyOCwgOTIsIDE2LCAyNTVdLFxuICAgIFsxMzYsIDIwLCAwLCAyNTVdLFxuICAgIFsyNDgsIDIxNiwgMTIwLCAyNTVdLFxuICAgIFsyNDgsIDE4NCwgMCwgMjU1XSxcbiAgICBbMTcyLCAxMjQsIDAsIDI1NV0sXG4gICAgWzgwLCA0MCwgMCwgMjU1XSxcbiAgICBbMjE2LCAyNDgsIDEyMCwgMjU1XSxcbiAgICBbMTg0LCAyNDgsIDI0LCAyNTVdLFxuICAgIFswLCAxODQsIDAsIDI1NV0sXG4gICAgWzAsIDEyMCwgMCwgMjU1XSxcbiAgICBbMTg0LCAyNDgsIDE4NCwgMjU1XSxcbiAgICBbODgsIDIxNiwgODQsIDI1NV0sXG4gICAgWzAsIDE2OCwgMCwgMjU1XSxcbiAgICBbMCwgMTA0LCAwLCAyNTVdLFxuICAgIFsxODQsIDI0OCwgMjE2LCAyNTVdLFxuICAgIFs4OCwgMjQ4LCAxNTIsIDI1NV0sXG4gICAgWzAsIDE2OCwgNjgsIDI1NV0sXG4gICAgWzAsIDg4LCAwLCAyNTVdLFxuICAgIFswLCAyNTIsIDI1MiwgMjU1XSxcbiAgICBbMCwgMjMyLCAyMTYsIDI1NV0sXG4gICAgWzAsIDEzNiwgMTM2LCAyNTVdLFxuICAgIFswLCA2NCwgODgsIDI1NV0sXG4gICAgWzI0OCwgMjE2LCAyNDgsIDI1NV0sXG4gICAgWzEyMCwgMTIwLCAxMjAsIDI1NV0sXG5dO1xuIiwiaW1wb3J0IExheWVyIGZyb20gXCIuL2xheWVyXCI7XG5pbXBvcnQgeyBkZWZhdWx0UGFsZXR0ZSB9IGZyb20gXCIuL3BhbGV0dGVcIjtcbmV4cG9ydCBjbGFzcyBXaXpGaWxlIHtcbiAgICBjb25zdHJ1Y3Rvcih3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLnBhbGV0dGUgPSBkZWZhdWx0UGFsZXR0ZTtcbiAgICAgICAgdGhpcy5kYXRhID0gW25ldyBMYXllcihcIkJhY2tncm91bmRcIiwgdHJ1ZSwgd2lkdGgsIGhlaWdodCldO1xuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEhpc3Rvcnkge1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLmN1cnNvciA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgYWRkKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5pdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICB0aGlzLmN1cnNvciA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgY2xlYXJGcm9tQ3Vyc29yKCkge1xuICAgICAgICB0aGlzLml0ZW1zLnNwbGljZSh0aGlzLmN1cnNvciArIDEpO1xuICAgIH1cbiAgICB1bmRvKCkge1xuICAgICAgICAvLyAgaWYgKHRoaXMuY3Vyc29yID4gMCkge1xuICAgICAgICAvLyAgICB0aGlzLmN1cnNvci0tO1xuICAgICAgICAvLyAgICB0aGlzLmFwcC5maWxlc1t0aGlzLmFwcC5maWxlSW5kZXhdLmRhdGEucHV0SW1hZ2VEYXRhKHRoaXMuaXRlbXNbdGhpcy5jdXJzb3JdLCAwLCAwKTtcbiAgICAgICAgLy8gIH1cbiAgICB9XG4gICAgcmVkbygpIHtcbiAgICAgICAgLy8gIGlmICh0aGlzLmN1cnNvciA8IHRoaXMuaXRlbXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAvLyAgICB0aGlzLmN1cnNvcisrO1xuICAgICAgICAvLyAgICB0aGlzLmFwcC5jdHgucHV0SW1hZ2VEYXRhKHRoaXMuaXRlbXNbdGhpcy5jdXJzb3JdLCAwLCAwKTtcbiAgICAgICAgLy8gIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBkZWZhdWx0UGFsZXR0ZSB9IGZyb20gXCIuL3BhbGV0dGVcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyIHtcbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuem9vbSA9IDI1O1xuICAgICAgICB0aGlzLmZpbGUgPSB0aGlzLmFwcC5maWxlc1t0aGlzLmFwcC5maWxlSW5kZXhdO1xuICAgICAgICB0aGlzLmdyaWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmdyaWRTaXplID0gMTY7XG4gICAgICAgIHRoaXMuX2NhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4gICAgICAgIHRoaXMuX2N0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuYXBwLmZpbGVzW3RoaXMuYXBwLmZpbGVJbmRleF0ud2lkdGg7XG4gICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuYXBwLmZpbGVzW3RoaXMuYXBwLmZpbGVJbmRleF0uaGVpZ2h0O1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5pbWFnZVJlbmRlcmluZyA9IFwicGl4ZWxhdGVkXCI7XG4gICAgICAgIHRoaXMuc2V0Wm9vbSh0aGlzLnpvb20pO1xuICAgICAgICAvLyBhYmlsaXR5IHRvIHpvb20gaW4gYW5kIG91dCB3aXRoIG1vdXNlIHdoZWVsXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy56b29tQ2hhbmdlKGUuZGVsdGFZKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcihcIiNtYWluXCIpLmFwcGVuZCh0aGlzLmNhbnZhcyk7XG4gICAgICAgIGNvbnN0IGltYWdlRGF0YSA9IHRoaXMuY3R4LmNyZWF0ZUltYWdlRGF0YSh0aGlzLmZpbGUud2lkdGgsIHRoaXMuZmlsZS5oZWlnaHQpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAuZmlsZXNbdGhpcy5hcHAuZmlsZUluZGV4XTtcbiAgICAgICAgZm9yIChsZXQgbCA9IDA7IGwgPiBmaWxlLmRhdGEubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgZmlsZS5kYXRhW2xdLmRhdGEud2lkdGg7IHkrKykge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgZmlsZS5kYXRhW2xdLmRhdGEuaGVpZ2h0OyB4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zdCBjb2xvciA9IGZpbGUucGFsZXR0ZVxuICAgICAgICAgICAgICAgICAgICAvLz8gZmlsZS5wYWxldHRlLmdldENvbG9yKGZpbGUuZGF0YVtsXS5kYXRhW3ldW3hdKVxuICAgICAgICAgICAgICAgICAgICAvLzogZGVmYXVsdFBhbGV0dGUuZ2V0Q29sb3IoZmlsZS5kYXRhW2xdLmRhdGFbeV1beF0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xvciA9IGRlZmF1bHRQYWxldHRlLmdldENvbG9yKDApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9ICh5ICogMTYgKyB4KSAqIDQ7XG4gICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4XSA9IGNvbG9yWzBdO1xuICAgICAgICAgICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDFdID0gY29sb3JbMV07XG4gICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgMl0gPSBjb2xvclsyXTtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAzXSA9IGNvbG9yWzNdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmN0eC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcbiAgICAgICAgLy8gYWJpbGl0eSB0byBkcmF3IHBpeGVsIHdpdGggbW91c2UgY2xpY2tcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFwcC5oaXN0b3J5LmFkZCh0aGlzLmN0eC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5maWxlLndpZHRoLCB0aGlzLmZpbGUuaGVpZ2h0KSk7XG4gICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBjb25zdCB4ID0gTWF0aC5mbG9vcigoZS5jbGllbnRYIC0gcmVjdC5sZWZ0KSAvIHRoaXMuem9vbSk7XG4gICAgICAgICAgICBjb25zdCB5ID0gTWF0aC5mbG9vcigoZS5jbGllbnRZIC0gcmVjdC50b3ApIC8gdGhpcy56b29tKTtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gKHkgKiB0aGlzLmZpbGUud2lkdGggKyB4KSAqIDQ7XG4gICAgICAgICAgICAvL3RoaXMuZmlsZXNbdGhpcy5maWxlSW5kZXhdLmRhdGFbdGhpcy5sYXllckluZGV4XS5kYXRhW3ldW3hdID0gdGhpcy5jb2xvcjtcbiAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4XSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclswXTtcbiAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgMV0gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMV07XG4gICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDJdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzJdO1xuICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAzXSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclszXTtcbiAgICAgICAgICAgIHRoaXMuY3R4LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xuICAgICAgICAgICAgdGhpcy5hcHAuaGlzdG9yeS5hZGQodGhpcy5jdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMuZmlsZS53aWR0aCwgdGhpcy5maWxlLmhlaWdodCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gYWJpbGl0eSB0byBkcmF3IHBpeGVsIHdpdGggbW91c2UgbW92ZVxuICAgICAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5idXR0b25zID09PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuaGlzdG9yeS5hZGQodGhpcy5jdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMuZmlsZS53aWR0aCwgdGhpcy5maWxlLmhlaWdodCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICBjb25zdCB4ID0gTWF0aC5mbG9vcigoZS5jbGllbnRYIC0gcmVjdC5sZWZ0KSAvIHRoaXMuem9vbSk7XG4gICAgICAgICAgICAgICAgY29uc3QgeSA9IE1hdGguZmxvb3IoKGUuY2xpZW50WSAtIHJlY3QudG9wKSAvIHRoaXMuem9vbSk7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSAoeSAqIHRoaXMuZmlsZS53aWR0aCArIHgpICogNDtcbiAgICAgICAgICAgICAgICAvL3RoaXMuZmlsZXNbdGhpcy5maWxlSW5kZXhdLmRhdGFbdGhpcy5sYXllckluZGV4XS5kYXRhW3ldW3hdID1cbiAgICAgICAgICAgICAgICAvLyB0aGlzLmNvbG9yO1xuICAgICAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4XSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclswXTtcbiAgICAgICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDFdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzFdO1xuICAgICAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgMl0gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMl07XG4gICAgICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAzXSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclszXTtcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5oaXN0b3J5LmFkZCh0aGlzLmN0eC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5maWxlLndpZHRoLCB0aGlzLmZpbGUuaGVpZ2h0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgY2FudmFzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FudmFzO1xuICAgIH1cbiAgICBnZXQgY3R4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3R4O1xuICAgIH1cbiAgICBkcmF3UmVjdCh4LCB5LCB3LCBoLCBjb2xvcikge1xuICAgICAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSBjb2xvcjtcbiAgICAgICAgdGhpcy5jdHguZmlsbFJlY3QoeCwgeSwgdywgaCk7XG4gICAgfVxuICAgIHNldFpvb20oem9vbSkge1xuICAgICAgICB0aGlzLnpvb20gPSB6b29tO1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS53aWR0aCA9IGAke3RoaXMuZmlsZS53aWR0aCAqIHRoaXMuem9vbX1weGA7XG4gICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuZmlsZS5oZWlnaHQgKiB0aGlzLnpvb219cHhgO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH1cbiAgICB6b29tQ2hhbmdlKGR0ID0gMCkge1xuICAgICAgICBjb25zdCBkZWx0YSA9IE1hdGguc2lnbihkdCk7XG4gICAgICAgIHRoaXMuem9vbSArPSBkZWx0YSAqIDg7XG4gICAgICAgIHRoaXMuc2V0Wm9vbSh0aGlzLnpvb20pO1xuICAgIH1cbiAgICB6b29tSW4oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiem9vbSBpblwiKTtcbiAgICAgICAgaWYgKHRoaXMuem9vbSA8IDEyOCkge1xuICAgICAgICAgICAgdGhpcy56b29tQ2hhbmdlKDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHpvb21PdXQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiem9vbSBvdXRcIik7XG4gICAgICAgIGlmICh0aGlzLnpvb20gPiAxKSB7XG4gICAgICAgICAgICB0aGlzLnpvb21DaGFuZ2UoLTEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHpvb21SZXNldCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ6b29tIHJlc2V0XCIpO1xuICAgICAgICB0aGlzLnNldFpvb20oMjUpO1xuICAgIH1cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBEaWFsb2dFbGVtZW50IHtcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xuICAgICAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3NlbGVjdG9yfWApO1xuICAgICAgICB0aGlzLmNsb3NlQnRuID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidG5DbG9zZSR7c2VsZWN0b3J9YCk7XG4gICAgICAgIHRoaXMuY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRvZ2dsZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJvcGVuXCIpKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwib3BlblwiLCBcIlwiKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJvcGVuXCIpO1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzdGFydHVwXCIsIFwiZmFsc2VcIik7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5wdXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgYXBwKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuY29tbWFuZHMgPSB7XG4gICAgICAgICAgICBuOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAubmV3RmlsZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGU6ICgpID0+IHsgfSxcbiAgICAgICAgICAgIHc6ICh0eXBlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2F2ZUZpbGUodHlwZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnVpLmhlbHBEaWFsb2cudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkubG9nKFwiSGVscFwiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkucGFsZXR0ZURpYWxvZy50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC51aS5sb2coXCJPcGVuIHBhbGV0dGVcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgUDogKCkgPT4geyB9LFxuICAgICAgICAgICAgbG9nOiAobXNnKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkubG9nKG1zZyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtzZWxlY3Rvcn1gKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZSh0aGlzLmVsZW1lbnQudmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9wZW4oKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IFwiOlwiO1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICAgIH1cbiAgICBleGVjdXRlKGNtZCkge1xuICAgICAgICBjbWQgPSBjbWQuc2xpY2UoMSk7XG4gICAgICAgIGNvbnN0IFtjb21tYW5kLCAuLi5hcmdzXSA9IGNtZC5zcGxpdChcIiBcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKGNvbW1hbmQsIGFyZ3MpO1xuICAgICAgICBpZiAoY29tbWFuZCBpbiB0aGlzLmNvbW1hbmRzKSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRzW2NvbW1hbmRdKC4uLmFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hcHAudWkubG9nKGBjb21tYW5kIG5vdCBmb3VuZDogJHtjb21tYW5kfWApO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IERpYWxvZ0VsZW1lbnQgZnJvbSBcIi4vZGlhbG9nXCI7XG5pbXBvcnQgSW5wdXRDb21tYW5kIGZyb20gXCIuL2lucHV0LWNvbW1hbmRcIjtcbmNsYXNzIFRhYiB7XG4gICAgY29uc3RydWN0b3IodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLmlkID0gRGF0ZS5ub3coKS50b1N0cmluZygpO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLnRhYlRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IHRoaXMuaWQ7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFiXCIpO1xuICAgICAgICB0aGlzLmNsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgdGhpcy5jbG9zZUJ0bi5pZCA9IGAjYnRuQ2xvc2Uke3RoaXMuaWR9YDtcbiAgICAgICAgdGhpcy5jbG9zZUJ0bi50ZXh0Q29udGVudCA9IFwiWFwiO1xuICAgICAgICB0aGlzLnRhYlRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmQodGhpcy50YWJUaXRsZSwgdGhpcy5jbG9zZUJ0bik7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGFic1wiKS5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICB0aGlzLmNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZWFjdGl2YXRlVGFiKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICB9XG4gICAgYWN0aXZhdGVUYWIoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgIH1cbiAgICByZW5hbWUodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLnRhYlRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwib3BlblwiKTtcbiAgICB9XG59XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVSSB7XG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnN0YXJ0dXBEaWFsb2cgPSBuZXcgRGlhbG9nRWxlbWVudChcIkRpYWxvZ1N0YXJ0dXBcIik7XG4gICAgICAgIHRoaXMuaGVscERpYWxvZyA9IG5ldyBEaWFsb2dFbGVtZW50KFwiRGlhbG9nSGVscFwiKTtcbiAgICAgICAgdGhpcy5pbnB1dENvbW1hbmQgPSBuZXcgSW5wdXRDb21tYW5kKFwiSW5wdXRDbWRcIiwgdGhpcy5hcHApO1xuICAgICAgICB0aGlzLnpvb21FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN6b29tXCIpO1xuICAgICAgICB0aGlzLnByaW1hcnlDb2xvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Rvb2xQckNvbG9yXCIpO1xuICAgICAgICB0aGlzLnN0YXR1c0xpbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3N0YXR1c0xpbmVcIik7XG4gICAgICAgIHRoaXMucGFsZXR0ZURpYWxvZyA9IG5ldyBEaWFsb2dFbGVtZW50KFwiRGlhbG9nUGFsZXR0ZVwiKTtcbiAgICAgICAgdGhpcy5wYWxldHRlV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGFsZXR0ZVdyYXBcIik7XG4gICAgICAgIHRoaXMucGFsZXR0ZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwYWxldHRlVGl0bGVcIik7XG4gICAgICAgIHRoaXMudGFicyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGFic1wiKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIGlmICghd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwic3RhcnR1cFwiKSB8fFxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwic3RhcnR1cFwiKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnR1cERpYWxvZy5vcGVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50YWJzLmFwcGVuZChuZXcgVGFiKFwiVW50aXRsZWRcIikuZWxlbWVudCk7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuICAgIHJlbmRlclBhbGV0dGUoKSB7XG4gICAgICAgIHRoaXMucGFsZXR0ZVdyYXAuaW5uZXJIVE1MID0gXCJcIjtcbiAgICAgICAgdGhpcy5wYWxldHRlVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLmFwcC5wYWxldHRlLm5hbWU7XG4gICAgICAgIHRoaXMuYXBwLnBhbGV0dGUuY29sb3JzLmZvckVhY2goKGNvbG9yLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImNvbG9yLXN3YXRjaFwiKTtcbiAgICAgICAgICAgIGVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2JhKCR7Y29sb3JbMF19LCAke2NvbG9yWzFdfSwgJHtjb2xvclsyXX0sICR7Y29sb3JbM119KWA7XG4gICAgICAgICAgICB0aGlzLnBhbGV0dGVXcmFwLmFwcGVuZChlbCk7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnByaW1hcnlDb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxvZyhtc2cpIHtcbiAgICAgICAgdGhpcy50byAmJiBjbGVhclRpbWVvdXQodGhpcy50byk7XG4gICAgICAgIHRoaXMuc3RhdHVzTGluZS5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5zdGF0dXNMaW5lLnRleHRDb250ZW50ID0gbXNnO1xuICAgICAgICB0aGlzLnRvID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0xpbmUuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0xpbmUudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICB9LCAyMDAwKTtcbiAgICB9XG4gICAgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLnJlbmRlclBhbGV0dGUoKTtcbiAgICAgICAgdGhpcy56b29tRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RoaXMuYXBwLnpvb20gKiAxMDB9JWA7XG4gICAgICAgIHRoaXMucHJpbWFyeUNvbG9yRWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBgcmdiYSgke3RoaXMuYXBwLnByaW1hcnlDb2xvclswXX0sICR7dGhpcy5hcHAucHJpbWFyeUNvbG9yWzFdfSwgJHt0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMl19LCAke3RoaXMuYXBwLnByaW1hcnlDb2xvclszXX0pYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgQXBwIGZyb20gXCIuL2FwcFwiO1xuY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuLy9AdHMtaWdub3JlXG53aW5kb3cuYXBwID0gYXBwO1xuIiwiaW1wb3J0IHsgV2l6RmlsZSB9IGZyb20gXCIuL2ZpbGVcIjtcbmltcG9ydCBIaXN0b3J5IGZyb20gXCIuL2hpc3RvcnlcIjtcbmltcG9ydCB7IGRlZmF1bHRQYWxldHRlIH0gZnJvbSBcIi4vcGFsZXR0ZVwiO1xuaW1wb3J0IFJlbmRlcmVyIGZyb20gXCIuL3JlbmRlcmVyXCI7XG5pbXBvcnQgVUkgZnJvbSBcIi4vdWlcIjtcbmNvbnN0IERFRkFVTFRfV0lEVEggPSAxNjtcbmNvbnN0IERFRkFVTFRfSEVJR0hUID0gMTY7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcHAge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmhpc3RvcnkgPSBuZXcgSGlzdG9yeSh0aGlzKTtcbiAgICAgICAgdGhpcy56b29tID0gMjU7XG4gICAgICAgIHRoaXMudG9vbCA9IFwicGVuY2lsXCI7XG4gICAgICAgIHRoaXMuY29sb3IgPSAxO1xuICAgICAgICB0aGlzLmZpbGVzID0gW107XG4gICAgICAgIHRoaXMuZmlsZUluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5wYWxldHRlID0gZGVmYXVsdFBhbGV0dGU7XG4gICAgICAgIHRoaXMucHJpbWFyeUNvbG9yID0gdGhpcy5wYWxldHRlLmdldENvbG9yKDApO1xuICAgICAgICB0aGlzLnBhbGV0dGVzID0gW3RoaXMucGFsZXR0ZV07XG4gICAgICAgIHRoaXMudWkgPSBuZXcgVUkodGhpcyk7XG4gICAgICAgIHRoaXMubGF5ZXJJbmRleCA9IDA7XG4gICAgICAgIHRoaXMuZmlsZXMucHVzaChuZXcgV2l6RmlsZShERUZBVUxUX1dJRFRILCBERUZBVUxUX0hFSUdIVCkpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gbmV3IFJlbmRlcmVyKHRoaXMpO1xuICAgICAgICB0aGlzLnNldHVwKCk7XG4gICAgfVxuICAgIHNldHVwKCkge1xuICAgICAgICAvLyBhYmlsaXR5IHRvIHVuZG8gY2hhbmdlcyB3aXRoIGNtZCArIHpcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLm1ldGFLZXkgJiYgZS5rZXkgPT09IFwiPVwiKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuem9vbUluKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUubWV0YUtleSAmJiBlLmtleSA9PT0gXCItXCIpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci56b29tT3V0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUubWV0YUtleSAmJiBlLmtleSA9PT0gXCIwXCIpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci56b29tUmVzZXQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5tZXRhS2V5ICYmIGUua2V5ID09PSBcInpcIikge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVuZG8oKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaG9sZCBzcGFjZSBhbmQgbW92ZSBtb3VzZSwgbW92ZSBjYW52YXNcbiAgICAgICAgICAgICAgICBjYXNlIFwiU3BhY2VcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnVpLmlucHV0Q29tbWFuZC5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcIm9wZW5cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2FudmFzLnN0eWxlLmN1cnNvciA9IFwiZ3JhYlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmJ1dHRvbnMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jYW52YXMuc3R5bGUuY3Vyc29yID0gXCJncmFiYmluZ1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNhbnZhcy5zdHlsZS5sZWZ0ID0gYCR7ZS5tb3ZlbWVudFh9cHhgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNhbnZhcy5zdHlsZS50b3AgPSBgJHtlLm1vdmVtZW50WX1weGA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIj9cIjpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVpLmhlbHBEaWFsb2cudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJFc2NhcGVcIjpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51aS5pbnB1dENvbW1hbmQuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJvcGVuXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVpLmlucHV0Q29tbWFuZC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51aS5pbnB1dENvbW1hbmQub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiIFwiOlxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2FudmFzLnN0eWxlLmN1cnNvciA9IFwiZGVmYXVsdFwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci51cGRhdGUoKTtcbiAgICAgICAgdGhpcy51aS51cGRhdGUoKTtcbiAgICB9XG4gICAgZmlsbChzdGFydFgsIHN0YXJ0WSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcikge1xuICAgICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmZpbGVzW3RoaXMuZmlsZUluZGV4XS5kYXRhW3RoaXMubGF5ZXJJbmRleF0uZGF0YTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHN0YXJ0IGNvb3JkaW5hdGVzIGFyZSBvdXQgb2YgYm91bmRzXG4gICAgICAgIGlmIChzdGFydFggPCAwIHx8XG4gICAgICAgICAgICBzdGFydFggPj0gbWF0cml4LndpZHRoIHx8XG4gICAgICAgICAgICBzdGFydFkgPCAwIHx8XG4gICAgICAgICAgICBzdGFydFkgPj0gbWF0cml4LmhlaWdodCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluZGV4ID0gc3RhcnRZICogbWF0cml4LndpZHRoICsgc3RhcnRYO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0IHZhbHVlIG1hdGNoZXMgdGhlIHJlcGxhY2VtZW50IHZhbHVlXG4gICAgICAgIGlmIChtYXRyaXguZGF0YVtpbmRleF0gPT09IHJlcGxhY2VDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBjdXJyZW50IHZhbHVlIG1hdGNoZXMgdGhlIHRhcmdldCB2YWx1ZVxuICAgICAgICBpZiAobWF0cml4LmRhdGFbaW5kZXhdICE9PSB0YXJnZXRDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlcGxhY2UgdGhlIGN1cnJlbnQgdmFsdWUgd2l0aCB0aGUgcmVwbGFjZW1lbnQgdmFsdWVcbiAgICAgICAgbWF0cml4LmRhdGFbaW5kZXhdID0gcmVwbGFjZUNvbG9yO1xuICAgICAgICAvLyBSZWN1cnNpdmVseSBmaWxsIGFkamFjZW50IGNlbGxzXG4gICAgICAgIHRoaXMuZmlsbChzdGFydFggKyAxLCBzdGFydFksIHRhcmdldENvbG9yLCByZXBsYWNlQ29sb3IpOyAvLyBSaWdodFxuICAgICAgICB0aGlzLmZpbGwoc3RhcnRYIC0gMSwgc3RhcnRZLCB0YXJnZXRDb2xvciwgcmVwbGFjZUNvbG9yKTsgLy8gTGVmdFxuICAgICAgICB0aGlzLmZpbGwoc3RhcnRYLCBzdGFydFkgKyAxLCB0YXJnZXRDb2xvciwgcmVwbGFjZUNvbG9yKTsgLy8gRG93blxuICAgICAgICB0aGlzLmZpbGwoc3RhcnRYLCBzdGFydFkgLSAxLCB0YXJnZXRDb2xvciwgcmVwbGFjZUNvbG9yKTsgLy8gVXBcbiAgICB9XG4gICAgbmV3RmlsZSgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJuZXdcIik7XG4gICAgfVxuICAgIHNhdmVGaWxlKHR5cGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJzYXZlIGZpbGUgYXMgXCIgKyB0eXBlKTtcbiAgICB9XG4gICAgdW5kbygpIHtcbiAgICAgICAgdGhpcy5oaXN0b3J5LnVuZG8oKTtcbiAgICB9XG4gICAgcmVkbygpIHtcbiAgICAgICAgdGhpcy5oaXN0b3J5LnJlZG8oKTtcbiAgICB9XG4gICAgY2hhbmdlVG9vbCh0b29sKSB7XG4gICAgICAgIHRoaXMudG9vbCA9IHRvb2w7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbIkxheWVyIiwiY29uc3RydWN0b3IiLCJuYW1lIiwibG9ja2VkIiwid2lkdGgiLCJoZWlnaHQiLCJ0aGlzIiwib3BhY2l0eSIsInZpc2libGUiLCJkYXRhIiwiSW1hZ2VEYXRhIiwiZGVmYXVsdFBhbGV0dGUiLCJjb2xvcnMiLCJhZGRDb2xvciIsImNvbG9yIiwicHVzaCIsInJlbW92ZUNvbG9yIiwiaW5kZXgiLCJzcGxpY2UiLCJzZXRDb2xvciIsImdldENvbG9yIiwiV2l6RmlsZSIsInBhbGV0dGUiLCJIaXN0b3J5IiwiYXBwIiwiaXRlbXMiLCJjdXJzb3IiLCJsZW5ndGgiLCJhZGQiLCJpdGVtIiwiY2xlYXJGcm9tQ3Vyc29yIiwidW5kbyIsInJlZG8iLCJSZW5kZXJlciIsInpvb20iLCJmaWxlIiwiZmlsZXMiLCJmaWxlSW5kZXgiLCJncmlkIiwiZ3JpZFNpemUiLCJfY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiX2N0eCIsImNhbnZhcyIsImdldENvbnRleHQiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImltYWdlUmVuZGVyaW5nIiwic2V0Wm9vbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ6b29tQ2hhbmdlIiwiZGVsdGFZIiwiYm9keSIsInF1ZXJ5U2VsZWN0b3IiLCJhcHBlbmQiLCJpbWFnZURhdGEiLCJjdHgiLCJjcmVhdGVJbWFnZURhdGEiLCJsIiwieSIsIngiLCJwdXRJbWFnZURhdGEiLCJoaXN0b3J5IiwiZ2V0SW1hZ2VEYXRhIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIk1hdGgiLCJmbG9vciIsImNsaWVudFgiLCJsZWZ0IiwiY2xpZW50WSIsInRvcCIsInByaW1hcnlDb2xvciIsImJ1dHRvbnMiLCJkcmF3UmVjdCIsInciLCJoIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJ1cGRhdGUiLCJkdCIsImRlbHRhIiwic2lnbiIsInpvb21JbiIsImNvbnNvbGUiLCJsb2ciLCJ6b29tT3V0Iiwiem9vbVJlc2V0IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYmluZCIsIkRpYWxvZ0VsZW1lbnQiLCJzZWxlY3RvciIsImVsZW1lbnQiLCJjbG9zZUJ0biIsImNsb3NlIiwidG9nZ2xlIiwiaGFzQXR0cmlidXRlIiwib3BlbiIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJJbnB1dENvbW1hbmQiLCJjb21tYW5kcyIsIm4iLCJuZXdGaWxlIiwidHlwZSIsInNhdmVGaWxlIiwidWkiLCJoZWxwRGlhbG9nIiwicCIsInBhbGV0dGVEaWFsb2ciLCJQIiwibXNnIiwia2V5IiwiZXhlY3V0ZSIsInZhbHVlIiwiY2xhc3NMaXN0IiwiZm9jdXMiLCJyZW1vdmUiLCJjbWQiLCJzbGljZSIsImNvbW1hbmQiLCJhcmdzIiwic3BsaXQiLCJUYWIiLCJ0aXRsZSIsImlkIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwidGFiVGl0bGUiLCJ0ZXh0Q29udGVudCIsImFwcGVuZENoaWxkIiwiZGVhY3RpdmF0ZVRhYiIsImFjdGl2YXRlVGFiIiwicmVuYW1lIiwiVUkiLCJzdGFydHVwRGlhbG9nIiwiaW5wdXRDb21tYW5kIiwiem9vbUVsZW1lbnQiLCJwcmltYXJ5Q29sb3JFbGVtZW50Iiwic3RhdHVzTGluZSIsInBhbGV0dGVXcmFwIiwicGFsZXR0ZVRpdGxlIiwidGFicyIsImdldEl0ZW0iLCJyZW5kZXJQYWxldHRlIiwiaW5uZXJIVE1MIiwiZm9yRWFjaCIsImVsIiwidG8iLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwidG9vbCIsInBhbGV0dGVzIiwibGF5ZXJJbmRleCIsInJlbmRlcmVyIiwic2V0dXAiLCJtZXRhS2V5IiwiY29udGFpbnMiLCJtb3ZlbWVudFgiLCJtb3ZlbWVudFkiLCJmaWxsIiwic3RhcnRYIiwic3RhcnRZIiwidGFyZ2V0Q29sb3IiLCJyZXBsYWNlQ29sb3IiLCJtYXRyaXgiLCJjaGFuZ2VUb29sIl0sInNvdXJjZVJvb3QiOiIifQ==