(()=>{"use strict";class t{constructor(t="New Layer",e=!1,i=16,s=16){this.name=t,this.locked=e,this.width=i,this.height=s,this.opacity=255,this.visible=!0,this.data=new ImageData(i,s)}}const e=new class{constructor(t="New palette"){this.name=t,this.colors=[[]]}addColor(t){this.colors.push(t)}removeColor(t){this.colors.splice(t,1)}setColor(t,e){this.colors[t]=e}getColor(t){return this.colors[t]}}("Default");e.colors=[[0,0,0,255],[252,252,252,255],[248,248,248,255],[188,188,188,255],[124,124,124,255],[164,228,252,255],[60,188,252,255],[0,120,248,255],[0,0,252,255],[184,184,248,255],[104,136,252,255],[0,88,248,255],[0,0,188,255],[216,184,248,255],[152,120,248,255],[104,68,252,255],[68,40,188,255],[248,184,248,255],[248,120,248,255],[216,0,204,255],[148,0,132,255],[248,164,192,255],[248,88,152,255],[228,0,88,255],[168,0,32,255],[240,208,176,255],[248,120,88,255],[248,56,0,255],[168,16,0,255],[252,224,168,255],[252,160,68,255],[228,92,16,255],[136,20,0,255],[248,216,120,255],[248,184,0,255],[172,124,0,255],[80,40,0,255],[216,248,120,255],[184,248,24,255],[0,184,0,255],[0,120,0,255],[184,248,184,255],[88,216,84,255],[0,168,0,255],[0,104,0,255],[184,248,216,255],[88,248,152,255],[0,168,68,255],[0,88,0,255],[0,252,252,255],[0,232,216,255],[0,136,136,255],[0,64,88,255],[248,216,248,255],[120,120,120,255]];class i{constructor(i,s){this.width=i,this.height=s,this.data=[],this.palette=e,this.data=[new t("Background",!0,i,s)]}setCanvasSize(t,e){this.width=t,this.height=e,this.data.forEach((i=>{const s=i.data;i.data=new ImageData(t,e),i.data.data.set(s.data)}))}}class s{constructor(t){this.data=t,this.timestamp=Date.now()}}class a{constructor(){this.max=5,this.stack=[],this.buffer=null}add(t){this.stack.length>=this.max&&this.stack.shift(),this.stack.push(new s(t))}undo(){return this.stack.length>0?(this.buffer=this.stack.pop(),this.buffer.data):null}redo(){return this.buffer?(this.stack.push(this.buffer),this.buffer=null,this.stack[this.stack.length-1].data):null}clear(){this.stack=[]}}class o{constructor(t){this.commands={n:()=>{this.app.newFile()},nl:()=>{this.app.newLayer()},l:()=>{this.app.ui.layersDialog.toggle()},e:()=>{},w:(t,e)=>{this.app.saveFile(t,{scale:parseInt(e)})},h:()=>{this.app.ui.helpDialog.toggle(),this.app.ui.log("Help")},p:()=>{this.app.ui.paletteDialog.toggle(),this.app.ui.log("Open palette")},P:()=>{},log:t=>{this.app.ui.log(t)},hs:()=>{this.app.ui.startupDialog.toggle()},cs:t=>{this.app.ui.setColorScheme(t)}},this.app=t,this.element=document.createElement("input"),this.element.id="InputCommand",this.element.className="input input--cmd",console.log(this.app.ui),this.app.ui._container.append(this.element),this.element.addEventListener("keydown",(t=>{"Enter"===t.key&&(this.execute(this.element.value),this.close())}))}open(){this.element.classList.add("open"),this.element.focus(),this.element.value=":"}close(){this.element.classList.remove("open"),this.element.value=""}execute(t){t=t.slice(1);const[e,...i]=t.split(" ");console.log(e,i),e in this.commands?this.commands[e](...i):this.app.ui.log(`command not found: ${e}`)}}class n{constructor(t){this.app=t,this.zoom=25,this.file=this.app.currentFile,this.grid=!0,this.gridSize=16,this._canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this.canvas.style.backgroundColor="white",this.canvas.width=this.app.files[this.app.fileIndex].width,this.canvas.height=this.app.files[this.app.fileIndex].height,this.canvas.style.backgroundImage="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><rect width='16' height='16' fill='none'/><rect x='0' y='0' width='8' height='8' fill='%23f0f0f0'/><rect x='8' y='8' width='8' height='8' fill='%23f0f0f0'/></svg>\")",this.canvas.style.backgroundSize="16px 16px",this.canvas.style.imageRendering="pixelated",this.setZoom(this.zoom),this.canvas.addEventListener("wheel",(t=>{t.preventDefault(),this.zoomChange(t.deltaY)})),document.body.querySelector("#main").append(this.canvas);const e=this.ctx.createImageData(this.file.width,this.file.height);this.canvas.addEventListener("click",(t=>{this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height));const i=this.canvas.getBoundingClientRect(),s=Math.floor((t.clientX-i.left)/this.zoom),a=4*(Math.floor((t.clientY-i.top)/this.zoom)*this.file.width+s);e.data[a]=this.app.primaryColor[0],e.data[a+1]=this.app.primaryColor[1],e.data[a+2]=this.app.primaryColor[2],e.data[a+3]=this.app.primaryColor[3],this.ctx.putImageData(e,0,0),this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height))})),this.canvas.addEventListener("mousemove",(t=>{if(1===t.buttons){this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height));const i=this.canvas.getBoundingClientRect(),s=Math.floor((t.clientX-i.left)/this.zoom),a=4*(Math.floor((t.clientY-i.top)/this.zoom)*this.file.width+s);e.data[a]=this.app.primaryColor[0],e.data[a+1]=this.app.primaryColor[1],e.data[a+2]=this.app.primaryColor[2],e.data[a+3]=this.app.primaryColor[3],this.ctx.putImageData(e,0,0),this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height))}}))}get canvas(){return this._canvas}get ctx(){return this._ctx}drawRect(t,e,i,s,a){this.ctx.fillStyle=a,this.ctx.fillRect(t,e,i,s)}fill(t,e,i,s){const a=this.file.data[this.app.layerIndex].data;if(t<0||t>=a.width||e<0||e>=a.height)return;const o=e*a.width+t;a.data[o]!==s&&a.data[o]===i&&(a.data[o]=s,this.fill(t+1,e,i,s),this.fill(t-1,e,i,s),this.fill(t,e+1,i,s),this.fill(t,e-1,i,s))}setZoom(t){this.zoom=t,this.canvas.style.width=this.file.width*this.zoom+"px",this.canvas.style.height=this.file.height*this.zoom+"px",this.update()}zoomChange(t=0){const e=Math.sign(t);this.zoom+=8*e,this.setZoom(this.zoom)}zoomIn(){console.log("zoom in"),this.zoom<128&&this.zoomChange(1)}zoomOut(){console.log("zoom out"),this.zoom>1&&this.zoomChange(-1)}zoomReset(){console.log("zoom reset"),this.setZoom(25)}update(){requestAnimationFrame(this.update.bind(this))}}class l{constructor(t,e,i="Dialog",s="",a=!1){this.name=t,this.container=e,this.title=i,this.content=s,this._template=`\n    <style>\n      .dialog {\n        background-color: var(--bg-color);\n        border-radius: 0.5rem;\n        border: 1px solid var(--mid-color);\n        color: var(--fg-color);\n        min-width: 320px;\n        width: 500px;\n      }\n    </style>\n\n    <div class="d-flex" id="DialogHeader${this.name}">\n      <div id="DialogTitle${this.name}">${this.title}</div>\n      <button class="btn btn--icon" id="BtnCloseDialog${this.name}">\n        X\n      </button>\n    </div>\n    <div class="DialogBody DialogBody${this.name}" id="DialogBody${this.name}">\n      ${this.content}\n    </div>\n  `,this.element=document.createElement("dialog"),this.element.className=`dialog Dialog${this.name}`,this.element.open=a,this.container.append(this.element),console.log(this.name),this.header=this.element.querySelector(`#DialogHeader${t}`),this.element.id=`Dialog${t}`,this.element.innerHTML=this._template,this.closeBtn=this.element.querySelector(`#BtnCloseDialog${t}`),this.closeBtn.addEventListener("click",(()=>{this.close()}))}drag(t){let e=0,i=0,s=0,a=0;s=t.clientX,a=t.clientY;const o=t=>{t.preventDefault(),e=s-t.clientX,i=a-t.clientY,s=t.clientX,a=t.clientY,this.element.style.top=this.element.offsetTop-i+"px",this.element.style.left=this.element.offsetLeft-e+"px"},n=()=>{document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",o)};document.addEventListener("mouseup",n),document.addEventListener("mousemove",o)}move(t,e){this.element.style.left=`${t}px`,this.element.style.top=`${e}px`}toggle(){this.element.hasAttribute("open")?this.close():this.open()}open(){this.element.setAttribute("open","")}close(){this.element.removeAttribute("open"),window.localStorage.setItem("startup","false")}}class h{constructor(t){this.title=t,this.id=Date.now().toString(),this.element=document.createElement("div"),this.tabTitle=document.createElement("span"),this.element.id=this.id,this.element.classList.add("tab"),this.closeBtn=document.createElement("button"),this.closeBtn.id=`#btnClose${this.id}`,this.closeBtn.textContent="X",this.tabTitle.textContent=t,this.element.append(this.tabTitle,this.closeBtn),document.querySelector("#tabs").appendChild(this.element),this.closeBtn.addEventListener("click",(()=>{this.close()}))}deactivateTab(){this.element.classList.remove("active")}activateTab(){this.element.classList.add("active")}rename(t){this.title=t,this.tabTitle.textContent=t}close(){this.element.removeAttribute("open")}}class r{constructor(t){this.app=t,this._container=document.createElement("div"),this.startupDialog=new l("Startup",this._container,"miniwizard",'\n  <div>\n    <b\n      >2023 Â©\n      <a target="_blank" href="https://famiclone.dev">famiclone.dev</a></b\n    >\n    <hr />\n    <br />\n    <div>\n      <b>Esc</b> - Command mode, <b>:new</b> - New file, <b>:h</b> - Open\n      help\n    </div>\n  </div>\n'),this.helpDialog=new l("Help",this._container,"Help","\n  <div>\n    <ul>\n      <li><b>Escape</b> - Open console</li>\n      <li><b>Cmd+</b> - Zoom in</li>\n      <li><b>Cmd-</b> - Zoom out</li>\n      <li><b>Cmd0</b> - Zoom reset</li>\n      <li><b>:?</b> - Open help</li>\n      <li><b>:p</b> - Open palette</li>\n      <li><b>:l</b> - Layers</li>\n      <li><b>:nl</b> - New layer</li>\n      <li><b>:log message</b> - Log message</li>\n      \x3c!-- <li><b>:b / g / e</b> - Change tool (pencil/ bucket / eraser)</li> --\x3e\n    </ul>\n  </div>\n"),this.zoomElement=document.querySelector("#zoom"),this.primaryColorElement=document.querySelector("#toolPrColor"),this.statusLine=document.querySelector("#statusLine"),this.layersDialog=new l("Layers",this._container,"Layers"),this.layersWrap=this.layersDialog.element.querySelector("#DialogBodyLayers"),this.paletteDialog=new l("Palette",this._container),this.paletteWrap=this.paletteDialog.element.querySelector("#DialogBodyPalette"),this.paletteTitle=this.paletteDialog.element.querySelector("#DialogTitlePalette"),this.tabs=document.querySelector("#tabs"),this.app=t,this.colorScheme=localStorage.getItem("colorscheme")||"dark",document.body.append(this._container),this.setColorScheme(this.colorScheme),window.localStorage.getItem("startup")&&"true"!==window.localStorage.getItem("startup")||this.startupDialog.open(),this.tabs.append(new h("Untitled").element),this.update()}renderPalette(){this.paletteWrap.innerHTML="";const t=document.createElement("div");t.className="palette-wrap",this.paletteTitle.textContent=this.app.palette.name,this.app.palette.colors.forEach(((e,i)=>{const s=document.createElement("div");s.classList.add("color-swatch"),s.style.backgroundColor=`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`,t.append(s),s.addEventListener("click",(()=>{this.app.primaryColor=e,this.update()}))})),this.paletteWrap.append(t)}renderLayers(){this.layersWrap.innerHTML="",this.app.currentFile?.data.forEach(((t,e)=>{const i=document.createElement("div");i.classList.add("layer"),e===this.app.layerIndex&&i.classList.add("active"),i.textContent=t.name,i.addEventListener("click",(()=>{this.app.layerIndex=e,this.update()})),this.layersWrap.append(i)}))}setColorScheme(t){localStorage.getItem("colorscheme")?(document.body.setAttribute("colorscheme",t),localStorage.setItem("colorscheme",t)):(document.body.setAttribute("colorscheme",t),this.colorScheme=t,localStorage.setItem("colorscheme",t))}log(t){this.to&&clearTimeout(this.to),this.statusLine.classList.add("open"),this.statusLine.textContent=t,this.to=setTimeout((()=>{this.statusLine.classList.remove("open"),this.statusLine.textContent=""}),2e3)}update(){this.renderPalette(),this.renderLayers(),this.zoomElement.textContent=100*this.app.zoom+"%",this.primaryColorElement.style.backgroundColor=`rgba(${this.app.primaryColor[0]}, ${this.app.primaryColor[1]}, ${this.app.primaryColor[2]}, ${this.app.primaryColor[3]})`}}const c=new class{constructor(){this.history=new a,this.zoom=25,this.tool="pencil",this.color=1,this.files=[],this.fileIndex=0,this.palette=e,this.primaryColor=this.palette.getColor(0),this.palettes=[this.palette],this.ui=new r(this),this.inputCommand=new o(this),this.layerIndex=0,this.files.push(new i(16,16)),this.renderer=new n(this),this.setup()}get currentFile(){return this.files[this.fileIndex]}setup(){document.addEventListener("keydown",(t=>{if(t.metaKey&&"="===t.key)return t.preventDefault(),void this.renderer.zoomIn();if(t.metaKey&&"-"===t.key)return t.preventDefault(),void this.renderer.zoomOut();if(t.metaKey&&"0"===t.key)return t.preventDefault(),void this.renderer.zoomReset();if(t.metaKey&&"z"===t.key)return t.preventDefault(),void this.undo();switch(t.key){case"Space":this.inputCommand.element.classList.contains("open")||(t.preventDefault(),this.renderer.canvas.style.cursor="grab",this.renderer.canvas.addEventListener("mousemove",(t=>{1===t.buttons&&(this.renderer.canvas.style.cursor="grabbing",this.renderer.canvas.style.left=`${t.movementX}px`,this.renderer.canvas.style.top=`${t.movementY}px`)})));break;case"?":t.preventDefault(),this.ui.helpDialog.toggle();break;case"Escape":t.preventDefault(),this.inputCommand.element.classList.contains("open")?this.inputCommand.close():this.inputCommand.open()}})),document.addEventListener("keyup",(t=>{if(" "===t.key)t.preventDefault(),this.renderer.canvas.style.cursor="default"})),this.update()}update(){this.renderer.update(),this.ui.update()}newFile(){console.log("new")}newLayer(){const e=new t("Layer "+(this.currentFile.data.length+1),!1,this.currentFile.width,this.currentFile.height);this.currentFile.data.push(e),this.layerIndex=this.currentFile.data.length-1,this.update()}saveFile(t,e={scale:1}){if("png"===t){const i=this.renderer.canvas.toDataURL("image/png"),s=document.createElement("canvas"),a=s.getContext("2d"),o=new Image;return o.src=i,o.onload=()=>{s.width=o.width*e.scale,s.height=o.height*e.scale,a.drawImage(o,0,0,s.width,s.height);const t=document.createElement("a");t.href=s.toDataURL("image/png"),t.download="image.png",t.click()},void this.ui.log(`save file as ${t}`)}this.ui.log(`filetype ${t} is not supported`)}undo(){this.history.undo()}redo(){this.history.redo()}changeTool(t){this.tool=t}};window.app=c})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJtYXBwaW5ncyI6Im1CQUFlLE1BQU1BLEVBQ2pCQyxZQUFZQyxFQUFPLFlBQWFDLEdBQVMsRUFBT0MsRUFBUSxHQUFJQyxFQUFTLElBQ2pFQyxLQUFLSixLQUFPQSxFQUNaSSxLQUFLSCxPQUFTQSxFQUNkRyxLQUFLRixNQUFRQSxFQUNiRSxLQUFLRCxPQUFTQSxFQUNkQyxLQUFLQyxRQUFVLElBQ2ZELEtBQUtFLFNBQVUsRUFDZkYsS0FBS0csS0FBTyxJQUFJQyxVQUFVTixFQUFPQyxFQUNyQyxFQ1NHLE1BQU1NLEVBQWlCLElBbEJmLE1BQ1hWLFlBQVlDLEVBQU8sZUFDZkksS0FBS0osS0FBT0EsRUFDWkksS0FBS00sT0FBUyxDQUFDLEdBQ25CLENBQ0FDLFNBQVNDLEdBQ0xSLEtBQUtNLE9BQU9HLEtBQUtELEVBQ3JCLENBQ0FFLFlBQVlDLEdBQ1JYLEtBQUtNLE9BQU9NLE9BQU9ELEVBQU8sRUFDOUIsQ0FDQUUsU0FBU0YsRUFBT0gsR0FDWlIsS0FBS00sT0FBT0ssR0FBU0gsQ0FDekIsQ0FDQU0sU0FBU0gsR0FDTCxPQUFPWCxLQUFLTSxPQUFPSyxFQUN2QixHQUVzQyxXQUUxQ04sRUFBZUMsT0FBUyxDQUNwQixDQUFDLEVBQUcsRUFBRyxFQUFHLEtBQ1YsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsR0FBSSxJQUFLLElBQUssS0FDZixDQUFDLEVBQUcsSUFBSyxJQUFLLEtBQ2QsQ0FBQyxFQUFHLEVBQUcsSUFBSyxLQUNaLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLEVBQUcsR0FBSSxJQUFLLEtBQ2IsQ0FBQyxFQUFHLEVBQUcsSUFBSyxLQUNaLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssR0FBSSxJQUFLLEtBQ2YsQ0FBQyxHQUFJLEdBQUksSUFBSyxLQUNkLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssRUFBRyxJQUFLLEtBQ2QsQ0FBQyxJQUFLLEVBQUcsSUFBSyxLQUNkLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLEdBQUksSUFBSyxLQUNmLENBQUMsSUFBSyxFQUFHLEdBQUksS0FDYixDQUFDLElBQUssRUFBRyxHQUFJLEtBQ2IsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxHQUFJLEtBQ2YsQ0FBQyxJQUFLLEdBQUksRUFBRyxLQUNiLENBQUMsSUFBSyxHQUFJLEVBQUcsS0FDYixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLEdBQUksS0FDZixDQUFDLElBQUssR0FBSSxHQUFJLEtBQ2QsQ0FBQyxJQUFLLEdBQUksRUFBRyxLQUNiLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssRUFBRyxLQUNkLENBQUMsSUFBSyxJQUFLLEVBQUcsS0FDZCxDQUFDLEdBQUksR0FBSSxFQUFHLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxHQUFJLEtBQ2YsQ0FBQyxFQUFHLElBQUssRUFBRyxLQUNaLENBQUMsRUFBRyxJQUFLLEVBQUcsS0FDWixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsR0FBSSxJQUFLLEdBQUksS0FDZCxDQUFDLEVBQUcsSUFBSyxFQUFHLEtBQ1osQ0FBQyxFQUFHLElBQUssRUFBRyxLQUNaLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxHQUFJLElBQUssSUFBSyxLQUNmLENBQUMsRUFBRyxJQUFLLEdBQUksS0FDYixDQUFDLEVBQUcsR0FBSSxFQUFHLEtBQ1gsQ0FBQyxFQUFH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LEVBQU0rSixFQUFVLENBQUU5SixNQUFPLElBQzlCLEdBQWEsUUFBVEQsRUFBZ0IsQ0FDaEIsTUFBTWdLLEVBQVVqTixLQUFLeU0sU0FBUzFHLE9BQU9tSCxVQUFVLGFBQ3pDQyxFQUFJakosU0FBU0MsY0FBYyxVQUMzQjRDLEVBQU1vRyxFQUFFbkgsV0FBVyxNQUNuQm9ILEVBQU0sSUFBSUMsTUFZaEIsT0FYQUQsRUFBSUUsSUFBTUwsRUFDVkcsRUFBSUcsT0FBUyxLQUNUSixFQUFFck4sTUFBUXNOLEVBQUl0TixNQUFRa04sRUFBUTlKLE1BQzlCaUssRUFBRXBOLE9BQVNxTixFQUFJck4sT0FBU2lOLEVBQVE5SixNQUNoQzZELEVBQUl5RyxVQUFVSixFQUFLLEVBQUcsRUFBR0QsRUFBRXJOLE1BQU9xTixFQUFFcE4sUUFDcEMsTUFBTTBOLEVBQUl2SixTQUFTQyxjQUFjLEtBQ2pDc0osRUFBRUMsS0FBT1AsRUFBRUQsVUFBVSxhQUNyQk8sRUFBRUUsU0FBVyxZQUNiRixFQUFFRyxPQUFPLE9BRWI1TixLQUFLNEMsR0FBR1csSUFBSSxnQkFBZ0JOLElBRWhDLENBQ0FqRCxLQUFLNEMsR0FBR1csSUFBSSxZQUFZTixxQkFDNUIsQ0FDQWpCLE9BQ0loQyxLQUFLaUgsUUFBUWpGLE1BQ2pCLENBQ0FFLE9BQ0lsQyxLQUFLaUgsUUFBUS9FLE1BQ2pCLENBQ0EyTCxXQUFXdkIsR0FDUHRNLEtBQUtzTSxLQUFPQSxDQUNoQixHRHBJSjdCLE9BQU9wSSxJQUFNQSxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9sYXllci50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL3BhbGV0dGUudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9maWxlLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvaGlzdG9yeS50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL2lucHV0LWNvbW1hbmQudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9yZW5kZXJlci50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL3VpL2RpYWxvZy50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL3VpLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGF5ZXIge1xuICAgIGNvbnN0cnVjdG9yKG5hbWUgPSBcIk5ldyBMYXllclwiLCBsb2NrZWQgPSBmYWxzZSwgd2lkdGggPSAxNiwgaGVpZ2h0ID0gMTYpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5sb2NrZWQgPSBsb2NrZWQ7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMub3BhY2l0eSA9IDI1NTtcbiAgICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5kYXRhID0gbmV3IEltYWdlRGF0YSh3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQYWxldHRlIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lID0gXCJOZXcgcGFsZXR0ZVwiKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuY29sb3JzID0gW1tdXTtcbiAgICB9XG4gICAgYWRkQ29sb3IoY29sb3IpIHtcbiAgICAgICAgdGhpcy5jb2xvcnMucHVzaChjb2xvcik7XG4gICAgfVxuICAgIHJlbW92ZUNvbG9yKGluZGV4KSB7XG4gICAgICAgIHRoaXMuY29sb3JzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICAgIHNldENvbG9yKGluZGV4LCBjb2xvcikge1xuICAgICAgICB0aGlzLmNvbG9yc1tpbmRleF0gPSBjb2xvcjtcbiAgICB9XG4gICAgZ2V0Q29sb3IoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sb3JzW2luZGV4XTtcbiAgICB9XG59XG5leHBvcnQgY29uc3QgZGVmYXVsdFBhbGV0dGUgPSBuZXcgUGFsZXR0ZShcIkRlZmF1bHRcIik7XG4vLyBORVMgcGFsZXR0ZVxuZGVmYXVsdFBhbGV0dGUuY29sb3JzID0gW1xuICAgIFswLCAwLCAwLCAyNTVdLFxuICAgIFsyNTIsIDI1MiwgMjUyLCAyNTVdLFxuICAgIFsyNDgsIDI0OCwgMjQ4LCAyNTVdLFxuICAgIFsxODgsIDE4OCwgMTg4LCAyNTVdLFxuICAgIFsxMjQsIDEyNCwgMTI0LCAyNTVdLFxuICAgIFsxNjQsIDIyOCwgMjUyLCAyNTVdLFxuICAgIFs2MCwgMTg4LCAyNTIsIDI1NV0sXG4gICAgWzAsIDEyMCwgMjQ4LCAyNTVdLFxuICAgIFswLCAwLCAyNTIsIDI1NV0sXG4gICAgWzE4NCwgMTg0LCAyNDgsIDI1NV0sXG4gICAgWzEwNCwgMTM2LCAyNTIsIDI1NV0sXG4gICAgWzAsIDg4LCAyNDgsIDI1NV0sXG4gICAgWzAsIDAsIDE4OCwgMjU1XSxcbiAgICBbMjE2LCAxODQsIDI0OCwgMjU1XSxcbiAgICBbMTUyLCAxMjAsIDI0OCwgMjU1XSxcbiAgICBbMTA0LCA2OCwgMjUyLCAyNTVdLFxuICAgIFs2OCwgNDAsIDE4OCwgMjU1XSxcbiAgICBbMjQ4LCAxODQsIDI0OCwgMjU1XSxcbiAgICBbMjQ4LCAxMjAsIDI0OCwgMjU1XSxcbiAgICBbMjE2LCAwLCAyMDQsIDI1NV0sXG4gICAgWzE0OCwgMCwgMTMyLCAyNTVdLFxuICAgIFsyNDgsIDE2NCwgMTkyLCAyNTVdLFxuICAgIFsyNDgsIDg4LCAxNTIsIDI1NV0sXG4gICAgWzIyOCwgMCwgODgsIDI1NV0sXG4gICAgWzE2OCwgMCwgMzIsIDI1NV0sXG4gICAgWzI0MCwgMjA4LCAxNzYsIDI1NV0sXG4gICAgWzI0OCwgMTIwLCA4OCwgMjU1XSxcbiAgICBbMjQ4LCA1NiwgMCwgMjU1XSxcbiAgICBbMTY4LCAxNiwgMCwgMjU1XSxcbiAgICBbMjUyLCAyMjQsIDE2OCwgMjU1XSxcbiAgICBbMjUyLCAxNjAsIDY4LCAyNTVdLFxuICAgIFsyMjgsIDkyLCAxNiwgMjU1XSxcbiAgICBbMTM2LCAyMCwgMCwgMjU1XSxcbiAgICBbMjQ4LCAyMTYsIDEyMCwgMjU1XSxcbiAgICBbMjQ4LCAxODQsIDAsIDI1NV0sXG4gICAgWzE3MiwgMTI0LCAwLCAyNTVdLFxuICAgIFs4MCwgNDAsIDAsIDI1NV0sXG4gICAgWzIxNiwgMjQ4LCAxMjAsIDI1NV0sXG4gICAgWzE4NCwgMjQ4LCAyNCwgMjU1XSxcbiAgICBbMCwgMTg0LCAwLCAyNTVdLFxuICAgIFswLCAxMjAsIDAsIDI1NV0sXG4gICAgWzE4NCwgMjQ4LCAxODQsIDI1NV0sXG4gICAgWzg4LCAyMTYsIDg0LCAyNTVdLFxuICAgIFswLCAxNjgsIDAsIDI1NV0sXG4gICAgWzAsIDEwNCwgMCwgMjU1XSxcbiAgICBbMTg0LCAyNDgsIDIxNiwgMjU1XSxcbiAgICBbODgsIDI0OCwgMTUyLCAyNTVdLFxuICAgIFswLCAxNjgsIDY4LCAyNTVdLFxuICAgIFswLCA4OCwgMCwgMjU1XSxcbiAgICBbMCwgMjUyLCAyNTIsIDI1NV0sXG4gICAgWzAsIDIzMiwgMjE2LCAyNTVdLFxuICAgIFswLCAxMzYsIDEzNiwgMjU1XSxcbiAgICBbMCwgNjQsIDg4LCAyNTVdLFxuICAgIFsyNDgsIDIxNiwgMjQ4LCAyNTVdLFxuICAgIFsxMjAsIDEyMCwgMTIwLCAyNTVdLFxuXTtcbiIsImltcG9ydCBMYXllciBmcm9tIFwiLi9sYXllclwiO1xuaW1wb3J0IHsgZGVmYXVsdFBhbGV0dGUgfSBmcm9tIFwiLi9wYWxldHRlXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBXaXpGaWxlIHtcbiAgICBjb25zdHJ1Y3Rvcih3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLnBhbGV0dGUgPSBkZWZhdWx0UGFsZXR0ZTtcbiAgICAgICAgdGhpcy5kYXRhID0gW25ldyBMYXllcihcIkJhY2tncm91bmRcIiwgdHJ1ZSwgd2lkdGgsIGhlaWdodCldO1xuICAgIH1cbiAgICBzZXRDYW52YXNTaXplKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgdGhpcy5kYXRhLmZvckVhY2goKGxheWVyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gbGF5ZXIuZGF0YTtcbiAgICAgICAgICAgIGxheWVyLmRhdGEgPSBuZXcgSW1hZ2VEYXRhKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgbGF5ZXIuZGF0YS5kYXRhLnNldChkYXRhLmRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJjbGFzcyBIaXN0b3J5Tm9kZSB7XG4gICAgY29uc3RydWN0b3IoZGF0YSkge1xuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICB0aGlzLnRpbWVzdGFtcCA9IERhdGUubm93KCk7XG4gICAgfVxufVxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGlzdG9yeSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMubWF4ID0gNTtcbiAgICAgICAgdGhpcy5zdGFjayA9IFtdO1xuICAgICAgICB0aGlzLmJ1ZmZlciA9IG51bGw7XG4gICAgfVxuICAgIGFkZChkYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA+PSB0aGlzLm1heCkge1xuICAgICAgICAgICAgdGhpcy5zdGFjay5zaGlmdCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhY2sucHVzaChuZXcgSGlzdG9yeU5vZGUoZGF0YSkpO1xuICAgIH1cbiAgICB1bmRvKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmJ1ZmZlciA9IHRoaXMuc3RhY2sucG9wKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIuZGF0YTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmVkbygpIHtcbiAgICAgICAgaWYgKHRoaXMuYnVmZmVyKSB7XG4gICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2godGhpcy5idWZmZXIpO1xuICAgICAgICAgICAgdGhpcy5idWZmZXIgPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhY2tbdGhpcy5zdGFjay5sZW5ndGggLSAxXS5kYXRhO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjbGVhcigpIHtcbiAgICAgICAgdGhpcy5zdGFjayA9IFtdO1xuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIElucHV0Q29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHRoaXMuY29tbWFuZHMgPSB7XG4gICAgICAgICAgICBuOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAubmV3RmlsZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG5sOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAubmV3TGF5ZXIoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkubGF5ZXJzRGlhbG9nLnRvZ2dsZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGU6ICgpID0+IHsgfSxcbiAgICAgICAgICAgIHc6ICh0eXBlLCBzY2FsZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNhdmVGaWxlKHR5cGUsIHsgc2NhbGU6IHBhcnNlSW50KHNjYWxlKSB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkuaGVscERpYWxvZy50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC51aS5sb2coXCJIZWxwXCIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHA6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC51aS5wYWxldHRlRGlhbG9nLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnVpLmxvZyhcIk9wZW4gcGFsZXR0ZVwiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBQOiAoKSA9PiB7IH0sXG4gICAgICAgICAgICBsb2c6IChtc2cpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC51aS5sb2cobXNnKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoczogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnVpLnN0YXJ0dXBEaWFsb2cudG9nZ2xlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3M6ICh0aGVtZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnVpLnNldENvbG9yU2NoZW1lKHRoZW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gXCJJbnB1dENvbW1hbmRcIjtcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTmFtZSA9IFwiaW5wdXQgaW5wdXQtLWNtZFwiO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmFwcC51aSk7XG4gICAgICAgIHRoaXMuYXBwLnVpLl9jb250YWluZXIuYXBwZW5kKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09PSBcIkVudGVyXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGUodGhpcy5lbGVtZW50LnZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5mb2N1cygpO1xuICAgICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSBcIjpcIjtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gXCJcIjtcbiAgICB9XG4gICAgZXhlY3V0ZShjbWQpIHtcbiAgICAgICAgY21kID0gY21kLnNsaWNlKDEpO1xuICAgICAgICBjb25zdCBbY29tbWFuZCwgLi4uYXJnc10gPSBjbWQuc3BsaXQoXCIgXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhjb21tYW5kLCBhcmdzKTtcbiAgICAgICAgaWYgKGNvbW1hbmQgaW4gdGhpcy5jb21tYW5kcykge1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kc1tjb21tYW5kXSguLi5hcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXBwLnVpLmxvZyhgY29tbWFuZCBub3QgZm91bmQ6ICR7Y29tbWFuZH1gKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyIHtcbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuem9vbSA9IDI1O1xuICAgICAgICB0aGlzLmZpbGUgPSB0aGlzLmFwcC5jdXJyZW50RmlsZTtcbiAgICAgICAgdGhpcy5ncmlkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5ncmlkU2l6ZSA9IDE2O1xuICAgICAgICB0aGlzLl9jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgICAgICB0aGlzLl9jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLmFwcC5maWxlc1t0aGlzLmFwcC5maWxlSW5kZXhdLndpZHRoO1xuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLmFwcC5maWxlc1t0aGlzLmFwcC5maWxlSW5kZXhdLmhlaWdodDtcbiAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybChcImRhdGE6aW1hZ2Uvc3ZnK3htbDt1dGY4LDxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nMTYnIGhlaWdodD0nMTYnIHZpZXdCb3g9JzAgMCAxNiAxNic+PHJlY3Qgd2lkdGg9JzE2JyBoZWlnaHQ9JzE2JyBmaWxsPSdub25lJy8+PHJlY3QgeD0nMCcgeT0nMCcgd2lkdGg9JzgnIGhlaWdodD0nOCcgZmlsbD0nJTIzZjBmMGYwJy8+PHJlY3QgeD0nOCcgeT0nOCcgd2lkdGg9JzgnIGhlaWdodD0nOCcgZmlsbD0nJTIzZjBmMGYwJy8+PC9zdmc+XCIpYDtcbiAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuYmFja2dyb3VuZFNpemUgPSBcIjE2cHggMTZweFwiO1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5pbWFnZVJlbmRlcmluZyA9IFwicGl4ZWxhdGVkXCI7XG4gICAgICAgIHRoaXMuc2V0Wm9vbSh0aGlzLnpvb20pO1xuICAgICAgICAvLyBhYmlsaXR5IHRvIHpvb20gaW4gYW5kIG91dCB3aXRoIG1vdXNlIHdoZWVsXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy56b29tQ2hhbmdlKGUuZGVsdGFZKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcihcIiNtYWluXCIpLmFwcGVuZCh0aGlzLmNhbnZhcyk7XG4gICAgICAgIGNvbnN0IGltYWdlRGF0YSA9IHRoaXMuY3R4LmNyZWF0ZUltYWdlRGF0YSh0aGlzLmZpbGUud2lkdGgsIHRoaXMuZmlsZS5oZWlnaHQpO1xuICAgICAgICAvLyBhYmlsaXR5IHRvIGRyYXcgcGl4ZWwgd2l0aCBtb3VzZSBjbGlja1xuICAgICAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuYXBwLmhpc3RvcnkuYWRkKHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmZpbGUud2lkdGgsIHRoaXMuZmlsZS5oZWlnaHQpKTtcbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHggPSBNYXRoLmZsb29yKChlLmNsaWVudFggLSByZWN0LmxlZnQpIC8gdGhpcy56b29tKTtcbiAgICAgICAgICAgIGNvbnN0IHkgPSBNYXRoLmZsb29yKChlLmNsaWVudFkgLSByZWN0LnRvcCkgLyB0aGlzLnpvb20pO1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSAoeSAqIHRoaXMuZmlsZS53aWR0aCArIHgpICogNDtcbiAgICAgICAgICAgIC8vdGhpcy5maWxlc1t0aGlzLmZpbGVJbmRleF0uZGF0YVt0aGlzLmxheWVySW5kZXhdLmRhdGFbeV1beF0gPSB0aGlzLmNvbG9yO1xuICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXhdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzBdO1xuICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAxXSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclsxXTtcbiAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgMl0gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMl07XG4gICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDNdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzNdO1xuICAgICAgICAgICAgdGhpcy5jdHgucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG4gICAgICAgICAgICB0aGlzLmFwcC5oaXN0b3J5LmFkZCh0aGlzLmN0eC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5maWxlLndpZHRoLCB0aGlzLmZpbGUuaGVpZ2h0KSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBhYmlsaXR5IHRvIGRyYXcgcGl4ZWwgd2l0aCBtb3VzZSBtb3ZlXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmJ1dHRvbnMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5oaXN0b3J5LmFkZCh0aGlzLmN0eC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5maWxlLndpZHRoLCB0aGlzLmZpbGUuaGVpZ2h0KSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHggPSBNYXRoLmZsb29yKChlLmNsaWVudFggLSByZWN0LmxlZnQpIC8gdGhpcy56b29tKTtcbiAgICAgICAgICAgICAgICBjb25zdCB5ID0gTWF0aC5mbG9vcigoZS5jbGllbnRZIC0gcmVjdC50b3ApIC8gdGhpcy56b29tKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9ICh5ICogdGhpcy5maWxlLndpZHRoICsgeCkgKiA0O1xuICAgICAgICAgICAgICAgIC8vdGhpcy5maWxlc1t0aGlzLmZpbGVJbmRleF0uZGF0YVt0aGlzLmxheWVySW5kZXhdLmRhdGFbeV1beF0gPVxuICAgICAgICAgICAgICAgIC8vIHRoaXMuY29sb3I7XG4gICAgICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXhdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzBdO1xuICAgICAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgMV0gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMV07XG4gICAgICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAyXSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclsyXTtcbiAgICAgICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDNdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzNdO1xuICAgICAgICAgICAgICAgIHRoaXMuY3R4LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLmhpc3RvcnkuYWRkKHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmZpbGUud2lkdGgsIHRoaXMuZmlsZS5oZWlnaHQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldCBjYW52YXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW52YXM7XG4gICAgfVxuICAgIGdldCBjdHgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jdHg7XG4gICAgfVxuICAgIGRyYXdSZWN0KHgsIHksIHcsIGgsIGNvbG9yKSB7XG4gICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IGNvbG9yO1xuICAgICAgICB0aGlzLmN0eC5maWxsUmVjdCh4LCB5LCB3LCBoKTtcbiAgICB9XG4gICAgZmlsbChzdGFydFgsIHN0YXJ0WSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcikge1xuICAgICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmZpbGUuZGF0YVt0aGlzLmFwcC5sYXllckluZGV4XS5kYXRhO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgc3RhcnQgY29vcmRpbmF0ZXMgYXJlIG91dCBvZiBib3VuZHNcbiAgICAgICAgaWYgKHN0YXJ0WCA8IDAgfHxcbiAgICAgICAgICAgIHN0YXJ0WCA+PSBtYXRyaXgud2lkdGggfHxcbiAgICAgICAgICAgIHN0YXJ0WSA8IDAgfHxcbiAgICAgICAgICAgIHN0YXJ0WSA+PSBtYXRyaXguaGVpZ2h0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5kZXggPSBzdGFydFkgKiBtYXRyaXgud2lkdGggKyBzdGFydFg7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSB0YXJnZXQgdmFsdWUgbWF0Y2hlcyB0aGUgcmVwbGFjZW1lbnQgdmFsdWVcbiAgICAgICAgaWYgKG1hdHJpeC5kYXRhW2luZGV4XSA9PT0gcmVwbGFjZUNvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdmFsdWUgbWF0Y2hlcyB0aGUgdGFyZ2V0IHZhbHVlXG4gICAgICAgIGlmIChtYXRyaXguZGF0YVtpbmRleF0gIT09IHRhcmdldENvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVwbGFjZSB0aGUgY3VycmVudCB2YWx1ZSB3aXRoIHRoZSByZXBsYWNlbWVudCB2YWx1ZVxuICAgICAgICBtYXRyaXguZGF0YVtpbmRleF0gPSByZXBsYWNlQ29sb3I7XG4gICAgICAgIC8vIFJlY3Vyc2l2ZWx5IGZpbGwgYWRqYWNlbnQgY2VsbHNcbiAgICAgICAgdGhpcy5maWxsKHN0YXJ0WCArIDEsIHN0YXJ0WSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcik7IC8vIFJpZ2h0XG4gICAgICAgIHRoaXMuZmlsbChzdGFydFggLSAxLCBzdGFydFksIHRhcmdldENvbG9yLCByZXBsYWNlQ29sb3IpOyAvLyBMZWZ0XG4gICAgICAgIHRoaXMuZmlsbChzdGFydFgsIHN0YXJ0WSArIDEsIHRhcmdldENvbG9yLCByZXBsYWNlQ29sb3IpOyAvLyBEb3duXG4gICAgICAgIHRoaXMuZmlsbChzdGFydFgsIHN0YXJ0WSAtIDEsIHRhcmdldENvbG9yLCByZXBsYWNlQ29sb3IpOyAvLyBVcFxuICAgIH1cbiAgICBzZXRab29tKHpvb20pIHtcbiAgICAgICAgdGhpcy56b29tID0gem9vbTtcbiAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUud2lkdGggPSBgJHt0aGlzLmZpbGUud2lkdGggKiB0aGlzLnpvb219cHhgO1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmZpbGUuaGVpZ2h0ICogdGhpcy56b29tfXB4YDtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9XG4gICAgem9vbUNoYW5nZShkdCA9IDApIHtcbiAgICAgICAgY29uc3QgZGVsdGEgPSBNYXRoLnNpZ24oZHQpO1xuICAgICAgICB0aGlzLnpvb20gKz0gZGVsdGEgKiA4O1xuICAgICAgICB0aGlzLnNldFpvb20odGhpcy56b29tKTtcbiAgICB9XG4gICAgem9vbUluKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcInpvb20gaW5cIik7XG4gICAgICAgIGlmICh0aGlzLnpvb20gPCAxMjgpIHtcbiAgICAgICAgICAgIHRoaXMuem9vbUNoYW5nZSgxKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB6b29tT3V0KCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcInpvb20gb3V0XCIpO1xuICAgICAgICBpZiAodGhpcy56b29tID4gMSkge1xuICAgICAgICAgICAgdGhpcy56b29tQ2hhbmdlKC0xKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB6b29tUmVzZXQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiem9vbSByZXNldFwiKTtcbiAgICAgICAgdGhpcy5zZXRab29tKDI1KTtcbiAgICB9XG4gICAgdXBkYXRlKCkge1xuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy51cGRhdGUuYmluZCh0aGlzKSk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlhbG9nRWxlbWVudCB7XG4gICAgY29uc3RydWN0b3IobmFtZSwgY29udGFpbmVyLCB0aXRsZSA9IFwiRGlhbG9nXCIsIGNvbnRlbnQgPSBcIlwiLCBvcGVuID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgdGhpcy5jb250ZW50ID0gY29udGVudDtcbiAgICAgICAgdGhpcy5fdGVtcGxhdGUgPSBgXG4gICAgPHN0eWxlPlxuICAgICAgLmRpYWxvZyB7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJnLWNvbG9yKTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMC41cmVtO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1taWQtY29sb3IpO1xuICAgICAgICBjb2xvcjogdmFyKC0tZmctY29sb3IpO1xuICAgICAgICBtaW4td2lkdGg6IDMyMHB4O1xuICAgICAgICB3aWR0aDogNTAwcHg7XG4gICAgICB9XG4gICAgPC9zdHlsZT5cblxuICAgIDxkaXYgY2xhc3M9XCJkLWZsZXhcIiBpZD1cIkRpYWxvZ0hlYWRlciR7dGhpcy5uYW1lfVwiPlxuICAgICAgPGRpdiBpZD1cIkRpYWxvZ1RpdGxlJHt0aGlzLm5hbWV9XCI+JHt0aGlzLnRpdGxlfTwvZGl2PlxuICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tLWljb25cIiBpZD1cIkJ0bkNsb3NlRGlhbG9nJHt0aGlzLm5hbWV9XCI+XG4gICAgICAgIFhcbiAgICAgIDwvYnV0dG9uPlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJEaWFsb2dCb2R5IERpYWxvZ0JvZHkke3RoaXMubmFtZX1cIiBpZD1cIkRpYWxvZ0JvZHkke3RoaXMubmFtZX1cIj5cbiAgICAgICR7dGhpcy5jb250ZW50fVxuICAgIDwvZGl2PlxuICBgO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGlhbG9nXCIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NOYW1lID0gYGRpYWxvZyBEaWFsb2cke3RoaXMubmFtZX1gO1xuICAgICAgICB0aGlzLmVsZW1lbnQub3BlbiA9IG9wZW47XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLm5hbWUpO1xuICAgICAgICB0aGlzLmhlYWRlciA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjRGlhbG9nSGVhZGVyJHtuYW1lfWApO1xuICAgICAgICB0aGlzLmVsZW1lbnQuaWQgPSBgRGlhbG9nJHtuYW1lfWA7XG4gICAgICAgIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLl90ZW1wbGF0ZTtcbiAgICAgICAgdGhpcy5jbG9zZUJ0biA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjQnRuQ2xvc2VEaWFsb2cke25hbWV9YCk7XG4gICAgICAgIHRoaXMuY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRyYWcoZSkge1xuICAgICAgICBsZXQgcG9zMSA9IDAsIHBvczIgPSAwLCBwb3MzID0gMCwgcG9zNCA9IDA7XG4gICAgICAgIHBvczMgPSBlLmNsaWVudFg7XG4gICAgICAgIHBvczQgPSBlLmNsaWVudFk7XG4gICAgICAgIGNvbnN0IGVsZW1lbnREcmFnID0gKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHBvczEgPSBwb3MzIC0gZS5jbGllbnRYO1xuICAgICAgICAgICAgcG9zMiA9IHBvczQgLSBlLmNsaWVudFk7XG4gICAgICAgICAgICBwb3MzID0gZS5jbGllbnRYO1xuICAgICAgICAgICAgcG9zNCA9IGUuY2xpZW50WTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSB0aGlzLmVsZW1lbnQub2Zmc2V0VG9wIC0gcG9zMiArIFwicHhcIjtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gdGhpcy5lbGVtZW50Lm9mZnNldExlZnQgLSBwb3MxICsgXCJweFwiO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBjbG9zZURyYWdFbGVtZW50ID0gKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgY2xvc2VEcmFnRWxlbWVudCk7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGVsZW1lbnREcmFnKTtcbiAgICAgICAgfTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgY2xvc2VEcmFnRWxlbWVudCk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZWxlbWVudERyYWcpO1xuICAgIH1cbiAgICBtb3ZlKHgsIHkpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBgJHt4fXB4YDtcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IGAke3l9cHhgO1xuICAgIH1cbiAgICB0b2dnbGUoKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQuaGFzQXR0cmlidXRlKFwib3BlblwiKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vcGVuKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcIm9wZW5cIiwgXCJcIik7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwib3BlblwiKTtcbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwic3RhcnR1cFwiLCBcImZhbHNlXCIpO1xuICAgIH1cbn1cbiIsImltcG9ydCBEaWFsb2dFbGVtZW50IGZyb20gXCIuL3VpL2RpYWxvZ1wiO1xuY29uc3Qgc3RhcnR1cENvbnRlbnQgPSBgXG4gIDxkaXY+XG4gICAgPGJcbiAgICAgID4yMDIzIMKpXG4gICAgICA8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiaHR0cHM6Ly9mYW1pY2xvbmUuZGV2XCI+ZmFtaWNsb25lLmRldjwvYT48L2JcbiAgICA+XG4gICAgPGhyIC8+XG4gICAgPGJyIC8+XG4gICAgPGRpdj5cbiAgICAgIDxiPkVzYzwvYj4gLSBDb21tYW5kIG1vZGUsIDxiPjpuZXc8L2I+IC0gTmV3IGZpbGUsIDxiPjpoPC9iPiAtIE9wZW5cbiAgICAgIGhlbHBcbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG5gO1xuY29uc3QgaGVscENvbnRlbnQgPSBgXG4gIDxkaXY+XG4gICAgPHVsPlxuICAgICAgPGxpPjxiPkVzY2FwZTwvYj4gLSBPcGVuIGNvbnNvbGU8L2xpPlxuICAgICAgPGxpPjxiPkNtZCs8L2I+IC0gWm9vbSBpbjwvbGk+XG4gICAgICA8bGk+PGI+Q21kLTwvYj4gLSBab29tIG91dDwvbGk+XG4gICAgICA8bGk+PGI+Q21kMDwvYj4gLSBab29tIHJlc2V0PC9saT5cbiAgICAgIDxsaT48Yj46PzwvYj4gLSBPcGVuIGhlbHA8L2xpPlxuICAgICAgPGxpPjxiPjpwPC9iPiAtIE9wZW4gcGFsZXR0ZTwvbGk+XG4gICAgICA8bGk+PGI+Omw8L2I+IC0gTGF5ZXJzPC9saT5cbiAgICAgIDxsaT48Yj46bmw8L2I+IC0gTmV3IGxheWVyPC9saT5cbiAgICAgIDxsaT48Yj46bG9nIG1lc3NhZ2U8L2I+IC0gTG9nIG1lc3NhZ2U8L2xpPlxuICAgICAgPCEtLSA8bGk+PGI+OmIgLyBnIC8gZTwvYj4gLSBDaGFuZ2UgdG9vbCAocGVuY2lsLyBidWNrZXQgLyBlcmFzZXIpPC9saT4gLS0+XG4gICAgPC91bD5cbiAgPC9kaXY+XG5gO1xuY2xhc3MgVGFiIHtcbiAgICBjb25zdHJ1Y3Rvcih0aXRsZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMuaWQgPSBEYXRlLm5vdygpLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRoaXMudGFiVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gdGhpcy5pZDtcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJcIik7XG4gICAgICAgIHRoaXMuY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICB0aGlzLmNsb3NlQnRuLmlkID0gYCNidG5DbG9zZSR7dGhpcy5pZH1gO1xuICAgICAgICB0aGlzLmNsb3NlQnRuLnRleHRDb250ZW50ID0gXCJYXCI7XG4gICAgICAgIHRoaXMudGFiVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZCh0aGlzLnRhYlRpdGxlLCB0aGlzLmNsb3NlQnRuKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0YWJzXCIpLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHRoaXMuY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRlYWN0aXZhdGVUYWIoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgIH1cbiAgICBhY3RpdmF0ZVRhYigpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgfVxuICAgIHJlbmFtZSh0aXRsZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMudGFiVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJvcGVuXCIpO1xuICAgIH1cbn1cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVJIHtcbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRoaXMuc3RhcnR1cERpYWxvZyA9IG5ldyBEaWFsb2dFbGVtZW50KFwiU3RhcnR1cFwiLCB0aGlzLl9jb250YWluZXIsIFwibWluaXdpemFyZFwiLCBzdGFydHVwQ29udGVudCk7XG4gICAgICAgIHRoaXMuaGVscERpYWxvZyA9IG5ldyBEaWFsb2dFbGVtZW50KFwiSGVscFwiLCB0aGlzLl9jb250YWluZXIsIFwiSGVscFwiLCBoZWxwQ29udGVudCk7XG4gICAgICAgIHRoaXMuem9vbUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3pvb21cIik7XG4gICAgICAgIHRoaXMucHJpbWFyeUNvbG9yRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9vbFByQ29sb3JcIik7XG4gICAgICAgIHRoaXMuc3RhdHVzTGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc3RhdHVzTGluZVwiKTtcbiAgICAgICAgdGhpcy5sYXllcnNEaWFsb2cgPSBuZXcgRGlhbG9nRWxlbWVudChcIkxheWVyc1wiLCB0aGlzLl9jb250YWluZXIsIFwiTGF5ZXJzXCIpO1xuICAgICAgICB0aGlzLmxheWVyc1dyYXAgPSB0aGlzLmxheWVyc0RpYWxvZy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjRGlhbG9nQm9keUxheWVyc1wiKTtcbiAgICAgICAgdGhpcy5wYWxldHRlRGlhbG9nID0gbmV3IERpYWxvZ0VsZW1lbnQoXCJQYWxldHRlXCIsIHRoaXMuX2NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMucGFsZXR0ZVdyYXAgPSB0aGlzLnBhbGV0dGVEaWFsb2cuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI0RpYWxvZ0JvZHlQYWxldHRlXCIpO1xuICAgICAgICB0aGlzLnBhbGV0dGVUaXRsZSA9IHRoaXMucGFsZXR0ZURpYWxvZy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjRGlhbG9nVGl0bGVQYWxldHRlXCIpO1xuICAgICAgICB0aGlzLnRhYnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RhYnNcIik7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmNvbG9yU2NoZW1lID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjb2xvcnNjaGVtZVwiKSB8fCBcImRhcmtcIjtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmQodGhpcy5fY29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5zZXRDb2xvclNjaGVtZSh0aGlzLmNvbG9yU2NoZW1lKTtcbiAgICAgICAgaWYgKCF3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJzdGFydHVwXCIpIHx8XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJzdGFydHVwXCIpID09PSBcInRydWVcIikge1xuICAgICAgICAgICAgdGhpcy5zdGFydHVwRGlhbG9nLm9wZW4oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRhYnMuYXBwZW5kKG5ldyBUYWIoXCJVbnRpdGxlZFwiKS5lbGVtZW50KTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9XG4gICAgcmVuZGVyUGFsZXR0ZSgpIHtcbiAgICAgICAgdGhpcy5wYWxldHRlV3JhcC5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICBjb25zdCB3cmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgd3JhcC5jbGFzc05hbWUgPSBcInBhbGV0dGUtd3JhcFwiO1xuICAgICAgICB0aGlzLnBhbGV0dGVUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuYXBwLnBhbGV0dGUubmFtZTtcbiAgICAgICAgdGhpcy5hcHAucGFsZXR0ZS5jb2xvcnMuZm9yRWFjaCgoY29sb3IsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKFwiY29sb3Itc3dhdGNoXCIpO1xuICAgICAgICAgICAgZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYHJnYmEoJHtjb2xvclswXX0sICR7Y29sb3JbMV19LCAke2NvbG9yWzJdfSwgJHtjb2xvclszXX0pYDtcbiAgICAgICAgICAgIHdyYXAuYXBwZW5kKGVsKTtcbiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAucHJpbWFyeUNvbG9yID0gY29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wYWxldHRlV3JhcC5hcHBlbmQod3JhcCk7XG4gICAgfVxuICAgIHJlbmRlckxheWVycygpIHtcbiAgICAgICAgdGhpcy5sYXllcnNXcmFwLmlubmVySFRNTCA9IFwiXCI7XG4gICAgICAgIHRoaXMuYXBwLmN1cnJlbnRGaWxlPy5kYXRhLmZvckVhY2goKGxheWVyLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImxheWVyXCIpO1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSB0aGlzLmFwcC5sYXllckluZGV4KSB7XG4gICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gbGF5ZXIubmFtZTtcbiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAubGF5ZXJJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubGF5ZXJzV3JhcC5hcHBlbmQoZWwpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0Q29sb3JTY2hlbWUoc2NoZW1lKSB7XG4gICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImNvbG9yc2NoZW1lXCIpKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZShcImNvbG9yc2NoZW1lXCIsIHNjaGVtZSk7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImNvbG9yc2NoZW1lXCIsIHNjaGVtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZShcImNvbG9yc2NoZW1lXCIsIHNjaGVtZSk7XG4gICAgICAgICAgICB0aGlzLmNvbG9yU2NoZW1lID0gc2NoZW1lO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjb2xvcnNjaGVtZVwiLCBzY2hlbWUpO1xuICAgICAgICB9XG4gICAgICAgIC8vdGhpcy5jb2xvclNjaGVtZSA9IHNjaGVtZTtcbiAgICAgICAgLy9kb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZShcImNvbG9yc2NoZW1lXCIsIHNjaGVtZSk7XG4gICAgICAgIC8vbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjb2xvcnNjaGVtZVwiLCBzY2hlbWUpO1xuICAgIH1cbiAgICBsb2cobXNnKSB7XG4gICAgICAgIHRoaXMudG8gJiYgY2xlYXJUaW1lb3V0KHRoaXMudG8pO1xuICAgICAgICB0aGlzLnN0YXR1c0xpbmUuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgIHRoaXMuc3RhdHVzTGluZS50ZXh0Q29udGVudCA9IG1zZztcbiAgICAgICAgdGhpcy50byA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNMaW5lLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNMaW5lLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgfSwgMjAwMCk7XG4gICAgfVxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJQYWxldHRlKCk7XG4gICAgICAgIHRoaXMucmVuZGVyTGF5ZXJzKCk7XG4gICAgICAgIHRoaXMuem9vbUVsZW1lbnQudGV4dENvbnRlbnQgPSBgJHt0aGlzLmFwcC56b29tICogMTAwfSVgO1xuICAgICAgICB0aGlzLnByaW1hcnlDb2xvckVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYHJnYmEoJHt0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMF19LCAke3RoaXMuYXBwLnByaW1hcnlDb2xvclsxXX0sICR7dGhpcy5hcHAucHJpbWFyeUNvbG9yWzJdfSwgJHt0aGlzLmFwcC5wcmltYXJ5Q29sb3JbM119KWA7XG4gICAgfVxufVxuIiwiaW1wb3J0IEFwcCBmcm9tIFwiLi9hcHBcIjtcbmNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcbndpbmRvdy5hcHAgPSBhcHA7XG4iLCJpbXBvcnQgV2l6RmlsZSBmcm9tIFwiLi9maWxlXCI7XG5pbXBvcnQgSGlzdG9yeSBmcm9tIFwiLi9oaXN0b3J5XCI7XG5pbXBvcnQgSW5wdXRDb21tYW5kIGZyb20gXCIuL2lucHV0LWNvbW1hbmRcIjtcbmltcG9ydCBMYXllciBmcm9tIFwiLi9sYXllclwiO1xuaW1wb3J0IHsgZGVmYXVsdFBhbGV0dGUgfSBmcm9tIFwiLi9wYWxldHRlXCI7XG5pbXBvcnQgUmVuZGVyZXIgZnJvbSBcIi4vcmVuZGVyZXJcIjtcbmltcG9ydCBVSSBmcm9tIFwiLi91aVwiO1xuY29uc3QgREVGQVVMVF9XSURUSCA9IDE2O1xuY29uc3QgREVGQVVMVF9IRUlHSFQgPSAxNjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuaGlzdG9yeSA9IG5ldyBIaXN0b3J5KCk7XG4gICAgICAgIHRoaXMuem9vbSA9IDI1O1xuICAgICAgICB0aGlzLnRvb2wgPSBcInBlbmNpbFwiO1xuICAgICAgICB0aGlzLmNvbG9yID0gMTtcbiAgICAgICAgdGhpcy5maWxlcyA9IFtdO1xuICAgICAgICB0aGlzLmZpbGVJbmRleCA9IDA7XG4gICAgICAgIHRoaXMucGFsZXR0ZSA9IGRlZmF1bHRQYWxldHRlO1xuICAgICAgICB0aGlzLnByaW1hcnlDb2xvciA9IHRoaXMucGFsZXR0ZS5nZXRDb2xvcigwKTtcbiAgICAgICAgdGhpcy5wYWxldHRlcyA9IFt0aGlzLnBhbGV0dGVdO1xuICAgICAgICB0aGlzLnVpID0gbmV3IFVJKHRoaXMpO1xuICAgICAgICB0aGlzLmlucHV0Q29tbWFuZCA9IG5ldyBJbnB1dENvbW1hbmQodGhpcyk7XG4gICAgICAgIHRoaXMubGF5ZXJJbmRleCA9IDA7XG4gICAgICAgIHRoaXMuZmlsZXMucHVzaChuZXcgV2l6RmlsZShERUZBVUxUX1dJRFRILCBERUZBVUxUX0hFSUdIVCkpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gbmV3IFJlbmRlcmVyKHRoaXMpO1xuICAgICAgICB0aGlzLnNldHVwKCk7XG4gICAgfVxuICAgIGdldCBjdXJyZW50RmlsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsZXNbdGhpcy5maWxlSW5kZXhdO1xuICAgIH1cbiAgICBzZXR1cCgpIHtcbiAgICAgICAgLy8gYWJpbGl0eSB0byB1bmRvIGNoYW5nZXMgd2l0aCBjbWQgKyB6XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5tZXRhS2V5ICYmIGUua2V5ID09PSBcIj1cIikge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnpvb21JbigpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLm1ldGFLZXkgJiYgZS5rZXkgPT09IFwiLVwiKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuem9vbU91dCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLm1ldGFLZXkgJiYgZS5rZXkgPT09IFwiMFwiKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuem9vbVJlc2V0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUubWV0YUtleSAmJiBlLmtleSA9PT0gXCJ6XCIpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy51bmRvKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICAgICAgICAgIC8vIGlmIGhvbGQgc3BhY2UgYW5kIG1vdmUgbW91c2UsIG1vdmUgY2FudmFzXG4gICAgICAgICAgICAgICAgY2FzZSBcIlNwYWNlXCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbnB1dENvbW1hbmQuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJvcGVuXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSBcImdyYWJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5idXR0b25zID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2FudmFzLnN0eWxlLmN1cnNvciA9IFwiZ3JhYmJpbmdcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jYW52YXMuc3R5bGUubGVmdCA9IGAke2UubW92ZW1lbnRYfXB4YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jYW52YXMuc3R5bGUudG9wID0gYCR7ZS5tb3ZlbWVudFl9cHhgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCI/XCI6XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51aS5oZWxwRGlhbG9nLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiRXNjYXBlXCI6XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5wdXRDb21tYW5kLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwib3BlblwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dENvbW1hbmQuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRDb21tYW5kLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIChlKSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIiBcIjpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSBcImRlZmF1bHRcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH1cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIudXBkYXRlKCk7XG4gICAgICAgIHRoaXMudWkudXBkYXRlKCk7XG4gICAgfVxuICAgIG5ld0ZpbGUoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwibmV3XCIpO1xuICAgIH1cbiAgICBuZXdMYXllcigpIHtcbiAgICAgICAgY29uc3QgbGF5ZXIgPSBuZXcgTGF5ZXIoXCJMYXllciBcIiArICh0aGlzLmN1cnJlbnRGaWxlLmRhdGEubGVuZ3RoICsgMSksIGZhbHNlLCB0aGlzLmN1cnJlbnRGaWxlLndpZHRoLCB0aGlzLmN1cnJlbnRGaWxlLmhlaWdodCk7XG4gICAgICAgIHRoaXMuY3VycmVudEZpbGUuZGF0YS5wdXNoKGxheWVyKTtcbiAgICAgICAgdGhpcy5sYXllckluZGV4ID0gdGhpcy5jdXJyZW50RmlsZS5kYXRhLmxlbmd0aCAtIDE7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuICAgIHNhdmVGaWxlKHR5cGUsIG9wdGlvbnMgPSB7IHNjYWxlOiAxIH0pIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFwicG5nXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGFVcmwgPSB0aGlzLnJlbmRlcmVyLmNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIik7XG4gICAgICAgICAgICBjb25zdCBjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcbiAgICAgICAgICAgIGNvbnN0IGN0eCA9IGMuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgICAgICAgICAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICBpbWcuc3JjID0gZGF0YVVybDtcbiAgICAgICAgICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYy53aWR0aCA9IGltZy53aWR0aCAqIG9wdGlvbnMuc2NhbGU7XG4gICAgICAgICAgICAgICAgYy5oZWlnaHQgPSBpbWcuaGVpZ2h0ICogb3B0aW9ucy5zY2FsZTtcbiAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgMCwgMCwgYy53aWR0aCwgYy5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcbiAgICAgICAgICAgICAgICBhLmhyZWYgPSBjLnRvRGF0YVVSTChcImltYWdlL3BuZ1wiKTtcbiAgICAgICAgICAgICAgICBhLmRvd25sb2FkID0gXCJpbWFnZS5wbmdcIjtcbiAgICAgICAgICAgICAgICBhLmNsaWNrKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy51aS5sb2coYHNhdmUgZmlsZSBhcyAke3R5cGV9YCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51aS5sb2coYGZpbGV0eXBlICR7dHlwZX0gaXMgbm90IHN1cHBvcnRlZGApO1xuICAgIH1cbiAgICB1bmRvKCkge1xuICAgICAgICB0aGlzLmhpc3RvcnkudW5kbygpO1xuICAgIH1cbiAgICByZWRvKCkge1xuICAgICAgICB0aGlzLmhpc3RvcnkucmVkbygpO1xuICAgIH1cbiAgICBjaGFuZ2VUb29sKHRvb2wpIHtcbiAgICAgICAgdGhpcy50b29sID0gdG9vbDtcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiTGF5ZXIiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJsb2NrZWQiLCJ3aWR0aCIsImhlaWdodCIsInRoaXMiLCJvcGFjaXR5IiwidmlzaWJsZSIsImRhdGEiLCJJbWFnZURhdGEiLCJkZWZhdWx0UGFsZXR0ZSIsImNvbG9ycyIsImFkZENvbG9yIiwiY29sb3IiLCJwdXNoIiwicmVtb3ZlQ29sb3IiLCJpbmRleCIsInNwbGljZSIsInNldENvbG9yIiwiZ2V0Q29sb3IiLCJXaXpGaWxlIiwicGFsZXR0ZSIsInNldENhbnZhc1NpemUiLCJmb3JFYWNoIiwibGF5ZXIiLCJzZXQiLCJIaXN0b3J5Tm9kZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJub3ciLCJIaXN0b3J5IiwibWF4Iiwic3RhY2siLCJidWZmZXIiLCJhZGQiLCJsZW5ndGgiLCJzaGlmdCIsInVuZG8iLCJwb3AiLCJyZWRvIiwiY2xlYXIiLCJJbnB1dENvbW1hbmQiLCJhcHAiLCJjb21tYW5kcyIsIm4iLCJuZXdGaWxlIiwibmwiLCJuZXdMYXllciIsImwiLCJ1aSIsImxheWVyc0RpYWxvZyIsInRvZ2dsZSIsImUiLCJ3IiwidHlwZSIsInNjYWxlIiwic2F2ZUZpbGUiLCJwYXJzZUludCIsImgiLCJoZWxwRGlhbG9nIiwibG9nIiwicCIsInBhbGV0dGVEaWFsb2ciLCJQIiwibXNnIiwiaHMiLCJzdGFydHVwRGlhbG9nIiwiY3MiLCJ0aGVtZSIsInNldENvbG9yU2NoZW1lIiwiZWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY2xhc3NOYW1lIiwiY29uc29sZSIsIl9jb250YWluZXIiLCJhcHBlbmQiLCJhZGRFdmVudExpc3RlbmVyIiwia2V5IiwiZXhlY3V0ZSIsInZhbHVlIiwiY2xvc2UiLCJvcGVuIiwiY2xhc3NMaXN0IiwiZm9jdXMiLCJyZW1vdmUiLCJjbWQiLCJzbGljZSIsImNvbW1hbmQiLCJhcmdzIiwic3BsaXQiLCJSZW5kZXJlciIsInpvb20iLCJmaWxlIiwiY3VycmVudEZpbGUiLCJncmlkIiwiZ3JpZFNpemUiLCJfY2FudmFzIiwiX2N0eCIsImNhbnZhcyIsImdldENvbnRleHQiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImZpbGVzIiwiZmlsZUluZGV4IiwiYmFja2dyb3VuZEltYWdlIiwiYmFja2dyb3VuZFNpemUiLCJpbWFnZVJlbmRlcmluZyIsInNldFpvb20iLCJwcmV2ZW50RGVmYXVsdCIsInpvb21DaGFuZ2UiLCJkZWx0YVkiLCJib2R5IiwicXVlcnlTZWxlY3RvciIsImltYWdlRGF0YSIsImN0eCIsImNyZWF0ZUltYWdlRGF0YSIsImhpc3RvcnkiLCJnZXRJbWFnZURhdGEiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsIk1hdGgiLCJmbG9vciIsImNsaWVudFgiLCJsZWZ0IiwiY2xpZW50WSIsInRvcCIsInByaW1hcnlDb2xvciIsInB1dEltYWdlRGF0YSIsImJ1dHRvbnMiLCJkcmF3UmVjdCIsInkiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsImZpbGwiLCJzdGFydFgiLCJzdGFydFkiLCJ0YXJnZXRDb2xvciIsInJlcGxhY2VDb2xvciIsIm1hdHJpeCIsImxheWVySW5kZXgiLCJ1cGRhdGUiLCJkdCIsImRlbHRhIiwic2lnbiIsInpvb21JbiIsInpvb21PdXQiLCJ6b29tUmVzZXQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJiaW5kIiwiRGlhbG9nRWxlbWVudCIsImNvbnRhaW5lciIsInRpdGxlIiwiY29udGVudCIsIl90ZW1wbGF0ZSIsImhlYWRlciIsImlubmVySFRNTCIsImNsb3NlQnRuIiwiZHJhZyIsInBvczEiLCJwb3MyIiwicG9zMyIsInBvczQiLCJlbGVtZW50RHJhZyIsIm9mZnNldFRvcCIsIm9mZnNldExlZnQiLCJjbG9zZURyYWdFbGVtZW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm1vdmUiLCJoYXNBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiVGFiIiwidG9TdHJpbmciLCJ0YWJUaXRsZSIsInRleHRDb250ZW50IiwiYXBwZW5kQ2hpbGQiLCJkZWFjdGl2YXRlVGFiIiwiYWN0aXZhdGVUYWIiLCJyZW5hbWUiLCJVSSIsInpvb21FbGVtZW50IiwicHJpbWFyeUNvbG9yRWxlbWVudCIsInN0YXR1c0xpbmUiLCJsYXllcnNXcmFwIiwicGFsZXR0ZVdyYXAiLCJwYWxldHRlVGl0bGUiLCJ0YWJzIiwiY29sb3JTY2hlbWUiLCJnZXRJdGVtIiwicmVuZGVyUGFsZXR0ZSIsIndyYXAiLCJlbCIsInJlbmRlckxheWVycyIsInNjaGVtZSIsInRvIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInRvb2wiLCJwYWxldHRlcyIsImlucHV0Q29tbWFuZCIsInJlbmRlcmVyIiwic2V0dXAiLCJtZXRhS2V5IiwiY29udGFpbnMiLCJjdXJzb3IiLCJtb3ZlbWVudFgiLCJtb3ZlbWVudFkiLCJvcHRpb25zIiwiZGF0YVVybCIsInRvRGF0YVVSTCIsImMiLCJpbWciLCJJbWFnZSIsInNyYyIsIm9ubG9hZCIsImRyYXdJbWFnZSIsImEiLCJocmVmIiwiZG93bmxvYWQiLCJjbGljayIsImNoYW5nZVRvb2wiXSwic291cmNlUm9vdCI6IiJ9