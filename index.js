(()=>{"use strict";class t{constructor(t="New layer",e=!1,i,s){this.name=t,this.locked=e,this.width=i,this.height=s,this.opacity=255,this.visible=!0,this.data=new ImageData(i,s)}}const e=new class{constructor(t="New palette"){this.name=t,this.colors=[[]]}addColor(t){this.colors.push(t)}removeColor(t){this.colors.splice(t,1)}setColor(t,e){this.colors[t]=e}getColor(t){return this.colors[t]}}("Default");e.colors=[[0,0,0,255],[252,252,252,255],[248,248,248,255],[188,188,188,255],[124,124,124,255],[164,228,252,255],[60,188,252,255],[0,120,248,255],[0,0,252,255],[184,184,248,255],[104,136,252,255],[0,88,248,255],[0,0,188,255],[216,184,248,255],[152,120,248,255],[104,68,252,255],[68,40,188,255],[248,184,248,255],[248,120,248,255],[216,0,204,255],[148,0,132,255],[248,164,192,255],[248,88,152,255],[228,0,88,255],[168,0,32,255],[240,208,176,255],[248,120,88,255],[248,56,0,255],[168,16,0,255],[252,224,168,255],[252,160,68,255],[228,92,16,255],[136,20,0,255],[248,216,120,255],[248,184,0,255],[172,124,0,255],[80,40,0,255],[216,248,120,255],[184,248,24,255],[0,184,0,255],[0,120,0,255],[184,248,184,255],[88,216,84,255],[0,168,0,255],[0,104,0,255],[184,248,216,255],[88,248,152,255],[0,168,68,255],[0,88,0,255],[0,252,252,255],[0,232,216,255],[0,136,136,255],[0,64,88,255],[248,216,248,255],[120,120,120,255]];class i{constructor(i,s){this.width=i,this.height=s,this.data=[],this.palette=e,this.data=[new t("Background",!0,i,s)]}}class s{constructor(t){this.app=t,this.items=[],this.cursor=this.items.length-1}add(t){this.items.push(t),this.cursor=this.items.length-1}clearFromCursor(){this.items.splice(this.cursor+1)}undo(){}redo(){}}class o{constructor(t){this.app=t,this.zoom=25,this.file=this.app.files[this.app.fileIndex],this.grid=!0,this.gridSize=16,this._canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this.canvas.style.backgroundColor="white",this.canvas.width=this.app.files[this.app.fileIndex].width,this.canvas.height=this.app.files[this.app.fileIndex].height,this.canvas.style.backgroundImage="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><rect width='16' height='16' fill='none'/><rect x='0' y='0' width='8' height='8' fill='%23f0f0f0'/><rect x='8' y='8' width='8' height='8' fill='%23f0f0f0'/></svg>\")",this.canvas.style.backgroundSize="16px 16px",this.canvas.style.imageRendering="pixelated",this.setZoom(this.zoom),this.canvas.addEventListener("wheel",(t=>{t.preventDefault(),this.zoomChange(t.deltaY)})),document.body.querySelector("#main").append(this.canvas);const e=this.ctx.createImageData(this.file.width,this.file.height);this.canvas.addEventListener("click",(t=>{this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height));const i=this.canvas.getBoundingClientRect(),s=Math.floor((t.clientX-i.left)/this.zoom),o=4*(Math.floor((t.clientY-i.top)/this.zoom)*this.file.width+s);e.data[o]=this.app.primaryColor[0],e.data[o+1]=this.app.primaryColor[1],e.data[o+2]=this.app.primaryColor[2],e.data[o+3]=this.app.primaryColor[3],this.ctx.putImageData(e,0,0),this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height))})),this.canvas.addEventListener("mousemove",(t=>{if(1===t.buttons){this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height));const i=this.canvas.getBoundingClientRect(),s=Math.floor((t.clientX-i.left)/this.zoom),o=4*(Math.floor((t.clientY-i.top)/this.zoom)*this.file.width+s);e.data[o]=this.app.primaryColor[0],e.data[o+1]=this.app.primaryColor[1],e.data[o+2]=this.app.primaryColor[2],e.data[o+3]=this.app.primaryColor[3],this.ctx.putImageData(e,0,0),this.app.history.add(this.ctx.getImageData(0,0,this.file.width,this.file.height))}}))}get canvas(){return this._canvas}get ctx(){return this._ctx}drawRect(t,e,i,s,o){this.ctx.fillStyle=o,this.ctx.fillRect(t,e,i,s)}fill(t,e,i,s){const o=this.file.data[this.app.layerIndex].data;if(t<0||t>=o.width||e<0||e>=o.height)return;const a=e*o.width+t;o.data[a]!==s&&o.data[a]===i&&(o.data[a]=s,this.fill(t+1,e,i,s),this.fill(t-1,e,i,s),this.fill(t,e+1,i,s),this.fill(t,e-1,i,s))}setZoom(t){this.zoom=t,this.canvas.style.width=this.file.width*this.zoom+"px",this.canvas.style.height=this.file.height*this.zoom+"px",this.update()}zoomChange(t=0){const e=Math.sign(t);this.zoom+=8*e,this.setZoom(this.zoom)}zoomIn(){console.log("zoom in"),this.zoom<128&&this.zoomChange(1)}zoomOut(){console.log("zoom out"),this.zoom>1&&this.zoomChange(-1)}zoomReset(){console.log("zoom reset"),this.setZoom(25)}update(){requestAnimationFrame(this.update.bind(this))}}class a{constructor(t){this.selector=t,this.element=document.querySelector(`#${t}`),this.closeBtn=this.element.querySelector(`#btnClose${t}`),this.closeBtn.addEventListener("click",(()=>{this.close()}))}toggle(){this.element.hasAttribute("open")?this.close():this.open()}open(){this.element.setAttribute("open","")}close(){this.element.removeAttribute("open"),window.localStorage.setItem("startup","false")}}class h{constructor(t,e){this.selector=t,this.app=e,this.commands={n:()=>{this.app.newFile()},e:()=>{},w:t=>{this.app.saveFile(t)},h:()=>{this.app.ui.helpDialog.toggle(),this.app.ui.log("Help")},p:()=>{this.app.ui.paletteDialog.toggle(),this.app.ui.log("Open palette")},P:()=>{},log:t=>{this.app.ui.log(t)}},this.element=document.querySelector(`#${t}`),this.element.addEventListener("keydown",(t=>{"Enter"===t.key&&(this.execute(this.element.value),this.close())}))}open(){this.element.classList.add("open"),this.element.focus(),this.element.value=":"}close(){this.element.classList.remove("open"),this.element.value=""}execute(t){t=t.slice(1);const[e,...i]=t.split(" ");console.log(e,i),e in this.commands?this.commands[e](...i):this.app.ui.log(`command not found: ${e}`)}}class n{constructor(t){this.title=t,this.id=Date.now().toString(),this.element=document.createElement("div"),this.tabTitle=document.createElement("span"),this.element.id=this.id,this.element.classList.add("tab"),this.closeBtn=document.createElement("button"),this.closeBtn.id=`#btnClose${this.id}`,this.closeBtn.textContent="X",this.tabTitle.textContent=t,this.element.append(this.tabTitle,this.closeBtn),document.querySelector("#tabs").appendChild(this.element),this.closeBtn.addEventListener("click",(()=>{this.close()}))}deactivateTab(){this.element.classList.remove("active")}activateTab(){this.element.classList.add("active")}rename(t){this.title=t,this.tabTitle.textContent=t}close(){this.element.removeAttribute("open")}}class l{constructor(t){this.app=t,this.startupDialog=new a("DialogStartup"),this.helpDialog=new a("DialogHelp"),this.inputCommand=new h("InputCmd",this.app),this.zoomElement=document.querySelector("#zoom"),this.primaryColorElement=document.querySelector("#toolPrColor"),this.statusLine=document.querySelector("#statusLine"),this.paletteDialog=new a("DialogPalette"),this.paletteWrap=document.querySelector("#paletteWrap"),this.paletteTitle=document.querySelector("#paletteTitle"),this.tabs=document.querySelector("#tabs"),this.app=t,window.localStorage.getItem("startup")&&"true"!==window.localStorage.getItem("startup")||this.startupDialog.open(),this.tabs.append(new n("Untitled").element),this.update()}renderPalette(){this.paletteWrap.innerHTML="",this.paletteTitle.textContent=this.app.palette.name,this.app.palette.colors.forEach(((t,e)=>{const i=document.createElement("div");i.classList.add("color-swatch"),i.style.backgroundColor=`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`,this.paletteWrap.append(i),i.addEventListener("click",(()=>{this.app.primaryColor=t,this.update()}))}))}log(t){this.to&&clearTimeout(this.to),this.statusLine.classList.add("open"),this.statusLine.textContent=t,this.to=setTimeout((()=>{this.statusLine.classList.remove("open"),this.statusLine.textContent=""}),2e3)}update(){this.renderPalette(),this.zoomElement.textContent=100*this.app.zoom+"%",this.primaryColorElement.style.backgroundColor=`rgba(${this.app.primaryColor[0]}, ${this.app.primaryColor[1]}, ${this.app.primaryColor[2]}, ${this.app.primaryColor[3]})`}}const r=new class{constructor(){this.history=new s(this),this.zoom=25,this.tool="pencil",this.color=1,this.files=[],this.fileIndex=0,this.palette=e,this.primaryColor=this.palette.getColor(0),this.palettes=[this.palette],this.ui=new l(this),this.layerIndex=0,this.files.push(new i(16,16)),this.renderer=new o(this),this.setup()}setup(){document.addEventListener("keydown",(t=>{if(t.metaKey&&"="===t.key)return t.preventDefault(),void this.renderer.zoomIn();if(t.metaKey&&"-"===t.key)return t.preventDefault(),void this.renderer.zoomOut();if(t.metaKey&&"0"===t.key)return t.preventDefault(),void this.renderer.zoomReset();if(t.metaKey&&"z"===t.key)return t.preventDefault(),void this.undo();switch(t.key){case"Space":this.ui.inputCommand.element.classList.contains("open")||(t.preventDefault(),this.renderer.canvas.style.cursor="grab",this.renderer.canvas.addEventListener("mousemove",(t=>{1===t.buttons&&(this.renderer.canvas.style.cursor="grabbing",this.renderer.canvas.style.left=`${t.movementX}px`,this.renderer.canvas.style.top=`${t.movementY}px`)})));break;case"?":t.preventDefault(),this.ui.helpDialog.toggle();break;case"Escape":t.preventDefault(),this.ui.inputCommand.element.classList.contains("open")?this.ui.inputCommand.close():this.ui.inputCommand.open()}})),document.addEventListener("keyup",(t=>{if(" "===t.key)t.preventDefault(),this.renderer.canvas.style.cursor="default"})),this.update()}update(){this.renderer.update(),this.ui.update()}newFile(){console.log("new")}saveFile(t){if("png"===t){this.ui.log(`save file as ${t}`);const e=document.createElement("a");return e.download="image.png",e.href=this.renderer.canvas.toDataURL("image/png"),void e.click()}this.ui.log(`filetype ${t} is not supported`)}undo(){this.history.undo()}redo(){this.history.redo()}changeTool(t){this.tool=t}};window.app=r})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJtYXBwaW5ncyI6Im1CQUFlLE1BQU1BLEVBQ2pCQyxZQUFZQyxFQUFPLFlBQWFDLEdBQVMsRUFBT0MsRUFBT0MsR0FDbkRDLEtBQUtKLEtBQU9BLEVBQ1pJLEtBQUtILE9BQVNBLEVBQ2RHLEtBQUtGLE1BQVFBLEVBQ2JFLEtBQUtELE9BQVNBLEVBQ2RDLEtBQUtDLFFBQVUsSUFDZkQsS0FBS0UsU0FBVSxFQUNmRixLQUFLRyxLQUFPLElBQUlDLFVBQVVOLEVBQU9DLEVBQ3JDLEVDU0csTUFBTU0sRUFBaUIsSUFsQmYsTUFDWFYsWUFBWUMsRUFBTyxlQUNmSSxLQUFLSixLQUFPQSxFQUNaSSxLQUFLTSxPQUFTLENBQUMsR0FDbkIsQ0FDQUMsU0FBU0MsR0FDTFIsS0FBS00sT0FBT0csS0FBS0QsRUFDckIsQ0FDQUUsWUFBWUMsR0FDUlgsS0FBS00sT0FBT00sT0FBT0QsRUFBTyxFQUM5QixDQUNBRSxTQUFTRixFQUFPSCxHQUNaUixLQUFLTSxPQUFPSyxHQUFTSCxDQUN6QixDQUNBTSxTQUFTSCxHQUNMLE9BQU9YLEtBQUtNLE9BQU9LLEVBQ3ZCLEdBRXNDLFdBRTFDTixFQUFlQyxPQUFTLENBQ3BCLENBQUMsRUFBRyxFQUFHLEVBQUcsS0FDVixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxHQUFJLElBQUssSUFBSyxLQUNmLENBQUMsRUFBRyxJQUFLLElBQUssS0FDZCxDQUFDLEVBQUcsRUFBRyxJQUFLLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsRUFBRyxHQUFJLElBQUssS0FDYixDQUFDLEVBQUcsRUFBRyxJQUFLLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxHQUFJLElBQUssS0FDZixDQUFDLEdBQUksR0FBSSxJQUFLLEtBQ2QsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxFQUFHLElBQUssS0FDZCxDQUFDLElBQUssRUFBRyxJQUFLLEtBQ2QsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssR0FBSSxJQUFLLEtBQ2YsQ0FBQyxJQUFLLEVBQUcsR0FBSSxLQUNiLENBQUMsSUFBSyxFQUFHLEdBQUksS0FDYixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLEdBQUksS0FDZixDQUFDLElBQUssR0FBSSxFQUFHLEtBQ2IsQ0FBQyxJQUFLLEdBQUksRUFBRyxLQUNiLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxJQUFLLElBQUssR0FBSSxLQUNmLENBQUMsSUFBSyxHQUFJLEdBQUksS0FDZCxDQUFDLElBQUssR0FBSSxFQUFHLEtBQ2IsQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLElBQUssSUFBSyxFQUFHLEtBQ2QsQ0FBQyxJQUFLLElBQUssRUFBRyxLQUNkLENBQUMsR0FBSSxHQUFJLEVBQUcsS0FDWixDQUFDLElBQUssSUFBSyxJQUFLLEtBQ2hCLENBQUMsSUFBSyxJQUFLLEdBQUksS0FDZixDQUFDLEVBQUcsSUFBSyxFQUFHLEtBQ1osQ0FBQyxFQUFHLElBQUssRUFBRyxLQUNaLENBQUMsSUFBSyxJQUFLLElBQUssS0FDaEIsQ0FBQyxHQUFJLElBQUssR0FBSSxLQUNkLENBQUMsRUFBRyxJQUFLLEVBQUcsS0FDWixDQUFDLEVBQUcsSUFBSyxFQUFHLEtBQ1osQ0FBQyxJQUFLLElBQUssSUFBSyxLQUNoQixDQUFDLEdBQUksSUFBSyxJQUFLLEtBQ2YsQ0FBQyxFQUFHLElBQUssR0FBSSxLQUNiLENBQUMsRUFBRyxHQUFJLEVBQUcsS0FDWCxDQUFDLEVBQUcsSUFBSyxJQUFL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QUNQaEssS0FBS2dLLEtBQU9BLENBQ2hCLEdEOUdKdkQsT0FBT3ZGLElBQU1BLEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90c2JwLy4vc3JjL2xheWVyLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvcGFsZXR0ZS50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL2ZpbGUudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9oaXN0b3J5LnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvcmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9kaWFsb2cudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9pbnB1dC1jb21tYW5kLnRzIiwid2VicGFjazovL3RzYnAvLi9zcmMvdWkudHMiLCJ3ZWJwYWNrOi8vdHNicC8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly90c2JwLy4vc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBMYXllciB7XG4gICAgY29uc3RydWN0b3IobmFtZSA9IFwiTmV3IGxheWVyXCIsIGxvY2tlZCA9IGZhbHNlLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMubG9ja2VkID0gbG9ja2VkO1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB0aGlzLm9wYWNpdHkgPSAyNTU7XG4gICAgICAgIHRoaXMudmlzaWJsZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZGF0YSA9IG5ldyBJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFsZXR0ZSB7XG4gICAgY29uc3RydWN0b3IobmFtZSA9IFwiTmV3IHBhbGV0dGVcIikge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmNvbG9ycyA9IFtbXV07XG4gICAgfVxuICAgIGFkZENvbG9yKGNvbG9yKSB7XG4gICAgICAgIHRoaXMuY29sb3JzLnB1c2goY29sb3IpO1xuICAgIH1cbiAgICByZW1vdmVDb2xvcihpbmRleCkge1xuICAgICAgICB0aGlzLmNvbG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbiAgICBzZXRDb2xvcihpbmRleCwgY29sb3IpIHtcbiAgICAgICAgdGhpcy5jb2xvcnNbaW5kZXhdID0gY29sb3I7XG4gICAgfVxuICAgIGdldENvbG9yKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yc1tpbmRleF07XG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IGRlZmF1bHRQYWxldHRlID0gbmV3IFBhbGV0dGUoXCJEZWZhdWx0XCIpO1xuLy8gTkVTIHBhbGV0dGVcbmRlZmF1bHRQYWxldHRlLmNvbG9ycyA9IFtcbiAgICBbMCwgMCwgMCwgMjU1XSxcbiAgICBbMjUyLCAyNTIsIDI1MiwgMjU1XSxcbiAgICBbMjQ4LCAyNDgsIDI0OCwgMjU1XSxcbiAgICBbMTg4LCAxODgsIDE4OCwgMjU1XSxcbiAgICBbMTI0LCAxMjQsIDEyNCwgMjU1XSxcbiAgICBbMTY0LCAyMjgsIDI1MiwgMjU1XSxcbiAgICBbNjAsIDE4OCwgMjUyLCAyNTVdLFxuICAgIFswLCAxMjAsIDI0OCwgMjU1XSxcbiAgICBbMCwgMCwgMjUyLCAyNTVdLFxuICAgIFsxODQsIDE4NCwgMjQ4LCAyNTVdLFxuICAgIFsxMDQsIDEzNiwgMjUyLCAyNTVdLFxuICAgIFswLCA4OCwgMjQ4LCAyNTVdLFxuICAgIFswLCAwLCAxODgsIDI1NV0sXG4gICAgWzIxNiwgMTg0LCAyNDgsIDI1NV0sXG4gICAgWzE1MiwgMTIwLCAyNDgsIDI1NV0sXG4gICAgWzEwNCwgNjgsIDI1MiwgMjU1XSxcbiAgICBbNjgsIDQwLCAxODgsIDI1NV0sXG4gICAgWzI0OCwgMTg0LCAyNDgsIDI1NV0sXG4gICAgWzI0OCwgMTIwLCAyNDgsIDI1NV0sXG4gICAgWzIxNiwgMCwgMjA0LCAyNTVdLFxuICAgIFsxNDgsIDAsIDEzMiwgMjU1XSxcbiAgICBbMjQ4LCAxNjQsIDE5MiwgMjU1XSxcbiAgICBbMjQ4LCA4OCwgMTUyLCAyNTVdLFxuICAgIFsyMjgsIDAsIDg4LCAyNTVdLFxuICAgIFsxNjgsIDAsIDMyLCAyNTVdLFxuICAgIFsyNDAsIDIwOCwgMTc2LCAyNTVdLFxuICAgIFsyNDgsIDEyMCwgODgsIDI1NV0sXG4gICAgWzI0OCwgNTYsIDAsIDI1NV0sXG4gICAgWzE2OCwgMTYsIDAsIDI1NV0sXG4gICAgWzI1MiwgMjI0LCAxNjgsIDI1NV0sXG4gICAgWzI1MiwgMTYwLCA2OCwgMjU1XSxcbiAgICBbMjI4LCA5MiwgMTYsIDI1NV0sXG4gICAgWzEzNiwgMjAsIDAsIDI1NV0sXG4gICAgWzI0OCwgMjE2LCAxMjAsIDI1NV0sXG4gICAgWzI0OCwgMTg0LCAwLCAyNTVdLFxuICAgIFsxNzIsIDEyNCwgMCwgMjU1XSxcbiAgICBbODAsIDQwLCAwLCAyNTVdLFxuICAgIFsyMTYsIDI0OCwgMTIwLCAyNTVdLFxuICAgIFsxODQsIDI0OCwgMjQsIDI1NV0sXG4gICAgWzAsIDE4NCwgMCwgMjU1XSxcbiAgICBbMCwgMTIwLCAwLCAyNTVdLFxuICAgIFsxODQsIDI0OCwgMTg0LCAyNTVdLFxuICAgIFs4OCwgMjE2LCA4NCwgMjU1XSxcbiAgICBbMCwgMTY4LCAwLCAyNTVdLFxuICAgIFswLCAxMDQsIDAsIDI1NV0sXG4gICAgWzE4NCwgMjQ4LCAyMTYsIDI1NV0sXG4gICAgWzg4LCAyNDgsIDE1MiwgMjU1XSxcbiAgICBbMCwgMTY4LCA2OCwgMjU1XSxcbiAgICBbMCwgODgsIDAsIDI1NV0sXG4gICAgWzAsIDI1MiwgMjUyLCAyNTVdLFxuICAgIFswLCAyMzIsIDIxNiwgMjU1XSxcbiAgICBbMCwgMTM2LCAxMzYsIDI1NV0sXG4gICAgWzAsIDY0LCA4OCwgMjU1XSxcbiAgICBbMjQ4LCAyMTYsIDI0OCwgMjU1XSxcbiAgICBbMTIwLCAxMjAsIDEyMCwgMjU1XSxcbl07XG4iLCJpbXBvcnQgTGF5ZXIgZnJvbSBcIi4vbGF5ZXJcIjtcbmltcG9ydCB7IGRlZmF1bHRQYWxldHRlIH0gZnJvbSBcIi4vcGFsZXR0ZVwiO1xuZXhwb3J0IGNsYXNzIFdpekZpbGUge1xuICAgIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgdGhpcy5kYXRhID0gW107XG4gICAgICAgIHRoaXMucGFsZXR0ZSA9IGRlZmF1bHRQYWxldHRlO1xuICAgICAgICB0aGlzLmRhdGEgPSBbbmV3IExheWVyKFwiQmFja2dyb3VuZFwiLCB0cnVlLCB3aWR0aCwgaGVpZ2h0KV07XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGlzdG9yeSB7XG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLml0ZW1zID0gW107XG4gICAgICAgIHRoaXMuY3Vyc29yID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBhZGQoaXRlbSkge1xuICAgICAgICB0aGlzLml0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgIHRoaXMuY3Vyc29yID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBjbGVhckZyb21DdXJzb3IoKSB7XG4gICAgICAgIHRoaXMuaXRlbXMuc3BsaWNlKHRoaXMuY3Vyc29yICsgMSk7XG4gICAgfVxuICAgIHVuZG8oKSB7XG4gICAgICAgIC8vICBpZiAodGhpcy5jdXJzb3IgPiAwKSB7XG4gICAgICAgIC8vICAgIHRoaXMuY3Vyc29yLS07XG4gICAgICAgIC8vICAgIHRoaXMuYXBwLmZpbGVzW3RoaXMuYXBwLmZpbGVJbmRleF0uZGF0YS5wdXRJbWFnZURhdGEodGhpcy5pdGVtc1t0aGlzLmN1cnNvcl0sIDAsIDApO1xuICAgICAgICAvLyAgfVxuICAgIH1cbiAgICByZWRvKCkge1xuICAgICAgICAvLyAgaWYgKHRoaXMuY3Vyc29yIDwgdGhpcy5pdGVtcy5sZW5ndGggLSAxKSB7XG4gICAgICAgIC8vICAgIHRoaXMuY3Vyc29yKys7XG4gICAgICAgIC8vICAgIHRoaXMuYXBwLmN0eC5wdXRJbWFnZURhdGEodGhpcy5pdGVtc1t0aGlzLmN1cnNvcl0sIDAsIDApO1xuICAgICAgICAvLyAgfVxuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyIHtcbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuem9vbSA9IDI1O1xuICAgICAgICB0aGlzLmZpbGUgPSB0aGlzLmFwcC5maWxlc1t0aGlzLmFwcC5maWxlSW5kZXhdO1xuICAgICAgICB0aGlzLmdyaWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmdyaWRTaXplID0gMTY7XG4gICAgICAgIHRoaXMuX2NhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4gICAgICAgIHRoaXMuX2N0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuYXBwLmZpbGVzW3RoaXMuYXBwLmZpbGVJbmRleF0ud2lkdGg7XG4gICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuYXBwLmZpbGVzW3RoaXMuYXBwLmZpbGVJbmRleF0uaGVpZ2h0O1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO3V0ZjgsPHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxNicgaGVpZ2h0PScxNicgdmlld0JveD0nMCAwIDE2IDE2Jz48cmVjdCB3aWR0aD0nMTYnIGhlaWdodD0nMTYnIGZpbGw9J25vbmUnLz48cmVjdCB4PScwJyB5PScwJyB3aWR0aD0nOCcgaGVpZ2h0PSc4JyBmaWxsPSclMjNmMGYwZjAnLz48cmVjdCB4PSc4JyB5PSc4JyB3aWR0aD0nOCcgaGVpZ2h0PSc4JyBmaWxsPSclMjNmMGYwZjAnLz48L3N2Zz5cIilgO1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9IFwiMTZweCAxNnB4XCI7XG4gICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmltYWdlUmVuZGVyaW5nID0gXCJwaXhlbGF0ZWRcIjtcbiAgICAgICAgdGhpcy5zZXRab29tKHRoaXMuem9vbSk7XG4gICAgICAgIC8vIGFiaWxpdHkgdG8gem9vbSBpbiBhbmQgb3V0IHdpdGggbW91c2Ugd2hlZWxcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnpvb21DaGFuZ2UoZS5kZWx0YVkpO1xuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKFwiI21haW5cIikuYXBwZW5kKHRoaXMuY2FudmFzKTtcbiAgICAgICAgY29uc3QgaW1hZ2VEYXRhID0gdGhpcy5jdHguY3JlYXRlSW1hZ2VEYXRhKHRoaXMuZmlsZS53aWR0aCwgdGhpcy5maWxlLmhlaWdodCk7XG4gICAgICAgIC8vIGFiaWxpdHkgdG8gZHJhdyBwaXhlbCB3aXRoIG1vdXNlIGNsaWNrXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hcHAuaGlzdG9yeS5hZGQodGhpcy5jdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMuZmlsZS53aWR0aCwgdGhpcy5maWxlLmhlaWdodCkpO1xuICAgICAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgY29uc3QgeCA9IE1hdGguZmxvb3IoKGUuY2xpZW50WCAtIHJlY3QubGVmdCkgLyB0aGlzLnpvb20pO1xuICAgICAgICAgICAgY29uc3QgeSA9IE1hdGguZmxvb3IoKGUuY2xpZW50WSAtIHJlY3QudG9wKSAvIHRoaXMuem9vbSk7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9ICh5ICogdGhpcy5maWxlLndpZHRoICsgeCkgKiA0O1xuICAgICAgICAgICAgLy90aGlzLmZpbGVzW3RoaXMuZmlsZUluZGV4XS5kYXRhW3RoaXMubGF5ZXJJbmRleF0uZGF0YVt5XVt4XSA9IHRoaXMuY29sb3I7XG4gICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleF0gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMF07XG4gICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDFdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzFdO1xuICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAyXSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclsyXTtcbiAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgM10gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbM107XG4gICAgICAgICAgICB0aGlzLmN0eC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcbiAgICAgICAgICAgIHRoaXMuYXBwLmhpc3RvcnkuYWRkKHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmZpbGUud2lkdGgsIHRoaXMuZmlsZS5oZWlnaHQpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGFiaWxpdHkgdG8gZHJhdyBwaXhlbCB3aXRoIG1vdXNlIG1vdmVcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUuYnV0dG9ucyA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLmhpc3RvcnkuYWRkKHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmZpbGUud2lkdGgsIHRoaXMuZmlsZS5oZWlnaHQpKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgeCA9IE1hdGguZmxvb3IoKGUuY2xpZW50WCAtIHJlY3QubGVmdCkgLyB0aGlzLnpvb20pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBNYXRoLmZsb29yKChlLmNsaWVudFkgLSByZWN0LnRvcCkgLyB0aGlzLnpvb20pO1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gKHkgKiB0aGlzLmZpbGUud2lkdGggKyB4KSAqIDQ7XG4gICAgICAgICAgICAgICAgLy90aGlzLmZpbGVzW3RoaXMuZmlsZUluZGV4XS5kYXRhW3RoaXMubGF5ZXJJbmRleF0uZGF0YVt5XVt4XSA9XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5jb2xvcjtcbiAgICAgICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleF0gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMF07XG4gICAgICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAxXSA9IHRoaXMuYXBwLnByaW1hcnlDb2xvclsxXTtcbiAgICAgICAgICAgICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDJdID0gdGhpcy5hcHAucHJpbWFyeUNvbG9yWzJdO1xuICAgICAgICAgICAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgM10gPSB0aGlzLmFwcC5wcmltYXJ5Q29sb3JbM107XG4gICAgICAgICAgICAgICAgdGhpcy5jdHgucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuaGlzdG9yeS5hZGQodGhpcy5jdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMuZmlsZS53aWR0aCwgdGhpcy5maWxlLmhlaWdodCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IGNhbnZhcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbnZhcztcbiAgICB9XG4gICAgZ2V0IGN0eCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N0eDtcbiAgICB9XG4gICAgZHJhd1JlY3QoeCwgeSwgdywgaCwgY29sb3IpIHtcbiAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gY29sb3I7XG4gICAgICAgIHRoaXMuY3R4LmZpbGxSZWN0KHgsIHksIHcsIGgpO1xuICAgIH1cbiAgICBmaWxsKHN0YXJ0WCwgc3RhcnRZLCB0YXJnZXRDb2xvciwgcmVwbGFjZUNvbG9yKSB7XG4gICAgICAgIGNvbnN0IG1hdHJpeCA9IHRoaXMuZmlsZS5kYXRhW3RoaXMuYXBwLmxheWVySW5kZXhdLmRhdGE7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBzdGFydCBjb29yZGluYXRlcyBhcmUgb3V0IG9mIGJvdW5kc1xuICAgICAgICBpZiAoc3RhcnRYIDwgMCB8fFxuICAgICAgICAgICAgc3RhcnRYID49IG1hdHJpeC53aWR0aCB8fFxuICAgICAgICAgICAgc3RhcnRZIDwgMCB8fFxuICAgICAgICAgICAgc3RhcnRZID49IG1hdHJpeC5oZWlnaHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbmRleCA9IHN0YXJ0WSAqIG1hdHJpeC53aWR0aCArIHN0YXJ0WDtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHRhcmdldCB2YWx1ZSBtYXRjaGVzIHRoZSByZXBsYWNlbWVudCB2YWx1ZVxuICAgICAgICBpZiAobWF0cml4LmRhdGFbaW5kZXhdID09PSByZXBsYWNlQ29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCB2YWx1ZSBtYXRjaGVzIHRoZSB0YXJnZXQgdmFsdWVcbiAgICAgICAgaWYgKG1hdHJpeC5kYXRhW2luZGV4XSAhPT0gdGFyZ2V0Q29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBSZXBsYWNlIHRoZSBjdXJyZW50IHZhbHVlIHdpdGggdGhlIHJlcGxhY2VtZW50IHZhbHVlXG4gICAgICAgIG1hdHJpeC5kYXRhW2luZGV4XSA9IHJlcGxhY2VDb2xvcjtcbiAgICAgICAgLy8gUmVjdXJzaXZlbHkgZmlsbCBhZGphY2VudCBjZWxsc1xuICAgICAgICB0aGlzLmZpbGwoc3RhcnRYICsgMSwgc3RhcnRZLCB0YXJnZXRDb2xvciwgcmVwbGFjZUNvbG9yKTsgLy8gUmlnaHRcbiAgICAgICAgdGhpcy5maWxsKHN0YXJ0WCAtIDEsIHN0YXJ0WSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcik7IC8vIExlZnRcbiAgICAgICAgdGhpcy5maWxsKHN0YXJ0WCwgc3RhcnRZICsgMSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcik7IC8vIERvd25cbiAgICAgICAgdGhpcy5maWxsKHN0YXJ0WCwgc3RhcnRZIC0gMSwgdGFyZ2V0Q29sb3IsIHJlcGxhY2VDb2xvcik7IC8vIFVwXG4gICAgfVxuICAgIHNldFpvb20oem9vbSkge1xuICAgICAgICB0aGlzLnpvb20gPSB6b29tO1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS53aWR0aCA9IGAke3RoaXMuZmlsZS53aWR0aCAqIHRoaXMuem9vbX1weGA7XG4gICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuZmlsZS5oZWlnaHQgKiB0aGlzLnpvb219cHhgO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH1cbiAgICB6b29tQ2hhbmdlKGR0ID0gMCkge1xuICAgICAgICBjb25zdCBkZWx0YSA9IE1hdGguc2lnbihkdCk7XG4gICAgICAgIHRoaXMuem9vbSArPSBkZWx0YSAqIDg7XG4gICAgICAgIHRoaXMuc2V0Wm9vbSh0aGlzLnpvb20pO1xuICAgIH1cbiAgICB6b29tSW4oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiem9vbSBpblwiKTtcbiAgICAgICAgaWYgKHRoaXMuem9vbSA8IDEyOCkge1xuICAgICAgICAgICAgdGhpcy56b29tQ2hhbmdlKDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHpvb21PdXQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiem9vbSBvdXRcIik7XG4gICAgICAgIGlmICh0aGlzLnpvb20gPiAxKSB7XG4gICAgICAgICAgICB0aGlzLnpvb21DaGFuZ2UoLTEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHpvb21SZXNldCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ6b29tIHJlc2V0XCIpO1xuICAgICAgICB0aGlzLnNldFpvb20oMjUpO1xuICAgIH1cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBEaWFsb2dFbGVtZW50IHtcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xuICAgICAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3NlbGVjdG9yfWApO1xuICAgICAgICB0aGlzLmNsb3NlQnRuID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidG5DbG9zZSR7c2VsZWN0b3J9YCk7XG4gICAgICAgIHRoaXMuY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRvZ2dsZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJvcGVuXCIpKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwib3BlblwiLCBcIlwiKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJvcGVuXCIpO1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzdGFydHVwXCIsIFwiZmFsc2VcIik7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5wdXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgYXBwKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuY29tbWFuZHMgPSB7XG4gICAgICAgICAgICBuOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAubmV3RmlsZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGU6ICgpID0+IHsgfSxcbiAgICAgICAgICAgIHc6ICh0eXBlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2F2ZUZpbGUodHlwZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnVpLmhlbHBEaWFsb2cudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkubG9nKFwiSGVscFwiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkucGFsZXR0ZURpYWxvZy50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC51aS5sb2coXCJPcGVuIHBhbGV0dGVcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgUDogKCkgPT4geyB9LFxuICAgICAgICAgICAgbG9nOiAobXNnKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudWkubG9nKG1zZyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtzZWxlY3Rvcn1gKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZSh0aGlzLmVsZW1lbnQudmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9wZW4oKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IFwiOlwiO1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICAgIH1cbiAgICBleGVjdXRlKGNtZCkge1xuICAgICAgICBjbWQgPSBjbWQuc2xpY2UoMSk7XG4gICAgICAgIGNvbnN0IFtjb21tYW5kLCAuLi5hcmdzXSA9IGNtZC5zcGxpdChcIiBcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKGNvbW1hbmQsIGFyZ3MpO1xuICAgICAgICBpZiAoY29tbWFuZCBpbiB0aGlzLmNvbW1hbmRzKSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRzW2NvbW1hbmRdKC4uLmFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hcHAudWkubG9nKGBjb21tYW5kIG5vdCBmb3VuZDogJHtjb21tYW5kfWApO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IERpYWxvZ0VsZW1lbnQgZnJvbSBcIi4vZGlhbG9nXCI7XG5pbXBvcnQgSW5wdXRDb21tYW5kIGZyb20gXCIuL2lucHV0LWNvbW1hbmRcIjtcbmNsYXNzIFRhYiB7XG4gICAgY29uc3RydWN0b3IodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLmlkID0gRGF0ZS5ub3coKS50b1N0cmluZygpO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLnRhYlRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IHRoaXMuaWQ7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFiXCIpO1xuICAgICAgICB0aGlzLmNsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgdGhpcy5jbG9zZUJ0bi5pZCA9IGAjYnRuQ2xvc2Uke3RoaXMuaWR9YDtcbiAgICAgICAgdGhpcy5jbG9zZUJ0bi50ZXh0Q29udGVudCA9IFwiWFwiO1xuICAgICAgICB0aGlzLnRhYlRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmQodGhpcy50YWJUaXRsZSwgdGhpcy5jbG9zZUJ0bik7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGFic1wiKS5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICB0aGlzLmNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZWFjdGl2YXRlVGFiKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICB9XG4gICAgYWN0aXZhdGVUYWIoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgIH1cbiAgICByZW5hbWUodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLnRhYlRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwib3BlblwiKTtcbiAgICB9XG59XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVSSB7XG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnN0YXJ0dXBEaWFsb2cgPSBuZXcgRGlhbG9nRWxlbWVudChcIkRpYWxvZ1N0YXJ0dXBcIik7XG4gICAgICAgIHRoaXMuaGVscERpYWxvZyA9IG5ldyBEaWFsb2dFbGVtZW50KFwiRGlhbG9nSGVscFwiKTtcbiAgICAgICAgdGhpcy5pbnB1dENvbW1hbmQgPSBuZXcgSW5wdXRDb21tYW5kKFwiSW5wdXRDbWRcIiwgdGhpcy5hcHApO1xuICAgICAgICB0aGlzLnpvb21FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN6b29tXCIpO1xuICAgICAgICB0aGlzLnByaW1hcnlDb2xvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Rvb2xQckNvbG9yXCIpO1xuICAgICAgICB0aGlzLnN0YXR1c0xpbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3N0YXR1c0xpbmVcIik7XG4gICAgICAgIHRoaXMucGFsZXR0ZURpYWxvZyA9IG5ldyBEaWFsb2dFbGVtZW50KFwiRGlhbG9nUGFsZXR0ZVwiKTtcbiAgICAgICAgdGhpcy5wYWxldHRlV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGFsZXR0ZVdyYXBcIik7XG4gICAgICAgIHRoaXMucGFsZXR0ZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwYWxldHRlVGl0bGVcIik7XG4gICAgICAgIHRoaXMudGFicyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGFic1wiKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIGlmICghd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwic3RhcnR1cFwiKSB8fFxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwic3RhcnR1cFwiKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnR1cERpYWxvZy5vcGVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50YWJzLmFwcGVuZChuZXcgVGFiKFwiVW50aXRsZWRcIikuZWxlbWVudCk7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuICAgIHJlbmRlclBhbGV0dGUoKSB7XG4gICAgICAgIHRoaXMucGFsZXR0ZVdyYXAuaW5uZXJIVE1MID0gXCJcIjtcbiAgICAgICAgdGhpcy5wYWxldHRlVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLmFwcC5wYWxldHRlLm5hbWU7XG4gICAgICAgIHRoaXMuYXBwLnBhbGV0dGUuY29sb3JzLmZvckVhY2goKGNvbG9yLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImNvbG9yLXN3YXRjaFwiKTtcbiAgICAgICAgICAgIGVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2JhKCR7Y29sb3JbMF19LCAke2NvbG9yWzFdfSwgJHtjb2xvclsyXX0sICR7Y29sb3JbM119KWA7XG4gICAgICAgICAgICB0aGlzLnBhbGV0dGVXcmFwLmFwcGVuZChlbCk7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnByaW1hcnlDb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxvZyhtc2cpIHtcbiAgICAgICAgdGhpcy50byAmJiBjbGVhclRpbWVvdXQodGhpcy50byk7XG4gICAgICAgIHRoaXMuc3RhdHVzTGluZS5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5zdGF0dXNMaW5lLnRleHRDb250ZW50ID0gbXNnO1xuICAgICAgICB0aGlzLnRvID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0xpbmUuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0xpbmUudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICB9LCAyMDAwKTtcbiAgICB9XG4gICAgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLnJlbmRlclBhbGV0dGUoKTtcbiAgICAgICAgdGhpcy56b29tRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RoaXMuYXBwLnpvb20gKiAxMDB9JWA7XG4gICAgICAgIHRoaXMucHJpbWFyeUNvbG9yRWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBgcmdiYSgke3RoaXMuYXBwLnByaW1hcnlDb2xvclswXX0sICR7dGhpcy5hcHAucHJpbWFyeUNvbG9yWzFdfSwgJHt0aGlzLmFwcC5wcmltYXJ5Q29sb3JbMl19LCAke3RoaXMuYXBwLnByaW1hcnlDb2xvclszXX0pYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgQXBwIGZyb20gXCIuL2FwcFwiO1xuY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuLy9AdHMtaWdub3JlXG53aW5kb3cuYXBwID0gYXBwO1xuIiwiaW1wb3J0IHsgV2l6RmlsZSB9IGZyb20gXCIuL2ZpbGVcIjtcbmltcG9ydCBIaXN0b3J5IGZyb20gXCIuL2hpc3RvcnlcIjtcbmltcG9ydCB7IGRlZmF1bHRQYWxldHRlIH0gZnJvbSBcIi4vcGFsZXR0ZVwiO1xuaW1wb3J0IFJlbmRlcmVyIGZyb20gXCIuL3JlbmRlcmVyXCI7XG5pbXBvcnQgVUkgZnJvbSBcIi4vdWlcIjtcbmNvbnN0IERFRkFVTFRfV0lEVEggPSAxNjtcbmNvbnN0IERFRkFVTFRfSEVJR0hUID0gMTY7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcHAge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmhpc3RvcnkgPSBuZXcgSGlzdG9yeSh0aGlzKTtcbiAgICAgICAgdGhpcy56b29tID0gMjU7XG4gICAgICAgIHRoaXMudG9vbCA9IFwicGVuY2lsXCI7XG4gICAgICAgIHRoaXMuY29sb3IgPSAxO1xuICAgICAgICB0aGlzLmZpbGVzID0gW107XG4gICAgICAgIHRoaXMuZmlsZUluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5wYWxldHRlID0gZGVmYXVsdFBhbGV0dGU7XG4gICAgICAgIHRoaXMucHJpbWFyeUNvbG9yID0gdGhpcy5wYWxldHRlLmdldENvbG9yKDApO1xuICAgICAgICB0aGlzLnBhbGV0dGVzID0gW3RoaXMucGFsZXR0ZV07XG4gICAgICAgIHRoaXMudWkgPSBuZXcgVUkodGhpcyk7XG4gICAgICAgIHRoaXMubGF5ZXJJbmRleCA9IDA7XG4gICAgICAgIHRoaXMuZmlsZXMucHVzaChuZXcgV2l6RmlsZShERUZBVUxUX1dJRFRILCBERUZBVUxUX0hFSUdIVCkpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gbmV3IFJlbmRlcmVyKHRoaXMpO1xuICAgICAgICB0aGlzLnNldHVwKCk7XG4gICAgfVxuICAgIHNldHVwKCkge1xuICAgICAgICAvLyBhYmlsaXR5IHRvIHVuZG8gY2hhbmdlcyB3aXRoIGNtZCArIHpcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLm1ldGFLZXkgJiYgZS5rZXkgPT09IFwiPVwiKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuem9vbUluKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUubWV0YUtleSAmJiBlLmtleSA9PT0gXCItXCIpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci56b29tT3V0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUubWV0YUtleSAmJiBlLmtleSA9PT0gXCIwXCIpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci56b29tUmVzZXQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5tZXRhS2V5ICYmIGUua2V5ID09PSBcInpcIikge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVuZG8oKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaG9sZCBzcGFjZSBhbmQgbW92ZSBtb3VzZSwgbW92ZSBjYW52YXNcbiAgICAgICAgICAgICAgICBjYXNlIFwiU3BhY2VcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnVpLmlucHV0Q29tbWFuZC5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcIm9wZW5cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2FudmFzLnN0eWxlLmN1cnNvciA9IFwiZ3JhYlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmJ1dHRvbnMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jYW52YXMuc3R5bGUuY3Vyc29yID0gXCJncmFiYmluZ1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNhbnZhcy5zdHlsZS5sZWZ0ID0gYCR7ZS5tb3ZlbWVudFh9cHhgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNhbnZhcy5zdHlsZS50b3AgPSBgJHtlLm1vdmVtZW50WX1weGA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIj9cIjpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVpLmhlbHBEaWFsb2cudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJFc2NhcGVcIjpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51aS5pbnB1dENvbW1hbmQuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJvcGVuXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVpLmlucHV0Q29tbWFuZC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51aS5pbnB1dENvbW1hbmQub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiIFwiOlxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY2FudmFzLnN0eWxlLmN1cnNvciA9IFwiZGVmYXVsdFwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci51cGRhdGUoKTtcbiAgICAgICAgdGhpcy51aS51cGRhdGUoKTtcbiAgICB9XG4gICAgbmV3RmlsZSgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJuZXdcIik7XG4gICAgfVxuICAgIHNhdmVGaWxlKHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFwicG5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMudWkubG9nKGBzYXZlIGZpbGUgYXMgJHt0eXBlfWApO1xuICAgICAgICAgICAgLy8gc2F2ZSBjb250ZXh0IGFzIHBuZ1xuICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICAgICAgICAgICAgbGluay5kb3dubG9hZCA9IFwiaW1hZ2UucG5nXCI7XG4gICAgICAgICAgICBsaW5rLmhyZWYgPSB0aGlzLnJlbmRlcmVyLmNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIik7XG4gICAgICAgICAgICBsaW5rLmNsaWNrKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51aS5sb2coYGZpbGV0eXBlICR7dHlwZX0gaXMgbm90IHN1cHBvcnRlZGApO1xuICAgIH1cbiAgICB1bmRvKCkge1xuICAgICAgICB0aGlzLmhpc3RvcnkudW5kbygpO1xuICAgIH1cbiAgICByZWRvKCkge1xuICAgICAgICB0aGlzLmhpc3RvcnkucmVkbygpO1xuICAgIH1cbiAgICBjaGFuZ2VUb29sKHRvb2wpIHtcbiAgICAgICAgdGhpcy50b29sID0gdG9vbDtcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiTGF5ZXIiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJsb2NrZWQiLCJ3aWR0aCIsImhlaWdodCIsInRoaXMiLCJvcGFjaXR5IiwidmlzaWJsZSIsImRhdGEiLCJJbWFnZURhdGEiLCJkZWZhdWx0UGFsZXR0ZSIsImNvbG9ycyIsImFkZENvbG9yIiwiY29sb3IiLCJwdXNoIiwicmVtb3ZlQ29sb3IiLCJpbmRleCIsInNwbGljZSIsInNldENvbG9yIiwiZ2V0Q29sb3IiLCJXaXpGaWxlIiwicGFsZXR0ZSIsIkhpc3RvcnkiLCJhcHAiLCJpdGVtcyIsImN1cnNvciIsImxlbmd0aCIsImFkZCIsIml0ZW0iLCJjbGVhckZyb21DdXJzb3IiLCJ1bmRvIiwicmVkbyIsIlJlbmRlcmVyIiwiem9vbSIsImZpbGUiLCJmaWxlcyIsImZpbGVJbmRleCIsImdyaWQiLCJncmlkU2l6ZSIsIl9jYW52YXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJfY3R4IiwiY2FudmFzIiwiZ2V0Q29udGV4dCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiYmFja2dyb3VuZEltYWdlIiwiYmFja2dyb3VuZFNpemUiLCJpbWFnZVJlbmRlcmluZyIsInNldFpvb20iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0Iiwiem9vbUNoYW5nZSIsImRlbHRhWSIsImJvZHkiLCJxdWVyeVNlbGVjdG9yIiwiYXBwZW5kIiwiaW1hZ2VEYXRhIiwiY3R4IiwiY3JlYXRlSW1hZ2VEYXRhIiwiaGlzdG9yeSIsImdldEltYWdlRGF0YSIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ4IiwiTWF0aCIsImZsb29yIiwiY2xpZW50WCIsImxlZnQiLCJjbGllbnRZIiwidG9wIiwicHJpbWFyeUNvbG9yIiwicHV0SW1hZ2VEYXRhIiwiYnV0dG9ucyIsImRyYXdSZWN0IiwieSIsInciLCJoIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJmaWxsIiwic3RhcnRYIiwic3RhcnRZIiwidGFyZ2V0Q29sb3IiLCJyZXBsYWNlQ29sb3IiLCJtYXRyaXgiLCJsYXllckluZGV4IiwidXBkYXRlIiwiZHQiLCJkZWx0YSIsInNpZ24iLCJ6b29tSW4iLCJjb25zb2xlIiwibG9nIiwiem9vbU91dCIsInpvb21SZXNldCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImJpbmQiLCJEaWFsb2dFbGVtZW50Iiwic2VsZWN0b3IiLCJlbGVtZW50IiwiY2xvc2VCdG4iLCJjbG9zZSIsInRvZ2dsZSIsImhhc0F0dHJpYnV0ZSIsIm9wZW4iLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSW5wdXRDb21tYW5kIiwiY29tbWFuZHMiLCJuIiwibmV3RmlsZSIsInR5cGUiLCJzYXZlRmlsZSIsInVpIiwiaGVscERpYWxvZyIsInAiLCJwYWxldHRlRGlhbG9nIiwiUCIsIm1zZyIsImtleSIsImV4ZWN1dGUiLCJ2YWx1ZSIsImNsYXNzTGlzdCIsImZvY3VzIiwicmVtb3ZlIiwiY21kIiwic2xpY2UiLCJjb21tYW5kIiwiYXJncyIsInNwbGl0IiwiVGFiIiwidGl0bGUiLCJpZCIsIkRhdGUiLCJub3ciLCJ0b1N0cmluZyIsInRhYlRpdGxlIiwidGV4dENvbnRlbnQiLCJhcHBlbmRDaGlsZCIsImRlYWN0aXZhdGVUYWIiLCJhY3RpdmF0ZVRhYiIsInJlbmFtZSIsIlVJIiwic3RhcnR1cERpYWxvZyIsImlucHV0Q29tbWFuZCIsInpvb21FbGVtZW50IiwicHJpbWFyeUNvbG9yRWxlbWVudCIsInN0YXR1c0xpbmUiLCJwYWxldHRlV3JhcCIsInBhbGV0dGVUaXRsZSIsInRhYnMiLCJnZXRJdGVtIiwicmVuZGVyUGFsZXR0ZSIsImlubmVySFRNTCIsImZvckVhY2giLCJlbCIsInRvIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInRvb2wiLCJwYWxldHRlcyIsInJlbmRlcmVyIiwic2V0dXAiLCJtZXRhS2V5IiwiY29udGFpbnMiLCJtb3ZlbWVudFgiLCJtb3ZlbWVudFkiLCJsaW5rIiwiZG93bmxvYWQiLCJocmVmIiwidG9EYXRhVVJMIiwiY2xpY2siLCJjaGFuZ2VUb29sIl0sInNvdXJjZVJvb3QiOiIifQ==